<div class="article"><div class="titlepage"><div><div><h2 class="title"><a name="quickstart"></a>GT 6 Quickstart</h2></div><div><div class="abstract"><p class="title"><b>Introduction</b></p><p>
                This is a quickstart that shows a full installation of the
                Toolkit on two Fedora Linux machines, named <code class="systemitem">elephant</code> and
                <code class="systemitem">donkey</code>. It shows the installation of prereqs, installation of
                the toolkit, creation of <a href="#cert" class="glossterm"><em class="glossterm">certificates</em></a>, and configuration of
                services. It is designed to supplement the main admin guide,
                <a href="../install/#gtadmin" class="olink">Installing GT 6.0</a>.
            </p><p>
                Scenarios are shown for running <a href="#gridftp" class="glossterm"><em class="glossterm">GridFTP</em></a>
                and <a href="#gram" class="glossterm"><em class="glossterm">GRAM5</em></a>
                services, and using GridFTP and GRAM clients.
            </p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#q-typography">1. Typographical Conventions</a></span></dt><dt><span class="section"><a href="#q-prereq">2. Prerequisites</a></span></dt><dt><span class="section"><a href="#q-first">3. Setting up the first machine (GridFTP, GRAM, and MyProxy services)</a></span></dt><dd><dl><dt><span class="section"><a href="#q-toolkit">3.1. Installing the Toolkit</a></span></dt><dt><span class="section"><a href="#q-security">3.2. Setting up security on your first machine</a></span></dt><dt><span class="section"><a href="#idm93041603712">3.3. Creating a MyProxy Server</a></span></dt><dd><dl><dt><span class="section"><a href="#q-user-credential">3.3.1. User Credentials</a></span></dt><dt><span class="section"><a href="#q-gridmap">3.3.2. User Authorization</a></span></dt></dl></dd><dt><span class="section"><a href="#q-gridftp">3.4. Setting up GridFTP</a></span></dt><dt><span class="section"><a href="#q-gram">3.5. Setting up GRAM5</a></span></dt></dl></dd><dt><span class="section"><a href="#q-second">4. Setting up your second machine</a></span></dt><dd><dl><dt><span class="section"><a href="#q-prereq2">4.1. Setting up your second machine: Prereqs</a></span></dt><dt><span class="section"><a href="#q-toolkit2">4.2. Setting up your second machine: Installation</a></span></dt><dt><span class="section"><a href="#q-security2">4.3. Setting up your second machine: Security</a></span></dt><dt><span class="section"><a href="#q-gridftp2">4.4. Setting up your second machine: GridFTP</a></span></dt><dt><span class="section"><a href="#q-gram2">4.5. Setting up your second machine: GRAM5</a></span></dt></dl></dd><dt><span class="section"><a href="#q-conclusion">5. Conclusion</a></span></dt><dt><span class="glossary"><a href="#glossary-quickstart">Glossary</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="q-typography"></a>1. Typographical Conventions</h2></div></div></div><p>
            Where there is a command to be typed, it will be preceded by one of
            the following prompts:
            </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="prompt">elephant# </code>, </span><span class="term"><code class="prompt">donkey# </code></span></dt><dd>
                            Run this command as the <code class="systemitem">root</code> super-user, on
                            the <code class="systemitem">elephant</code> or <code class="systemitem">donkey</code>
                            hosts respectively.  You might have to use a
                            command like <span class="command"><strong>su</strong></span>(8) or
                            <span class="command"><strong>sudo</strong></span>(8) to start a root shell
                            before executing the command.
                        </dd><dt><span class="term"><code class="prompt">myproxy@elephant% </code></span></dt><dd>
                            Run this command as the <code class="systemitem">myproxy</code> user, on the
                            <code class="systemitem">elephant</code> host. This user is created automatically
                            when the <span class="package">myproxy-server</span> package
                            is installed.
                        </dd><dt><span class="term"><code class="prompt">quser@elephant% </code>, </span><span class="term"><code class="prompt">quser@donkey% </code></span></dt><dd>
                            Run this command as the normal user account you are
                            intending to interact with your Globus sevices, on
                            the <code class="systemitem">elephant</code> or <code class="systemitem">donkey</code> hosts. In this document,
                            we use the <code class="systemitem">quser</code> accout for this, but if you have
                            another user, you can use it for that purpose. 
                        </dd></dl></div><p>
        </p><p>
            Commands themselves will be typeset as <span class="command"><strong>run-this-command
            -with-arguments</strong></span>, and responses to the commands like this
            <code class="computeroutput">Some Response Text</code>. If there
            is some portion of a command which should be replaced by value, such
            as a version number, it will be typeset like this:
            <em class="replaceable"><code>REPLACEME</code></em>.
        </p><p>
            Finally, in some cases you will be prompted for a passphrase. When
            that occurs, the entry of the passphrase will be indicated by
            <strong class="userinput"><code>******</code></strong>, even though nothing will be printed to the screen.
        </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="q-prereq"></a>2. Prerequisites</h2></div></div></div><p>
            We distribute the Globus Toolkit 6 as a set of RPM and Debian
            packages for Linux systems, as an installable package for Mac OS X,
            as a .zip file for Windows and Cygwin, as well as a source
            installer which can be used on other operating systems. In this
            quickstart, we will be
            installing RPM packages. Thus, it is a prerequisite for following
            this quickstart that you are running a distribution for which we
            provide RPMs. If you are running a supported Debian or Ubuntu
            system, the process is very similar, but you'll need to use the
            <span class="command"><strong>apt-get</strong></span> or similar tools to install the
            packages. For the source installer, there is more work involved,
            and you'll need to consult the full installation guide.
        </p><p>
            First, we will to set up our system to use the Globus package
            repository. This repository contains the Globus software packages,
            signed by our build manager. We provide RPM and Debian packages
            that contain a source configuration file and the public key which
            can be used to verify the packages.  If your distribution has
            Globus 6.0 packages
            within its repository, you can skip to the next section.
        </p><p>
            The globus toolkit package repo RPM can be downloaded from
            <a class="ulink" href="http://www.globus.org/ftppub/gt6/installers/repo/globus-toolkit-repo-6-1.noarch.rpm" target="_top">the repo RPM package on globus.org</a>.
        </p><p>
            To install binary RPMs, download the globus-toolkit-repo
            package from the link above and install it with the command:
            </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>rpm -hUv globus-toolkit-repo-6-1.noarch.rpm</strong></span></pre><p>
        </p><p>
        The globus toolkit package repo Debian file can be downloaded from
            <a class="ulink" href="http://www.globus.org/ftppub/gt6/installers/repo/globus-toolkit-repo_6-2_all.deb" target="_top">the repo Debian package on globus.org</a>.
        </p><p>
            To install Debian or Ubuntu package, download the
            globus-toolkit-repo package from the link above and install it with
            the command:
            </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>dpkg -i globus-toolkit-repo_6-2_all.deb</strong></span></pre><p>
        </p><p>
            Once you've installed the Globus repository package, you can use
            your operating system's packaging tools: 
            <span class="command"><strong>yum</strong></span> or <span class="command"><strong>apt-get</strong></span>, to install
            the Globus components.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>
                For operating systems based on RHEL (such as Red Hat Enterprise
                Linux, CentOS, and Scientific Linux), the compatible EPEL
                repository must be enabled before installing myproxy. For OS
                versions 5.x, install the <a class="ulink" href="http://download.fedoraproject.org/pub/epel/5/i386/epel-release-5-4.noarch.rpm" target="_top">EPEL
                5 package</a>, and for OS version 6.x, use <a class="ulink" href="http://download.fedoraproject.org/pub/epel/6/i386/epel-release-6-7.noarch.rpm" target="_top">
                6 package</a>.
            </p><p>
                For information about installing these, see the <a class="ulink" href="http://fedoraproject.org/wiki/EPEL/FAQ#How_can_I_install_the_packages_from_the_EPEL_software_repository.3F" target="_top">EPEL
                FAQ</a>.
            </p><p>
                This step is not needed for Fedora, Debian, or Ubuntu systems.
            </p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="q-first"></a>3. Setting up the first machine (GridFTP, GRAM, and MyProxy services)</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="q-toolkit"></a>3.1. Installing the Toolkit</h3></div></div></div><p>Install packages:
                </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>yum install globus-gridftp globus-gram5 globus-gsi myproxy \
    myproxy-server myproxy-admin</strong></span></pre><p>
            </p><p>
                This will install the GridFTP, GRAM, and <a href="#myproxy" class="glossterm"><em class="glossterm">MyProxy</em></a> services, as
                well as set up a basic <a href="#simplecA" class="glossterm"><em class="glossterm">SimpleCA</em></a> so that
                you can issue security credentials for users to run the Globus
                services.

                </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
                        For Debian and Ubuntu systems, use
                        <span class="command"><strong>apt-get</strong></span> or
                        <span class="command"><strong>aptitude</strong></span> or another
                        package manager to install the same packages
                        as in the <span class="command"><strong>yum</strong></span> command above.
                    </p></td></tr></table></div><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="q-security"></a>3.2. Setting up security on your first machine</h3></div></div></div><p>
                The Globus Toolkit uses X.509 certificates and <a href="#proxy-cert" class="glossterm"><em class="glossterm">proxy certificates</em></a>
                to authenticate and authorize grid users.
                For this quickstart, we use the Globus
                <a href="../../simpleca/#simpleca" class="olink">SimpleCA</a>
                tools to manage our own
                <a href="#ca" class="glossterm"><em class="glossterm">Certificate Authority</em></a>, so that
                we don't need to rely on any external entitty to authorize
                our grid users.
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
                    In many deployment scenarios, certificates for both
                    services and users are obtained through one or more third
                    party CAs. In such scenarios, it is unnecessary to use
                    SimpleCA or MyProxy to issue certificates.  Since this
                    quickstart is intended to describe a simple, standalone
                    deployment scenario, we describe how to use these tools to
                    issue your own certificates.
                </p></td></tr></table></div><p>
                When the <span class="application">globus-simple-ca</span> package is
                installed, it will automatically create a new Certificate
                Authority and deploy its public certificate into the
                globus trusted certificate directory. It will also create
                a host certificate and key, so that the
                Globus services will be able to run.
            </p><p>
                We'll also need to copy the host certificate and key into place
                so that the myproxy service can use it as well.
                </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>install -o myproxy -m 644 \
    /etc/grid-security/hostcert.pem \
    /etc/grid-security/myproxy/hostcert.pem</strong></span>
<code class="prompt">elephant# </code><span class="command"><strong>install -o myproxy -m 600 \
    /etc/grid-security/hostkey.pem \
    /etc/grid-security/myproxy/hostkey.pem</strong></span></pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm93041603712"></a>3.3. Creating a MyProxy Server</h3></div></div></div><p>
                We are going to create a MyProxy server on elephant, following
                the instructions at <a class="ulink" href="http://grid.ncsa.illinois.edu/myproxy/fromscratch.html#server" target="_top">http://grid.ncsa.illinois.edu/myproxy/fromscratch.html#server</a>.
                This will be used to store our user's certificates.  In order
                to enable myproxy to use the SimpleCA, modify the
                <code class="filename">/etc/myproxy-server.config</code> file, by
                uncommenting every line in the section <code class="literal">Complete Sample Policy
                #1</code> such that section looks like this
                <a class="ulink" href="myproxy-server.config" target="_top">myproxy configuration</a>:
                </p><pre class="programlisting">#
# Complete Sample Policy #1 - Credential Repository
#
# The following lines define a sample policy that enables all
# myproxy-server credential repository features.
# See below for more examples.
accepted_credentials       "*"
authorized_retrievers      "*"
default_retrievers         "*"
authorized_renewers        "*"
default_renewers           "none"
authorized_key_retrievers  "*"
default_key_retrievers     "none"
trusted_retrievers         "*"
default_trusted_retrievers "none"
cert_dir /etc/grid-security/certificates
</pre><p>
            </p><p>
                We'll next add the myproxy user to the simpleca group so that the myproxy
                server can create certificates.
                </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>usermod -a -G simpleca myproxy</strong></span></pre><p>
            </p><p>
                Start the myproxy server:
                </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>service myproxy-server start</strong></span>
<code class="computeroutput">Starting myproxy-server (via systemctl):                   [  OK  ]</code></pre><p>
                </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
                        For Debian and Ubuntu systems, use the <span class="command"><strong>invoke-rc.d</strong></span> command in place
                        of <span class="command"><strong>service</strong></span>.
                    </p></td></tr></table></div><p>
            </p><p>
                Check that it is running:
                </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>service myproxy-server status</strong></span>
<code class="computeroutput">myproxy-server.service - LSB: Startup the MyProxy server daemon
	  Loaded: loaded (/etc/rc.d/init.d/myproxy-server)
	  Active: active (running) since Fri, 02 Nov 2012 09:07:51 -0400; 1min 20s ago
	 Process: 1205 ExecStart=/etc/rc.d/init.d/myproxy-server start (code=exited, status=0/SUCCESS)
	  CGroup: name=systemd:/system/myproxy-server.service
		  └ 1214 /usr/sbin/myproxy-server -s /var/lib/myproxy

Nov 02 09:07:51 elephant.globus.org runuser[1210]: pam_unix(runuser:session):...
Nov 02 09:07:51 elephant.globus.org myproxy-server[1212]: myproxy-server v5.9...
Nov 02 09:07:51 elephant.globus.org myproxy-server[1212]: reading configurati...
Nov 02 09:07:51 elephant.globus.org myproxy-server[1212]: usage_stats: initia...
Nov 02 09:07:51 elephant.globus.org myproxy-server[1212]: Socket bound to 0.0...
Nov 02 09:07:51 elephant.globus.org myproxy-server[1212]: Starting myproxy-se...
Nov 02 09:07:51 elephant.globus.org runuser[1210]: pam_unix(runuser:session):...
Nov 02 09:07:51 elephant.globus.org myproxy-server[1205]: Starting myproxy-se...</code></pre><p>
                The important thing to see in the above is that the process is
                in the <code class="literal">active (running)</code> state.

                </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>
                        For other Linux distributions which are not using
                        systemd, the output will be different. You should still
                        see some information indicating the service is running.
                    </p></td></tr></table></div><p>
            </p><p>
                As a final sanity check, we'll make sure the myproxy TCP port
                <code class="literal">7512</code> is in use via the netstat command:

                </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>netstat -an | grep 7512</strong></span>
<code class="computeroutput">tcp        0      0 0.0.0.0:7512            0.0.0.0:*               LISTEN</code></pre><p>
            </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="q-user-credential"></a>3.3.1. User Credentials</h4></div></div></div><p> 
                    We'll need to specify a full
                    name and a login name for the user we'll create credentials
                    for. We'll be using the <code class="literal">QuickStart
                    User</code> as the user's name and <code class="systemitem">quser</code>
                    as user's account name. You can use this as well if you first
                    create a quser unix account. Otherwise, you can use another
                    local user account. Run the
                    <span class="command"><strong>myproxy-admin-adduser</strong></span> command as the
                    <code class="systemitem">myproxy</code> user to create the credentials. You'll be
                    prompted for a passphrase, which must be at least 6 characters long,
                    to encrypt the <a href="#priv-key" class="glossterm"><em class="glossterm">private key</em></a> for the user.
                    You must communicate this passphrase to the user who will be
                    accessing this credential. He can use the
                    <span class="command"><strong>myproxy-change-passphrase</strong></span>
                    command to change the passphrase.
                </p><p>
                    The command to create the myproxy credential for the user is
                    </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>su - -s /bin/sh myproxy</strong></span>
<code class="prompt">myproxy@elephant% </code><span class="command"><strong>PATH=$PATH:/usr/sbin</strong></span>
<code class="prompt">myproxy@elephant% </code><span class="command"><strong>myproxy-admin-adduser -c "QuickStart User" -l quser</strong></span>
<code class="computeroutput">Legacy library getopts.pl will be removed from the Perl core distribution in the next major release. Please install it from the CPAN distribution Perl4::CoreLibs. It is being used at /usr/sbin/myproxy-admin-adduser, line 42.
Enter PEM pass phrase: </code><strong class="userinput"><code>******</code></strong>
<code class="computeroutput">Verifying - Enter PEM pass phrase:</code><strong class="userinput"><code>******</code></strong>
<code class="computeroutput">
The new signed certificate is at: /var/lib/globus/simple_ca/newcerts/02.pem

using storage directory /var/lib/myproxy
Credential stored successfully
Certificate subject is:
/O=Grid/OU=GlobusTest/OU=simpleCA-elephant.globus.org/OU=local/CN=QuickStart User</code></pre><p>
                </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="q-gridmap"></a>3.3.2. User Authorization</h4></div></div></div><p>
                    Finally, we'll create a <a href="#grid-map-file" class="glossterm"><em class="glossterm">grid map file</em></a>
                    entry for this credential, so that the holder of that
                    credential can use it to access globus services. We'll use the
                    <a href="../../gsic/user/#grid-mapfile-add-entry" class="olink"><span class="command"><strong>grid-mapfile-add-entry</strong></span></a>
                    program for this. We need to use the exact string from the
                    output above as the parameter to the <code class="option">-dn</code>
                    command-line option, and the local account name of user to authorize
                    as the parameter to the <code class="option">-ln</code> command-line option.

                    </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>grid-mapfile-add-entry -dn \
    "/O=Grid/OU=GlobusTest/OU=simpleCA-elephant.globus.org/OU=local/CN=QuickStart User" \
    -ln quser</strong></span>
<code class="computeroutput">Modifying /etc/grid-security/grid-mapfile ...
/etc/grid-security/grid-mapfile does not exist... Attempting to create /etc/grid-security/grid-mapfile
New entry:
"/O=Grid/OU=GlobusTest/OU=simpleCA-elephant.globus.org/OU=local/CN=QuickStart User" quser
(1) entry added</code></pre><p>
                </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="q-gridftp"></a>3.4. Setting up GridFTP</h3></div></div></div><p>
                Now that we have our host and user credentials in place, we can
                start a globus service. This set up comes from the <a href="../../gridftp/admin/#gridftpAdmin" class="olink">GridFTP Admin Guide</a>.
            </p><p>
                Start the GridFTP server:
                </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>service globus-gridftp-server start</strong></span>
<code class="computeroutput">Started GridFTP Server                                     [  OK  ]</code></pre><p>
            </p><p>
                Check that the GridFTP server is running and listening on the
                gridftp port:
            </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>service globus-gridftp-server status</strong></span>
<code class="computeroutput">GridFTP Server Running (pid=20087)</code>
<code class="prompt">elephant# </code><span class="command"><strong>netstat -an | grep 2811</strong></span>
<code class="computeroutput">tcp        0      0 0.0.0.0:2811            0.0.0.0:*               LISTEN</code></pre><p>
            </p><p>
                Now the GridFTP server is waiting for a request, so we'll
                generate a proxy from the myproxy service by using
                <span class="command"><strong>myproxy-logon</strong></span> and then copy a file from the
                GridFTP server with the <span class="command"><strong>globus-url-copy</strong></span>
                command.  We'll use the passphrase used to create the myproxy
                credential for <code class="systemitem">quser</code>.

                </p><pre class="screen"><code class="prompt">quser@elephant% </code><span class="command"><strong>myproxy-logon -s elephant</strong></span>
<code class="computeroutput">Enter MyProxy pass phrase: </code><strong class="userinput"><code>******</code></strong>
<code class="computeroutput">A credential has been received for user quser in /tmp/x509up_u1001</code>
<code class="prompt">quser@elephant% </code><span class="command"><strong>globus-url-copy gsiftp://elephant.globus.org/etc/group \
    file:///tmp/quser.test.copy</strong></span>
<code class="prompt">quser@elephant% </code><span class="command"><strong>diff /tmp/quser.test.copy /etc/group</strong></span></pre><p>
            </p><p>
                At this point, we've configured the myproxy and GridFTP
                services and verified that we can create a security credential
                and transfer a file. If you had trouble, check the security
                troubleshooting section in the <a href="../../gsic/admin/#gsicAdmin" class="olink">Security Admin Guide</a>.  Now we can
                move on to setting up GRAM5 resource management.
            </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="q-gram"></a>3.5. Setting up GRAM5</h3></div></div></div><p>
                Now that we have security and GridFTP set up, we can set up
                GRAM for resource management. There are several different Local
                Resource Managers (LRMs) that one could configure GRAM to use,
                but this guide will explain the simple case of setting up a
                "fork" jobmanager, without auditing. For details on all other
                configuration options, and for reference, you can see the
                <a href="../../gram5/admin/#gram5Admin" class="olink">GRAM5 Admin Guide</a>. The
                GRAM service will use the same host credential as the GridFTP
                service, and is configured by default to use the fork manager, 
                so all we need to do now is start the service.
            </p><p>
                Start the GRAM gatekeeper:
                </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>service globus-gatekeeper start</strong></span>
<code class="computeroutput">Started globus-gatekeeper                                  [  OK  ]</code></pre><p>
            </p><p>
                We can now verify that the service is running and listening on
                the GRAM5 port:

                </p><pre class="screen"><code class="prompt">elephant# </code><span class="command"><strong>service globus-gatekeeper status</strong></span>
<code class="computeroutput">globus-gatekeeper is running (pid=20199)</code>
<code class="prompt">elephant# </code><span class="command"><strong>netstat -an | grep 2119</strong></span>
<code class="computeroutput">tcp6       0      0 :::2119                 :::*                    LISTEN</code></pre><p>
            </p><p>
                The gatekeeper is set up to run, and is ready to authorize job
                submissions and pass them on to the fork job manager. We can
                now run a couple of test jobs:
                
                </p><pre class="screen"><code class="prompt">quser@elephant% </code><span class="command"><strong>myproxy-logon -s elephant</strong></span>
<code class="computeroutput">Enter MyProxy pass phrase: </code><strong class="userinput"><code>******</code></strong>
<code class="computeroutput">A credential has been received for user quser in /tmp/x509up_u1001.</code>
<code class="prompt">quser@elephant% </code><span class="command"><strong>globus-job-run elephant /bin/hostname</strong></span>
<code class="computeroutput">elephant.globus.org</code>
<code class="prompt">quser@elephant% </code><span class="command"><strong>globus-job-run elephant /usr/bin/whoami</strong></span>
<code class="computeroutput">quser</code></pre><p>
            </p><p>
                If you had trouble, check the security troubleshooting section
                in the <a href="../../gsic/admin/#gsicAdmin" class="olink">Security Admin
                Guide</a>. To learn more about using GRAM 5, take a look at
                the <a href="../../gram5/user/#gram5-user-submitting-jobs" class="olink">GRAM User's
                Guide</a>.
            </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="q-second"></a>4. Setting up your second machine</h2></div></div></div><p>
            Alas, it's not much of a grid with just one machine. So let's start
            up on another machine and add it to this little test grid.
        </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="q-prereq2"></a>4.1. Setting up your second machine: Prereqs</h3></div></div></div><p>See <a class="link" href="#q-prereq" title="2. Prerequisites">Prereqs</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="q-toolkit2"></a>4.2. Setting up your second machine: Installation</h3></div></div></div><p>
                Install packages as before:
                </p><pre class="screen"><code class="prompt">donkey# </code><span class="command"><strong>yum install globus-gridftp myproxy globus-gram5</strong></span></pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="q-security2"></a>4.3. Setting up your second machine: Security</h3></div></div></div><p>
                Now let's get security set up on the second machine. We're
                going to trust the original simpleCA to this new machine;
                there's no need to create a new one. First, we'll bootstrap
                trust of the SimpleCA running on elephant:

                </p><pre class="screen"><code class="prompt">donkey# </code><span class="command"><strong>myproxy-get-trustroots -b -s elephant</strong></span>
<code class="computeroutput">Bootstrapping MyProxy server root of trust.
New trusted MyProxy server: /O=Grid/OU=GlobusTest/OU=simpleCA-elephant.globus.org/CN=host/elephant.globus.org
New trusted CA (e3d1c34d.0): /O=Grid/OU=GlobusTest/OU=simpleCA-elephant.globus.org/CN=Globus Simple CA
Trust roots have been installed in /etc/grid-security/certificates/.</code></pre><p>
                This allows clients and services on <code class="systemitem">donkey</code> to trust certificates
                which are signed by the CA on <code class="systemitem">elephant</code> machine. If we weren't going to run
                any Globus services on <code class="systemitem">donkey</code>, then we could stop here.
                Users on <code class="systemitem">donkey</code> could acquire credentials using the
                <span class="command"><strong>myproxy-logon</strong></span> command and perform file
                transfers and execute jobs using the
                <span class="command"><strong>globus-url-copy</strong></span> and
                <span class="command"><strong>globus-job-run</strong></span> commands. However, we'll continue
                to configure the GridFTP and GRAM5 services on <code class="systemitem">donkey</code> as well.
            </p><p>
                We're going to create the host certificate for donkey, but we
                create it on elephant, so that we don't have to copy the
                certificate request between machines. The
                <span class="command"><strong>myproxy-admin-addservice</strong></span> command will prompt
                for a passphrase for this credential. We will use this
                passphrase to retrieve the credential on donkey.
                
                </p><pre class="screen"><code class="prompt">myproxy@elephant% </code><span class="command"><strong>myproxy-admin-addservice -c "donkey.globus.org" -l donkey</strong></span>
<code class="computeroutput">Legacy library getopts.pl will be removed from the Perl core distribution in the next major release. Please install it from the CPAN distribution Perl4::CoreLibs. It is being used at /sbin/myproxy-admin-addservice, line 42.
Enter PEM pass phrase:</code><strong class="userinput"><code>******</code></strong>
<code class="computeroutput">Verifying - Enter PEM pass phrase:</code><strong class="userinput"><code>******</code></strong>
<code class="computeroutput">
The new signed certificate is at: /var/lib/globus/simple_ca/newcerts/03.pem

using storage directory /var/lib/myproxy
Credential stored successfully
Certificate subject is:
/O=Grid/OU=GlobusTest/OU=simpleCA-elephant.globus.org/OU=local/CN=donkey.globus.org</code></pre><p>
            </p><p>
                Next we'll retrieve the credential on donkey as the root user.

                </p><pre class="screen"><code class="prompt">donkey# </code><span class="command"><strong>myproxy-retrieve -s elephant -k donkey.globus.org -l donkey</strong></span>
<code class="computeroutput">Enter MyProxy pass phrase: </code><strong class="userinput"><code>******</code></strong>
<code class="computeroutput">Credentials for quser have been stored in
/etc/grid-security/hostcert.pem and
/etc/grid-security/hostkey.pem.</code></pre><p>
            </p><p>
                At this point, we no longer need to have <code class="systemitem">donkey</code>'s host certificate
                on <code class="systemitem">elephant</code>'s myproxy server, so we'll delete it.

                </p><pre class="screen"><code class="prompt">donkey# </code><span class="command"><strong>myproxy-destroy -s elephant -k donkey.globus.org -l donkey</strong></span>
<code class="computeroutput">MyProxy credential 'donkey.globus.org' for user donkey was successfully removed.</code></pre><p>
            </p><p>
                And as a final setup, we'll add quser's credential to the
                grid-mapfile on <code class="systemitem">donkey</code>, so that the <code class="systemitem">quser</code> account can access
                services there as well.
                </p><pre class="screen"><code class="prompt">donkey# </code><span class="command"><strong>grid-mapfile-add-entry -dn \
    "/O=Grid/OU=GlobusTest/OU=simpleCA-elephant.globus.org/OU=local/CN=QuickStart User" \
    -ln quser</strong></span>
<code class="computeroutput">Modifying /etc/grid-security/grid-mapfile ...
/etc/grid-security/grid-mapfile does not exist... Attempting to create /etc/grid-security/grid-mapfile
New entry:
"/O=Grid/OU=GlobusTest/OU=simpleCA-elephant.globus.org/OU=local/CN=QuickStart User" quser
(1) entry added</code></pre><p>
            </p><p>
                At this point, we have set up security on donkey to trust the
                CA on elephant. We have created a host certificate
                for donkey so that we can run Globus services on donkey, and we
                have enabled the quser account to use services on donkey. The
                last thing to do is to turn on the Globus services on donkey.
            </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="q-gridftp2"></a>4.4. Setting up your second machine: GridFTP</h3></div></div></div><p>
                GridFTP set up on the second machine is identical to the first.
                I'll just list the commands here; see <a href="#q-gridftp" class="olink">Section 3.4, “Setting up GridFTP”</a> for additional information.
                </p><pre class="screen"><code class="prompt">donkey# </code><span class="command"><strong>service globus-gridftp-server start</strong></span>
<code class="computeroutput">Started GridFTP Server                                     [  OK  ]</code></pre><p>
                Now we can test it.
            </p><p>
                First, we'll retrive a proxy credential from the myproxy server
                so that the user on donkey can interact with the Globus
                services. Here we'll use the same passphrase as we used to
                create the <code class="systemitem">quser</code> credential.

                </p><pre class="screen"><code class="prompt">quser@donkey% </code><span class="command"><strong>myproxy-logon -s elephant</strong></span>
<code class="computeroutput">Enter MyProxy pass phrase: </code><strong class="userinput"><code>******</code></strong>
<code class="computeroutput">A credential has been received for user quser in /tmp/x509up_u1001.</code></pre><p>
            </p><p>
                Next we'll transfer a file between the gridftp servers on donkey and elephant:

                </p><pre class="screen"><code class="prompt">quser@donkey% </code><span class="command"><strong>globus-url-copy gsiftp://elephant.globus.org/etc/group \
   gsiftp://donkey.globus.org/tmp/from-elephant</strong></span></pre><p>
                That was a slightly more complicated test than we ran on
                elephant earlier. In this case, we did a third-party transfer
                between two GridFTP servers. It worked, so I have the local and
                remote security configured correctly.
            </p><p>
                If you run into problems, perhaps you have a firewall between
                the two machines? GridFTP needs to communicate on data ports,
                not just port 2811. The error for this condition looks like:
                </p><pre class="screen"><code class="computeroutput">error: globus_ftp_client: the server responded with an error
500 500-Command failed. : callback failed.
500-globus_xio: Unable to connect to 140.221.8.19:42777
500-globus_xio: System error in connect: No route to host
500-globus_xio: A system call failed: No route to host
500 End.</code></pre><p>
                You can set up a range of ports to be open on the firewall and
                configure GridFTP to use them. See <a href="../../gridftp/admin/#gridftp-config-security-firewalls" class="olink">the GridFTP admin
                firewall doc.</a>
            </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="q-gram2"></a>4.5. Setting up your second machine: GRAM5</h3></div></div></div><p>
                Now we can submit a staging job. This job will copy the
                <span class="command"><strong>/bin/echo</strong></span> program from donkey to a file
                called <code class="filename">/tmp/my_echo</code>. Then it runs it with
                some arguments, and captures the stderr/stdout. Finally, it
                will clean up the <code class="filename">my_echo</code> file when
                execution is done.
                </p><pre class="screen"><code class="prompt">quser@donkey% </code><span class="command"><strong>globus-job-run elephant \
    -x '(file_stage_in=(gsiftp://donkey.globus.org/bin/echo /tmp/echo)) \
        (file_clean_up=/tmp/echo)' /bin/ls -l /tmp/echo</strong></span>
<code class="computeroutput">-rw-r--r-- 1 quser quser 27120 Nov  2 09:56 /tmp/echo</code></pre><p>
                This example staged in a file, had an executable act on that
                file, and cleaned up the file afterward.
            </p><p>
                You can get other examples of GRAM files from <a href="../../gram5/user/#gram5-user-usagescenarios" class="olink">GRAM usage
                scenarios</a>.
            </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="q-conclusion"></a>5. Conclusion</h2></div></div></div><p>
            Hopefully this guide has been helpful in familiarizing you with
            some of the administration tasks and tools to use the Globus
            Toolkit. If you've reached this point successfully, you should
            have enough knowledge to enable additional hosts to use your 
            grid by repeating the tasks in <a href="#q-second" class="olink">Section 4, “Setting up your second machine”</a>.
            Also, by repeating the tasks in <a href="#q-user-credential" class="olink">Section 3.3.1, “User Credentials”</a> and
            <a href="#q-gridmap" class="olink">Section 3.3.2, “User Authorization”</a> you can enable additional users
            to access your compute and data resources.
        </p></div><div class="glossary"><div class="titlepage"><div><div><h2 class="title"><a name="glossary-quickstart"></a>Glossary</h2></div></div></div><div class="glossdiv"><h3 class="title">C</h3><dl><dt><a name="ca"></a><span class="glossterm">Certificate Authority</span> ( CA )</dt><dd class="glossdef"><p> An entity that issues certificates.</p></dd><dt><a name="cert"></a><span class="glossterm">certificate</span></dt><dd class="glossdef"><p> A public key plus information about the certificate owner bound
                              together by the digital signature of a CA. In the case of a CA
                              certificate, the certificate is self signed, i.e. it was signed using
                              its own private key.</p></dd></dl></div><div class="glossdiv"><h3 class="title">G</h3><dl><dt><a name="gram"></a><span class="glossterm">Grid Resource Allocation and Management</span> (GRAM)</dt><dd class="glossdef"><p>This component is used to locate, submit, monitor, and cancel jobs on Grid computing resources.</p></dd><dt><a name="gridftp"></a><span class="glossterm">GridFTP</span></dt><dd class="glossdef"><p>
                            A file transfer protocol based on FTP with
                            extensions for security and parallel data
                            transfers.
                        </p></dd><dt><a name="grid-map-file"></a><span class="glossterm">grid map file</span></dt><dd class="glossdef"><p> A file containing entries mapping certificate subjects to local user
                              names. This file can also serve as a access control list for GSI
                              enabled services and is typically found in
                                    <code class="filename">/etc/grid-security/grid-mapfile</code>. For more
                              information see the Gridmap section <a href="../../gsic/admin/#setting-up-gridmap" class="olink">here</a>.</p></dd></dl></div><div class="glossdiv"><h3 class="title">M</h3><dl><dt><a name="myproxy"></a><span class="glossterm">MyProxy</span></dt><dd class="glossdef"><p>
                        Myproxy manages X.509 credentials (certificates and
                        private keys). MyProxy combines an online credential
                        repository with an online certificate authority to
                        allow users to securely obtain credentials.
                    </p></dd></dl></div><div class="glossdiv"><h3 class="title">P</h3><dl><dt><a name="priv-key"></a><span class="glossterm">private key</span></dt><dd class="glossdef"><p>The private part of a key pair. Depending on the type of certificate
                              the key corresponds to it may typically be found in
                                    <code class="filename">$HOME/.globus/userkey.pem</code> (for user
                              certificates), <code class="filename">/etc/grid-security/hostkey.pem</code>
                              (for host certificates) or
                                          <code class="filename">/etc/grid-security/<em class="replaceable"><code>&lt;service&gt;</code></em>/<em class="replaceable"><code>&lt;service&gt;</code></em>key.pem</code>
                              (for service certificates).</p><p>For more information on possible private key locations see
                              <a href="../../gsic/pi/#gsic-env-credentials" class="olink">this</a>.</p></dd><dt><a name="proxy-cert"></a><span class="glossterm">proxy certificate</span></dt><dd class="glossdef"><p> A short lived certificate issued using a EEC. A proxy certificate
                              typically has the same effective subject as the EEC that issued it and
                              can thus be used in its place. GSI uses proxy certificates for single
                              sign on and delegation of rights to other entities.</p><p>For more information about types of proxy certificates and their
                              compatibility in different versions of GT, see <a class="ulink" href="http://dev.globus.org/wiki/Security/ProxyCertTypes" target="_top">http://dev.globus.org/wiki/Security/ProxyCertTypes</a>.</p></dd></dl></div><div class="glossdiv"><h3 class="title">S</h3><dl><dt><a name="simplecA"></a><span class="glossterm">SimpleCA</span></dt><dd class="glossdef"><p>
                        SimpleCA is a tool for creating and managing a
                        CA. It provides a way to implement a X.509
                        trust root and sign certificates for users and
                        hosts.
                    </p></dd></dl></div></div></div>
