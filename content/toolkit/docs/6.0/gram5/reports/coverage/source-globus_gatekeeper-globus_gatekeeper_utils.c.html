<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- source.template -->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
      <title>Code Coverage for globus_gatekeeper_utils.c</title>
      <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
      <link href="coverage.css" rel="stylesheet" type="text/css" />
  </head>

  <body>
      <table class="srcView">
      
        <tr>
          <td class="lineCount">1</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * Copyright 1999-2006 University of Chicago</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">3</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">4</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">5</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * you may not use this file except in compliance with the License.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">6</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * You may obtain a copy of the License at</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">7</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">8</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * http://www.apache.org/licenses/LICENSE-2.0</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">9</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">10</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * Unless required by applicable law or agreed to in writing, software</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">11</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">12</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">13</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * See the License for the specific language governing permissions and</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">14</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * limitations under the License.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">15</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">16</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">17</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">18</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">19</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">20</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">globus_gatekeeper_utils.c</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">21</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">22</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">23</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	Some common routines used by globus_gatekeeper </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">24</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	and globus_gram_k5.c</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">25</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">26</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">27</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">CVS Information:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">28</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	$Source: /home/ec2-user/alliance-web/alliance/toolkit/docs/5.2/5.2.5/gram5/reports/coverage/source-globus_gatekeeper-globus_gatekeeper_utils.c.html,v $</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">29</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	$Date: 2013/06/19 18:13:35 $</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">30</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	$Revision: 1.1 $</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">31</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	$Author: bester $</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">32</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">33</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">34</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">35</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/*****************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">36</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">							Include header files</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">37</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">38</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;globus_config.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">39</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;globus_gatekeeper_config.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">40</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;stdio.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">41</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;stdlib.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">42</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;locale.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">43</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;pwd.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">44</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;string.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">45</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/wait.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">46</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/stat.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">47</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;errno.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">48</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;unistd.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">49</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">50</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifdef HAVE_MALLOC_H</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">51</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   include &lt;malloc.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">52</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">53</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">54</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(TARGET_ARCH_CRAYT3E)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">55</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;unicos.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">56</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">57</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">58</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(HAVE_PROJ_H) &amp;&amp; defined(TARGET_ARCH_IRIX)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">59</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;proj.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">60</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">61</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">62</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;globus_gatekeeper_utils.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">63</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">64</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">65</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                               Type definitions</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">66</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">67</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">68</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">69</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                          Module specific prototypes</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">70</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">71</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">72</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">73</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">char * fgetscont(char *line, int size, FILE* fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">74</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">75</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">76</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                       Define module specific variables</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">77</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">78</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">79</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">80</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">char * fgetscont(char * line, int size, FILE* fd)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">81</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">82</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	int i;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">83</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	int len;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">84</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	char * cp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">85</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">86</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">	i = 2;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">87</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">	len = size;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">88</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    cp = line;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">89</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">	*cp = &#39;\0&#39;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">90</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">91</td>
          <td class="coverageCount">1326</td>
          <td class="srcCell"><span class="srcLine">	while(fgets(cp, len, fd) &amp;&amp;  </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">92</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		(i = strlen(line)) &gt; 2 &amp;&amp; </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">93</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		line[i-1] == &#39;\n&#39; &amp;&amp; line[i-2] == &#39;\\&#39;) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">94</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">      len = size - i - 2;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">95</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	  cp = line + i - 2;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">96</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">97</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">	if (*cp == &#39;\0&#39;) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">98</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		return NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">99</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">100</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">	return line;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">101</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">102</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">103</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:   globus_gatekeeper_util_globusxmap()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">104</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">105</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	Given a index, find the command to be issued. For example</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">106</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	this could be a service name, or a globusID, or K5 principal</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">107</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">108</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">109</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	index</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">110</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	A pointer to a char *. will strdup with command</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">111</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">112</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">113</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">int</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">114</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">globus_gatekeeper_util_globusxmap( char * filename, char * index, char ** command)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">115</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">116</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">117</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	FILE * fd;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">118</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	int    rc;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">119</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	int	   i;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">120</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int    offset;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">121</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	char   f_index[256]; </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">122</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	char   line[4096];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">123</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">124</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">	*command = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">125</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">126</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">  if ((fd = fopen(filename, &quot;r&quot;)) != NULL) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">127</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">128</td>
          <td class="coverageCount">1326</td>
          <td class="srcCell"><span class="srcLine">    while(fgetscont(line, sizeof(line), fd)) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">129</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">      i = strlen(line);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">130</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">	  if (line[0] != &#39;#&#39;) {   /* comment line */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">131</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">	    if (line[i - 1] == &#39;\n&#39;) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">132</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">			line[i - 1] = &#39;\0&#39;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">133</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">134</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">                if (!index)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">135</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">136</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">                        *command = strdup(line);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">137</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">                        fclose(fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">138</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">                        return(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">139</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">140</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">141</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		rc = sscanf(line, &quot; \&quot;%255[^\&quot;]%*c%n %n&quot;, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">142</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">						f_index, &amp;offset, &amp;offset);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">143</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if (rc != 1) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">144</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        	rc = sscanf(line, &quot;%255s%n %n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">145</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">					 f_index, &amp;offset, &amp;offset);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">146</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">147</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        if (rc == 1) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">148</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	      if (!strcmp(index, f_index)) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">149</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    *command = strdup(&amp;line[offset]);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">150</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            fclose(fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">151</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    return(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">152</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">153</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	      }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">154</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">155</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	  }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">156</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">157</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	fclose(fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">158</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	return(-1); /* not found */	</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">159</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">160</td>
          <td class="coverageCount">4</td>
          <td class="srcCell"><span class="srcLine">  return(-2);   /* open failed */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">161</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">162</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">163</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:   globus_gatekeeper_util_tokenize()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">164</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">165</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">166</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	Breakup the command in to args, pointing the args array</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">167</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	at the tokens. Replace white space at the end of each</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">168</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	token with a null. A token maybe in quotes. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">169</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">170</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">171</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	The command line to be parsed.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">172</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	A pointer to an array of pointers to be filled it</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">173</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	Size of the array, on input, and set to size used on output. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">174</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">175</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">176</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	0 on success. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">177</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	-1 on to malloc</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">178</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	-2 on to many args</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">179</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	-3 on quote not matched</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">180</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">181</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">182</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">int</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">183</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">globus_gatekeeper_util_tokenize(char * command, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">184</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">								char ** args,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">185</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">								int * n,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">186</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">								char * sep)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">187</td>
          <td class="coverageCount">2005</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">188</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  int i;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">189</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  char * cp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">190</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  char * pp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">191</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  char * qp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">192</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  char ** arg;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">193</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">194</td>
          <td class="coverageCount">2005</td>
          <td class="srcCell"><span class="srcLine">  arg = args;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">195</td>
          <td class="coverageCount">2005</td>
          <td class="srcCell"><span class="srcLine">  i = *n - 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">196</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">197</td>
          <td class="coverageCount">2005</td>
          <td class="srcCell"><span class="srcLine">  cp = command;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">198</td>
          <td class="coverageCount">17462</td>
          <td class="srcCell"><span class="srcLine">  while (*cp)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">199</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">200</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  	/* skip leading sep characters */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">201</td>
          <td class="coverageCount">39030</td>
          <td class="srcCell"><span class="srcLine">	while (*cp &amp;&amp; strchr(sep, *cp))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">202</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">203</td>
          <td class="coverageCount">12126</td>
          <td class="srcCell"><span class="srcLine">		cp++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">204</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">205</td>
          <td class="coverageCount">13452</td>
          <td class="srcCell"><span class="srcLine">	pp = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">206</td>
          <td class="coverageCount">13452</td>
          <td class="srcCell"><span class="srcLine">	if (*cp == &#39;\&quot;&#39;)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">207</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">208</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		cp++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">209</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		pp = cp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">210</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if ((qp = strchr(cp,&#39;\&quot;&#39;)) == NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">211</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">212</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			return -3;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">213</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">214</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		cp = qp + 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">215</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">216</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">217</td>
          <td class="coverageCount">13452</td>
          <td class="srcCell"><span class="srcLine">	else if (*cp)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">218</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">219</td>
          <td class="coverageCount">12773</td>
          <td class="srcCell"><span class="srcLine">		pp = cp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">220</td>
          <td class="coverageCount">12773</td>
          <td class="srcCell"><span class="srcLine">		if ((qp = strpbrk(cp,sep)) == NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">221</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">222</td>
          <td class="coverageCount">1326</td>
          <td class="srcCell"><span class="srcLine">			qp = strchr(cp,&#39;\0&#39;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">223</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">224</td>
          <td class="coverageCount">12773</td>
          <td class="srcCell"><span class="srcLine">		cp = qp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">225</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">226</td>
          <td class="coverageCount">13452</td>
          <td class="srcCell"><span class="srcLine">	if (pp)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">227</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">228</td>
          <td class="coverageCount">12773</td>
          <td class="srcCell"><span class="srcLine">		*arg = (char*)malloc((qp - pp) + 1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">229</td>
          <td class="coverageCount">12773</td>
          <td class="srcCell"><span class="srcLine">		if (*arg == NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">230</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">231</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			return -1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">232</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">233</td>
          <td class="coverageCount">12773</td>
          <td class="srcCell"><span class="srcLine">		memcpy(*arg,pp,qp - pp);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">234</td>
          <td class="coverageCount">12773</td>
          <td class="srcCell"><span class="srcLine">		*(*arg + (qp - pp)) = &#39;\0&#39;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">235</td>
          <td class="coverageCount">12773</td>
          <td class="srcCell"><span class="srcLine">		i--;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">236</td>
          <td class="coverageCount">12773</td>
          <td class="srcCell"><span class="srcLine">    	if (i == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">237</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	  		return(-2); /* to many args */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">238</td>
          <td class="coverageCount">12773</td>
          <td class="srcCell"><span class="srcLine">    	arg++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">239</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">240</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">241</td>
          <td class="coverageCount">2005</td>
          <td class="srcCell"><span class="srcLine">  *arg = (char *) 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">242</td>
          <td class="coverageCount">2005</td>
          <td class="srcCell"><span class="srcLine">  *n = *n - i - 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">243</td>
          <td class="coverageCount">2005</td>
          <td class="srcCell"><span class="srcLine">  return(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">244</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">245</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">246</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">247</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:   globus_gatekeeper_util_envsub()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">248</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">249</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">250</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	Substitute from environment string like ${text} </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">251</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	into arg.  arg will be freed and copied.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">252</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	Recursion is allowed. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">253</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">254</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">255</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	arg a pointer to the string pointer. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">256</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">257</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">258</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	0 on success. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">259</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	-1 on malloc</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">260</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	-3 on env string not found</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">261</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">262</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">263</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">int</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">264</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">globus_gatekeeper_util_envsub(char ** arg)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">265</td>
          <td class="coverageCount">1268</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">266</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	char * cp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">267</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	char * pp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">268</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	char * qp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">269</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	char * rp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">270</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	char * narg;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">271</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">272</td>
          <td class="coverageCount">1268</td>
          <td class="srcCell"><span class="srcLine">	cp = *arg;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">273</td>
          <td class="coverageCount">2536</td>
          <td class="srcCell"><span class="srcLine">	while ((pp = strstr(cp,&quot;${&quot;)))  /* for editor matching } */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">274</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">275</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		pp+=2;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">276</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">									/* for editor matching { */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">277</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if(!(qp = strstr(pp,&quot;}&quot;)))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">278</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">279</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			return -2;  /* not terminated */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">280</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">281</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		*(pp-2) = &#39;\0&#39;; /* term the prefix */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">282</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		*qp = &#39;\0&#39;;     /* term the env name */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">283</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		qp++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">284</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if (!(rp = getenv(pp)))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">285</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">286</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			return -3;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">287</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">288</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if (!(narg = (char *)malloc(strlen(cp) + </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">289</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">							   strlen(rp) + </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">290</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">							   strlen(qp) + 1)))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">291</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">292</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			return -1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">293</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">294</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		strcpy(narg,cp);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">295</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		strcat(narg,rp);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">296</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		strcat(narg,qp);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">297</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		free(cp);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">298</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		cp = narg;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">299</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		*arg = cp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">300</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">301</td>
          <td class="coverageCount">1268</td>
          <td class="srcCell"><span class="srcLine">	return 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">302</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">303</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">304</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">305</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:   globus_gatekeeper_util_exec()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">306</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">307</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">308</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">309</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">310</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">int</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">311</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">globus_gatekeeper_util_exec(char *args[], </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">312</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">					struct passwd *pw, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">313</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">					char * user, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">314</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">					char **errmsgp)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">315</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">316</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">317</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  int pid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">318</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  int err; </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">319</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  int rc;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">320</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  char *path;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">321</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  char * cp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">322</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">323</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define WAIT_USES_INT</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">324</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifdef  WAIT_USES_INT</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">325</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  int wait_status;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">326</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#else   /* WAIT_USES_INT */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">327</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  union wait wait_status;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">328</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif  /* WAIT_USES_INT */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">329</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">330</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">  pid = fork();</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">331</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">  if (pid &lt;0) </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">332</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">   return(-1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">333</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">334</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">  if (pid == 0) {  /* child process */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">335</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">336</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	/* If need to run child as user */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">337</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	if (pw != NULL) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">338</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if ((rc = globus_gatekeeper_util_trans_to_user(pw, user, errmsgp)) != 0) { </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">339</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			/* child failed to transfer to user context */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">340</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			fprintf(stderr,&quot;Failed trying to run as user %s: %s\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">341</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">				user, *errmsgp);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">342</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			exit(126);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">343</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">344</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">345</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">346</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    path = strdup(args[0]);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">347</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    cp = strrchr(path, &#39;/&#39;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">348</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    if (cp)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">349</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">      cp++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">350</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    else</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">351</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">      cp = path;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">352</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">353</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    args[0] = cp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">354</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">355</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifdef DEBUG</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">356</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	fprintf(stderr,&quot;EXECING %s args=&quot;,path);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">357</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">358</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		int n = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">359</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		while (args[n]) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">360</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			fprintf (stderr,&quot; %s \n&quot;,args[n]);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">361</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			n++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">362</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">363</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	fprintf(stderr,&quot;\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">364</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">365</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">366</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    execv(path, args);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">367</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	fprintf(stderr,&quot;Failed to exec the child\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">368</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    exit(127);      /* in case execl fails */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">369</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  } </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">370</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">371</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  /* parent, wait for child to finish */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">372</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">373</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">  wait_status = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">374</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifdef  HAVE_WAITPID</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">375</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">  err = waitpid((pid_t) pid, &amp;wait_status, 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">376</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#else   /* HAVE_WAITPID */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">377</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  err = wait4(pid, &amp;wait_status, 0, (struct rusage *) NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">378</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif  /* HAVE_WAITPID */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">379</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">380</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  /* if it worked or failed, continue on. */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">381</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">  return(wait_status);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">382</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">383</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">384</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">385</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:   globus_gatekeeper_util_trans_to_user()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">386</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">387</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	Transition the process from root to the user, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">388</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	doing all the operating system specific stuff. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">389</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">390</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">391</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">392</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 0 if OK</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">393</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	&lt;0 if errno is set;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">394</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	&gt;0 if some other error.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">395</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 1 if not root</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">396</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	DEE needs work</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">397</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">398</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">399</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">int</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">400</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">globus_gatekeeper_util_trans_to_user(struct passwd * pw,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">401</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			 char * userid,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">402</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			 char ** errmsg)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">403</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">404</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">405</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	uid_t myuid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">406</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">407</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(HAVE_PROJ_H) &amp;&amp; defined(TARGET_ARCH_IRIX)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">408</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    prid_t user_prid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">409</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">410</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">411</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	/* must be root to use this */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">412</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">413</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	if ((myuid = getuid()) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">414</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">415</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if (myuid == pw-&gt;pw_uid)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">416</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			return 0;   /* already running as the user */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">417</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		else</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">418</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			*errmsg = strdup(&quot;Can not run as another user&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">419</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			return 1;   /* can&#39;t run as another user */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">420</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">421</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">422</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	/*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">423</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 *DEE If we are root and want to run as root, should we continue</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">424</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 * here or just exit? Some logging might be usefull. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">425</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">426</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">427</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#		ifdef TARGET_ARCH_CRAYT3E</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">428</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">429</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    /* If MLS is active, validate security information. If the</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">430</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	       connection is not allowed, mls_validate does not return.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">431</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	       If MLS is not active, this is a no-op. */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">432</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    mls_validate( /*havepty*/ 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">433</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">434</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    /* Record login in user data base. */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">435</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">436</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    update_udb(pw-&gt;pw_uid, pw-&gt;pw_name, /*tty*/ &quot;&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">437</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">438</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    /* Set user security attributes and drop all privilege. */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">439</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    set_seclabel();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">440</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">441</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    /* Set account number, job ID, limits, and permissions */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">442</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">443</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    if(cray_setup(pw-&gt;pw_uid, userid) &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">444</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">445</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			*errmsg = strdup(&quot;Failure performing Cray job setup for user&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">446</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			return 2;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">447</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">448</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">449</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#	endif /*TARGET_ARCH_CRAYT3E*/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">450</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">451</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	setgid(pw-&gt;pw_gid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">452</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	initgroups(pw-&gt;pw_name, pw-&gt;pw_gid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">453</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">454</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#	if defined(HAVE_PROJ_H) &amp;&amp; defined(TARGET_ARCH_IRIX)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">455</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">456</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		if ((user_prid = getdfltprojuser(pw-&gt;pw_name)) &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">457</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">458</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			user_prid = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">459</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">460</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		newarraysess();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">461</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		setprid(user_prid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">462</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">463</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#	endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">464</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">465</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#	if defined(__hpux)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">466</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">467</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		if (setresuid(pw-&gt;pw_uid, pw-&gt;pw_uid, -1) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">468</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">469</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			 *errmsg = strdup(&quot;cannot setresuid&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">470</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			 return -2;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">471</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">472</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">473</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#	elif defined(TARGET_ARCH_SOLARIS) || \</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">474</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		 defined(TARGET_ARCH_BSD) || \</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">475</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		 defined(TARGET_ARCH_CYGWIN)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">476</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">477</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		if (setuid(pw-&gt;pw_uid) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">478</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">479</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		    *errmsg = strdup(&quot;cannot setuid&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">480</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			return -3;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">481</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">482</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">483</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#	else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">484</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">485</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if (seteuid(0) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">486</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">487</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    *errmsg = strdup(&quot;cannot seteuid&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">488</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			return -4;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">489</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">490</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">491</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if (setreuid(pw-&gt;pw_uid, pw-&gt;pw_uid) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">492</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">493</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    *errmsg = strdup(&quot;cannot setreuid&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">494</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">			return -5;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">495</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">496</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">497</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#	endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">498</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">499</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	return 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">500</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
      </table>
  </body>
</html>
