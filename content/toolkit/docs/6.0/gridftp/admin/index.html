<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<div class="book"><div class="titlepage"><div><div><h1 class="title"><a name="gridftpAdmin"></a>GT 6.0 GridFTP : System Administrator's
    Guide</h1></div><div><div class="abstract"><p class="title"><b>Introduction</b></p><p>This guide contains advanced configuration information for system administrators working
        with GridFTP. It provides references to information on procedures typically performed by
        system administrators, including installation, configuring, deploying, and testing the
        installation. This guide should help you configure and run the GridFTP
          <a href="#server" class="glossterm"><em class="glossterm">server</em></a> in some standard configurations.</p><p>
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>This information is in addition to the basic Globus Toolkit prerequisite,
            overview, installation, security configuration instructions in the <a href="../../admin/install/#gtadmin" class="olink">Installing GT 6.0</a>. Read through this guide before continuing!</p></td></tr></table></div><p>
      </p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="chapter"><a href="#gridftp-admin-installing">1. Building
    and Installing</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-building-installing">1. Building and Installing GridFTP</a></span></dt><dt><span class="section"><a href="#gridftp-admin-installing-static-gridftp">2. Building and Installing a static
        GridFTP server</a></span></dt><dt><span class="section"><a href="#gridftp-admin-installing-threaded">3. Enabling Threading in GridFTP</a></span></dt></dl></dd><dt><span class="chapter"><a href="#gridftp-configuring">2. Configuring GridFTP</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-config-overview">1. GridFTP server configuration overview</a></span></dt><dt><span class="section"><a href="#gridftp-config-types">2. Typical configuration</a></span></dt><dt><span class="section"><a href="#gridftp-config-security-firewalls">3. Firewall requirements</a></span></dt><dt><span class="section"><a href="#gridftp-admin-config-security">4. Configuring Security for GridFTP</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-admin-config-security-anonymous">4.1. Anonymous mode</a></span></dt><dt><span class="section"><a href="#gridftp-admin-config-security-userpw">4.2. Username/password</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14796642560">4.2.1. Create password file</a></span></dt><dt><span class="section"><a href="#idm14796637872">4.2.2. Run the server in password mode</a></span></dt><dt><span class="section"><a href="#idm14796635184">4.2.3. Make a transfer</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-config-security-sshftp">4.3. SSHFTP (GridFTP-over-SSH)</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14796628048">4.3.1. Configure Server for SSH GridFTP Support</a></span></dt><dt><span class="section"><a href="#idm14796622080">4.3.2. Performing <code class="filename">sshftp://</code> Transfers</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-gsiftp">4.4. GSIFTP</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-admin-daemon_mode">4.4.1. Running in daemon mode</a></span></dt><dt><span class="section"><a href="#gridftp-admin-inetd">4.4.2. Running under
          inetd or xinetd</a></span></dt><dt><span class="section"><a href="#gridftp-admin-launchd">4.4.3. Running under launchd</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-user-pems">4.5. User permissions</a></span></dt></dl></dd><dt><span class="section"><a href="#idm14796555760">5. <span class="command"><strong>globus-gridftp-server</strong></span> quickstart</a></span></dt><dt><span class="section"><a href="#idm14796534912">6. Enabling File Sharing with Globus Sharing Service</a></span></dt></dl></dd><dt><span class="chapter"><a href="#gridftp-admin-tuning">3. Key Admin Settings and Tuning Recommendations</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14801091072">1. Concurrent Instances</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14801087456">1.1. System memory considerations</a></span></dt><dt><span class="section"><a href="#idm14801085008">1.2. I/O bandwidth considerations</a></span></dt><dt><span class="section"><a href="#idm14801081936">1.3. Why More Than One?</a></span></dt><dt><span class="section"><a href="#idm14801074080">1.4. Setting the instance cap</a></span></dt></dl></dd><dt><span class="section"><a href="#idm14801071776">2. Disk Block Size</a></span></dt><dt><span class="section"><a href="#idm14801069264">3. Host Tuning</a></span></dt><dt><span class="section"><a href="#idm14801067600">4. Data Interface</a></span></dt></dl></dd><dt><span class="chapter"><a href="#gridftp-admin-advanced">4. Advanced Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-config-udt">1. Configuring GridFTP to use UDT instead of TCP </a></span></dt><dd><dl><dt><span class="section"><a href="#idm14801059168">1.1. Prerequisites</a></span></dt><dt><span class="section"><a href="#idm14801055008">1.2. Steps</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-separated">2. Separation of Processes (Split Process)</a></span></dt><dt><span class="section"><a href="#gridftp-admin-striped">3. Configuring GridFTP for Cluster-to-Cluster (or
        Striped) data movement</a></span></dt><dt><span class="section"><a href="#combo-striped-split">4. Combining Split Process and Striped configuration</a></span></dt><dt><span class="section"><a href="#chroot-gridftp">5. Configuring chrooted GridFTP server</a></span></dt><dt><span class="section"><a href="#gridftp-admin-server-gfork">6. Running with GFork Master Plugin</a></span></dt><dt><span class="section"><a href="#gridftp-user-access">7. Accessing data from other data interfaces</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14797901376">7.1. GridFTP and DSIs</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-protocol">7.1.1. GridFTP Protocol Module</a></span></dt><dt><span class="section"><a href="#gridftp-data_transform">7.1.2. Data Transform Functionality</a></span></dt><dt><span class="section"><a href="#gridftp-dsi">7.1.3. Data Storage Interface (DSI) / Data Transform module</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-dsis">7.2. Plugging in a Data Storage Interface (DSI)</a></span></dt><dt><span class="section"><a href="#gridftp-howto-access-posix">7.3. Accessing data in a non-POSIX file data source
          that has a POSIX interface</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#gridftp-admin-experimental">5. Experimental Features</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-config-netlogger">1. Configuring GridFTP to enable Netlogger's bottleneck detection</a></span></dt><dt><span class="section"><a href="#gridftp-config-multi">2. Configuring multicasting/broadcasting</a></span></dt><dt><span class="section"><a href="#gridftp-admin-gwtftp">3. GridFTP Where There Is FTP (GWTFTP)</a></span></dt></dl></dd><dt><span class="chapter"><a href="#gridftp-admin-testing">6. Testing</a></span></dt><dt><span class="chapter"><a href="#gridftp-admin-debugging">7. Debugging</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-logging">1. Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14799622080">1.1. Configuring CEDPS format system administration logs</a></span></dt><dt><span class="section"><a href="#idm14798222704">1.2. Configuring traditional format system administration logs</a></span></dt><dt><span class="section"><a href="#idm14796722320">1.3. Netlogger-style logging</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#gridftp-troubleshooting">8. Troubleshooting</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-error-codes">1. Error Codes in GridFTP</a></span></dt><dt><span class="section"><a href="#idm14795509776">2. Establish control channel connection</a></span></dt><dt><span class="section"><a href="#idm14794461024">3. Try running globus-url-copy</a></span></dt><dt><span class="section"><a href="#idm14792476032">4. If your server starts...</a></span></dt><dt><span class="section"><a href="#gridftp-troubleshooting-latency">5. High latency for GridFTP server connections</a></span></dt></dl></dd><dt><span class="chapter"><a href="#gridftp-usage">9. Usage statistics collection by the Globus Alliance </a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-usage-stats">1. GridFTP-specific usage statistics</a></span></dt></dl></dd><dt><span class="appendix"><a href="#gridftp-admin-command">A. GridFTP Admin Tool</a></span></dt><dd><dl><dt><span class="refentrytitle"><a href="#globus-gridftp-server">globus-gridftp-server</a></span><span class="refpurpose"> &#8212; Configures the GridFTP Server</span></dt></dl></dd><dt><span class="appendix"><a href="#gridftp-SRB">B. Setting up SRB for use with GridFTP</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-SRB-intro">1. Introduction</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-architecture">2. Architecture</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-software">3. Software</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-building">4. Building</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-SRB-building-globus">4.1. Building Globus</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-building-SRB">4.2. Building SRB</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-building-SRBDSI">4.3. Building SRB-DSI</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-SRB-administration">5. Administration</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-SRB-config-file">5.1. Creating and setting up the SRB configuration file</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-gridmap-file">5.2. Setting up the gridmap file</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-SRB-running">6. Running</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-seealso">7. See Also</a></span></dt></dl></dd><dt><span class="appendix"><a href="#gridftp-admin-gfork-master">C. Running the Globus GridFTP Server With GFork</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-gfork-master-intro">1. Introduction</a></span></dt><dt><span class="section"><a href="#gridftp-gfork-master-use-case">2. Use Cases</a></span></dt><dt><span class="section"><a href="#gridftp-gfork-config">3. Configuration</a></span></dt><dt><span class="section"><a href="#gridftp-gfork-striped">4. GFork and Striped Servers</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-gfork-striped-frontend">4.1. Frontend Configuration</a></span></dt><dt><span class="section"><a href="#gridftp-gfork-striped-backend">4.2. Backend Configuration</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-gfork-memory-mgt">5. GFork with Memory Management</a></span></dt></dl></dd><dt><span class="glossary"><a href="#glossary-gridftpAdmin">Glossary</a></span></dt><dt><span class="index"><a href="#idm14800975664">Index</a></span></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-admin-installing"></a>Chapter 1. Building
    and Installing</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#gridftp-building-installing">1. Building and Installing GridFTP</a></span></dt><dt><span class="section"><a href="#gridftp-admin-installing-static-gridftp">2. Building and Installing a static
        GridFTP server</a></span></dt><dt><span class="section"><a href="#gridftp-admin-installing-threaded">3. Enabling Threading in GridFTP</a></span></dt></dl></div><a class="indexterm" name="idm14799669408"></a><a class="indexterm" name="idm14798500128"></a><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-building-installing"></a>1. Building and Installing GridFTP</h2></div></div></div><p>GridFTP is built and installed as part of a default GT 6.0 installation. For basic installation instructions, see <a href="../../admin/install/#gtadmin" class="olink">Installing GT 6.0</a>. No extra installation steps are required for this
    component.</p><p>If you wish to install GridFTP without installing the rest
    of the Globus Toolkit, follow the instructions in the above link but just use the group install target 'globus-gridftp'
    with Linux native packages and make target 'gridftp' (make gridftp) with
    source installer. </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-admin-installing-static-gridftp"></a>2. Building and Installing a static
        GridFTP server</h2></div></div></div><a class="indexterm" name="idm14798410912"></a><p>If you wish to build and install a statically linked set of GridFTP
      binaries from the source installer, follow the instructions on GT installation
      from the source installer in the link above but use the following for
      configure and make: </p><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>./configure --prefix=<em class="replaceable"><code>YOUR_PREFIX_DIRECTORY</code></em> --with-buildopts="--static"</strong></span></pre><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>make gpt globus_gridftp_server</strong></span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-admin-installing-threaded"></a>3. Enabling Threading in GridFTP</h2></div></div></div><p>In GT 6.0 the GridFTP
      server and the client 'globus-url-copy' are
      non-threaded by default. To enable threading, set the
      environment variable 'GLOBUS_THREAD_MODEL=pthread'. On the server,
      threading can be enabled using command-line option '-threads 1' as
      well. </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-configuring"></a>Chapter 2. Configuring GridFTP</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#gridftp-config-overview">1. GridFTP server configuration overview</a></span></dt><dt><span class="section"><a href="#gridftp-config-types">2. Typical configuration</a></span></dt><dt><span class="section"><a href="#gridftp-config-security-firewalls">3. Firewall requirements</a></span></dt><dt><span class="section"><a href="#gridftp-admin-config-security">4. Configuring Security for GridFTP</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-admin-config-security-anonymous">4.1. Anonymous mode</a></span></dt><dt><span class="section"><a href="#gridftp-admin-config-security-userpw">4.2. Username/password</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14796642560">4.2.1. Create password file</a></span></dt><dt><span class="section"><a href="#idm14796637872">4.2.2. Run the server in password mode</a></span></dt><dt><span class="section"><a href="#idm14796635184">4.2.3. Make a transfer</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-config-security-sshftp">4.3. SSHFTP (GridFTP-over-SSH)</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14796628048">4.3.1. Configure Server for SSH GridFTP Support</a></span></dt><dt><span class="section"><a href="#idm14796622080">4.3.2. Performing <code class="filename">sshftp://</code> Transfers</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-gsiftp">4.4. GSIFTP</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-admin-daemon_mode">4.4.1. Running in daemon mode</a></span></dt><dt><span class="section"><a href="#gridftp-admin-inetd">4.4.2. Running under
          inetd or xinetd</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14796592304">4.4.2.1. Set up xinetd/inetd config file</a></span></dt><dt><span class="section"><a href="#idm14796584960">4.4.2.2. globus-gridftp-server -i</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-launchd">4.4.3. Running under launchd</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-user-pems">4.5. User permissions</a></span></dt></dl></dd><dt><span class="section"><a href="#idm14796555760">5. <span class="command"><strong>globus-gridftp-server</strong></span> quickstart</a></span></dt><dt><span class="section"><a href="#idm14796534912">6. Enabling File Sharing with Globus Sharing Service</a></span></dt></dl></div><a class="indexterm" name="idm14800595808"></a><a class="indexterm" name="idm14800946688"></a><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-config-overview"></a>1. GridFTP server configuration overview</h2></div></div></div><a class="indexterm" name="idm14799350864"></a><p>The configuration interface for GridFTP is the admin tool, <span class="command"><strong><a href="#globus-gridftp-server" class="olink">globus-gridftp-server(8)</a></strong></span>, which
      can be used with a configuration file and/or run-time options.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Command line options and configuration file options may both be used, but the command
        line <span class="emphasis"><em>overrides</em></span> the config file.</p></td></tr></table></div><p>The configuration file for the GridFTP <a href="#server" class="glossterm"><em class="glossterm">server</em></a> is read from
      the following locations, in the given order. Only the first file found will be loaded:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Path specified with the <code class="computeroutput">-c &lt;configfile&gt;</code>
            command line option.</li><li class="listitem">
            <code class="filename">$GLOBUS_LOCATION/etc/gridftp.conf</code>
          </li><li class="listitem">
            <code class="filename">/etc/grid-security/gridftp.conf</code>
          </li></ul></div><p>Options are one per line, with the format:
      </p><pre class="screen">&lt;option&gt; &lt;value&gt;</pre><p> If the value contains spaces, they should be
      enclosed in double-quotes ("). Flags or boolean options should only have a value of 0 or 1.
      Blank lines and lines beginning with # are ignored.</p><p>For example:
      </p><pre class="screen">  port 5000
  allow_anonymous 1
  anonymous_user bob
  banner "Welcome!"
      </pre><p>For
      complete command documentation including all options, see <span class="command"><strong><a href="#globus-gridftp-server" class="olink">globus-gridftp-server(8)</a></strong></span>.</p><p>This page includes information about
      general configuration of the GridFTP server. Security options are discussed <a href="#gridftp-admin-config-security" class="olink">here</a>, and more
      advanced configuration is described <a href="#gridftp-admin-advanced" class="olink">here</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-config-types"></a>2. Typical configuration</h2></div></div></div><a class="indexterm" name="idm14796675840"></a><p>The following describes a typical GridFTP configuration of the front end (control channel)
      and back end (data channels). For other alternatives that provide greater levels of security,
      see <a href="#gridftp-admin-advanced" class="olink">Advanced
        Configuration</a>.</p><p>By default, the data channel and control channel are
      separate socket connections within the same process. The client sends a command and waits to
      finish before issuing the next command. This is good for a single host, traditional-type user.
      If you have a single host and you want an ultra-reliable and light weight file transfer
      service, this is a good choice. This configuration is also good for testing
    purposes.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-config-security-firewalls"></a>3. Firewall requirements</h2></div></div></div><p>If the GridFTP server is behind a firewall:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Contact your network administrator to open up port 2811 (for GridFTP control channel
          connection) and a range of ports (for GridFTP data channel connections) for the incoming
          connections. If the firewall blocks the outgoing connections, open up a range of ports for
          outgoing connections as well.</p></li><li class="listitem"><p>Set the environment variable GLOBUS_TCP_PORT_RANGE:
          </p><pre class="screen">export GLOBUS_TCP_PORT_RANGE=min,max </pre><p> where
            <code class="option">min</code>,<code class="option">max</code> specify the port range that you have opened
          for the incoming connections on the firewall. This restricts the listening ports of the
          GridFTP server to this range. Recommended range is 1000 (e.g., 50000-51000) but it really
          depends on how much use you expect.</p></li><li class="listitem"><p>If you have a firewall blocking the outgoing connections and you have opened a range
          of ports, set the environment variable GLOBUS_TCP_SOURCE_RANGE:
          </p><pre class="screen">export GLOBUS_TCP_SOURCE_RANGE=min,max </pre><p> where
            <code class="option">min</code>,<code class="option">max</code> specify the port range that you have opened
          for the outgoing connections on the firewall. This restricts the
	  GridFTP server to bind to a local port in this range for outbound
	  connections.
          Recommended range is twice the range used for
          GLOBUS_TCP_PORT_RANGE, because if parallel TCP streams are used for transfers, the
          listening port would remain the same for each connection but the connecting port would be
          different for each connection.</p></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If the server is behind NAT, the <code class="computeroutput">--data-interface &lt;real
          ip/hostname&gt;</code> option needs to be used on the server.</p></td></tr></table></div><p><a name="gridftp-client-firewall-intro"></a>If the GridFTP <span class="emphasis"><em>client</em></span> is behind a firewall:</p><div class="orderedlist"><a name="gridftp-client-firewall-config"></a><ol class="orderedlist" type="1"><li class="listitem"><p>Contact your network administrator to open up a range of ports (for GridFTP data
          channel connections) for the incoming connections. If the firewall blocks the outgoing
          connections, open up a range of ports for outgoing connections as well.</p></li><li class="listitem"><p>Set the environment variable GLOBUS_TCP_PORT_RANGE
          </p><pre class="screen">export GLOBUS_TCP_PORT_RANGE=min,max </pre><p> where min,max specify the port
          range that you have opened for the incoming connections on the firewall. This restricts
          the listening ports of the GridFTP client to this range. Recommended range is 1000 (e.g.,
          50000-51000) but it really depends on how much use you expect.</p></li><li class="listitem"><p>If you have a firewall blocking the outgoing connections and you have opened a range
          of (local) ports, set the environment variable GLOBUS_TCP_SOURCE_RANGE:
          </p><pre class="screen">export GLOBUS_TCP_PORT_RANGE=min,max </pre><p> where min,max specify the port
          range that you have opened for the outgoing connections on the
	  firewall. This restricts the GridFTP client to bind to a local port in
	  this range for
          outbound connections. Recommended range is twice the
          range used for GLOBUS_TCP_PORT_RANGE, because if parallel TCP streams are used for
          transfers, the listening port would remain the same for each connection but the connecting
          port would be different for each connection.</p></li></ol></div><p><a name="gridftp-client-firewall-moreinfo"></a>Additional information on Globus Toolkit Firewall Requirements is available <a class="ulink" href="http://www.globus.org/toolkit/security/firewalls/" target="_top">here</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-admin-config-security"></a>4. Configuring Security for GridFTP</h2></div></div></div><p>There are many security options in GridFTP ranging from no security to higher security via
      GSI .</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-admin-config-security-anonymous"></a>4.1. Anonymous mode</h3></div></div></div><a class="indexterm" name="idm14796652880"></a><p>Anonymous mode (using the <code class="option">-aa</code> option) allows any user with an FTP
        client to read and write (and delete) files that the server process can similarly access (it
        is also a quick way to test that your server works).</p><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>globus-gridftp-server -aa</strong></span>
<code class="computeroutput">Server listening at 127.0.0.1:58806</code></pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/warning.png"></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>When the server is run in this way, anyone who can connect to the server will posses
          all the same rights as the user that the process is run as (directly or via
            <code class="option">-anonymous-user</code>). If using this mode intentionally for open access, it
          is best to run under a dedicated account with limited filesystem permissions. You can also
          use the option below to disable FTP commands such as STOR, ESTO, DELE, RDEL, RNTO, etc to
          make sure that users can only read from the server and not write to it.
          </p><pre class="screen"> -disable-command-list &lt;string&gt;</pre><p> Where &lt;string&gt; represents a
          comma separated list of client commands that will be disabled. Default: not set. </p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-admin-config-security-userpw"></a>4.2. Username/password</h3></div></div></div><a class="indexterm" name="idm14796645472"></a><p>If you trust your network and want a minimal amount of security, you can run the
        globus-gridftp-server with clear text passwords. This security model is the one originally
        introduced in RFC959.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/warning.png"></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>We do not recommend it for long running servers open to the internet.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm14796642560"></a>4.2.1. Create password file</h4></div></div></div><p>To run the server in clear text password mode, we first need to create a password file
          dedicated to it. The format of the password file is the same as standard system password
          files; however, it is ill-advised to use a system password file. To create an entry in a
          GridFTP password file, run the following commands:</p><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>touch pwfile</strong></span>
<code class="prompt">globus@elephant% </code><span class="command"><strong>gridftp-password.pl &gt;&gt; pwfile</strong></span>
<code class="computeroutput">Password:</code></pre><p>This will ask you for a password and then create an entry in the password file for the
          current user name and the given password. Take a look at the file created. You will notice
          that the password you typed in is not in the file in a clear text form. We have run it
          though a one way hash algorithm before storing it in the file.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm14796637872"></a>4.2.2. Run the server in password mode</h4></div></div></div><p>Simply start the server pointing it at the password file you just created.</p><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>globus-gridftp-server -password-file  /full/path/of/pwfile</strong></span>
<code class="computeroutput">Server listening at 127.0.0.1:5555</code></pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm14796635184"></a>4.2.3. Make a transfer</h4></div></div></div><p>To run globus-url-copy with the password, use the following syntax:</p><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>globus-url-copy file:///etc/group ftp://<em class="replaceable"><code>username</code></em>:<em class="replaceable"><code>pw</code></em>@localhost:5000/tmp/group</strong></span></pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-admin-config-security-sshftp"></a>4.3. SSHFTP (GridFTP-over-SSH)</h3></div></div></div><a class="indexterm" name="idm14796631472"></a><p>This type of security introduces the sshftp control channel (frontend) protocol. This is
        a very simple means of obtaining strong security on the control channel only (the data
        channel is <span class="emphasis"><em>not</em></span> authenticated). With this approach, you can run a
        GridFTP transfer anywhere that you can ssh. <code class="filename">sshftp://</code> leverages the
        ubiquitous ssh/sshd programs to form control channel connections much in the same way that
        inetd forms connections.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm14796628048"></a>4.3.1. Configure Server for SSH GridFTP Support</h4></div></div></div><p>Every host that wishes to run a <span class="command"><strong>globus-gridftp-server</strong></span> which can
          accept <code class="filename">sshftp://</code> connections must run the following command as
          root:</p><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>globus-gridftp-server-enable-sshftp</strong></span></pre><p>In the absence of root access, a user can configure the server to allow <code class="filename">sshftp://</code> connections for that user only with the following command:</p><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>globus-gridftp-server-enable-sshftp -nonroot</strong></span></pre><p> 
	  The above command creates a file named 'sshftp' in
	  '/etc/grid-security' (if run as root) or in '$HOME/.globus' (if run as
	  nonroot).   You may edit this file to set gridftp commandline options
	  or environment variables such as GLOBUS_TCP_PORT_RANGE, but you can
	  also set those options in the config file.
	  </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm14796622080"></a>4.3.2. Performing <code class="filename">sshftp://</code> Transfers</h4></div></div></div><p>In this case, a <span class="command"><strong>globus-gridftp-server</strong></span> does not need to be running.
          The server will be started via the sshd program. Therefore, the hostname and port should
          be that of the sshd server. Run <span class="command"><strong>globus-url-copy</strong></span> just as you have
          before; simply change <code class="filename">ftp://</code> to <code class="filename">sshftp://</code>.</p><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>globus-url-copy -v file:/etc/group sshftp://127.0.0.1/tmp/group</strong></span>
<code class="prompt">globus@elephant% </code><span class="command"><strong>globus-url-copy -list sshftp://127.0.0.1/tmp/</strong></span></pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-admin-gsiftp"></a>4.4. GSIFTP</h3></div></div></div><a class="indexterm" name="idm14796615504"></a><p>This security option can be the most involved to set up, but provides the most security.
        It requires setting up GSI security as described in the GT Installation Guide here: <a href="../../admin/install/#gtadmin-basic-security" class="olink">Basic Security Configuration</a>. </p><p>Once GSI has been
        set up (host and user credentials are valid, the gridmap file is updated and you've run
        grid-proxy-init to create a proxy certificate), you simply run the GridFTP server:</p><pre class="screen">globus-gridftp-server</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If run as <code class="computeroutput">root</code>, it will pick up the host cert; if
          not, it will pick up the user cert.</p></td></tr></table></div><p>Now you are ready to perform a GSI-authenticated transfer:</p><pre class="screen">globus-url-copy &lt;-s subject&gt; src_url dst_url</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The subject option is only needed if the server was not started as root.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gridftp-admin-daemon_mode"></a>4.4.1. Running in daemon mode</h4></div></div></div><a class="indexterm" name="idm14796608832"></a><a class="indexterm" name="idm14796607808"></a><p>The server should generally be run as root in daemon mode, although it is possible to
          run it as a user (see below). When run as root you will need to have a <a href="../../admin/install/#gtadmin-basic-host" class="olink">host
          certificate</a>.</p><p>Run the
          server:</p><pre class="screen">globus-gridftp-server &lt; -s | -S &gt; &lt;args&gt;</pre><p>where:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">-s</span></dt><dd>Runs in the foreground (this is the default mode).</dd><dt><span class="term">-S</span></dt><dd>Detaches from the terminal and runs in the background.</dd></dl></div><p>The following additional steps may be required when running as a user
          other than root (for more details, review <a href="../../admin/install/#gtadmin-basic-security" class="olink">Basic Security Configuration</a>): </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Create a <code class="filename">~/.gridmap</code> file, containing the DNs of any
                clients you wish to allow, mapped to the current username.</li><li class="listitem">Create a proxy with <span class="command"><strong>grid-proxy-init</strong></span>.</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gridftp-admin-inetd"></a>4.4.2. Running under
          inetd or xinetd</h4></div></div></div><a class="indexterm" name="idm14796596512"></a><a class="indexterm" name="idm14796595104"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>We also feature a user-configurable, super-server daemon plugin called GFork. Click
              <a href="#gridftp-admin-gfork-master" class="olink">here</a>
            for more information.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="idm14796592304"></a>4.4.2.1. Set up xinetd/inetd config file</h5></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The service name used (gsiftp in this case) should be defined in <code class="computeroutput">/etc/services</code> with the desired port.</p></td></tr></table></div><p>Here is a sample GridFTP server xinetd config entry in <code class="filename">/etc/xinetd.conf</code>:
            </p><pre class="screen">service gsiftp
              {
              instances               = 100
              socket_type             = stream
              wait                    = no
              user                    = root
              env                     += GLOBUS_LOCATION=(globus_location)
              env                     += LD_LIBRARY_PATH=(globus_location)/lib
              server                  = (globus_location)/sbin/globus-gridftp-server
              server_args             = -i
              log_on_success          += DURATION
              nice                    = 10
              disable                 = no
              }</pre><p>
            Here is a sample gridftp server inetd config entry in <code class="filename">/etc/inetd.conf</code> (read as a single line):
            </p><pre class="screen">
              gsiftp   stream   tcp   nowait   root   /usr/bin/env env   \
              GLOBUS_LOCATION=(globus_location)                      \
              LD_LIBRARY_PATH=(globus_location)/lib                  \ 
              (globus_location)/sbin/globus-gridftp-server -i
            </pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>On Mac OS X, you must set DYLD_LIBRARY_PATH instead of LD_LIBRARY_PATH in the
              above examples. </p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>You should NOT include USERID in the log lines. See <a href="#gridftp-troubleshooting-latency" class="olink">Section 5, &#8220;High latency for GridFTP server connections&#8221;</a> for more
              information.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="idm14796584960"></a>4.4.2.2. globus-gridftp-server -i</h5></div></div></div><p>Use the <code class="option">-i</code> commandline option with <span class="command"><strong>globus-gridftp-server</strong></span>: </p><pre class="screen">globus-gridftp-server -i</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gridftp-admin-launchd"></a>4.4.3. Running under launchd</h4></div></div></div><p>launchd is used to start services in the system Mac OS X 10.4 (Tiger) and newer, and is also available as a port to FreeBSD.</p><p>Here is a <a class="ulink" href="http://www.globus.org/toolkit/docs/6/6.0/gridftp/globus.gridftp.plist" target="_top">sample</a> configuration file for launchd to start the server:</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
    &lt;dict&gt;
        &lt;key&gt;Disabled&lt;/key&gt;
        &lt;false/&gt;
        &lt;key&gt;Label&lt;/key&gt;
        &lt;string&gt;globus.gridftp&lt;/string&gt;
        &lt;key&gt;Program&lt;/key&gt;
        &lt;string&gt;(globus_location)/sbin/globus-gridftp-server&lt;/string&gt;
        &lt;key&gt;ProgramArguments&lt;/key&gt;
        &lt;array&gt;
            &lt;string&gt;globus-gridftp-server&lt;/string&gt;
            &lt;string&gt;-i&lt;/string&gt;
            &lt;string&gt;-d&lt;/string&gt;
            &lt;string&gt;ALL&lt;/string&gt;
            &lt;string&gt;-l&lt;/string&gt;
            &lt;string&gt;(globus_location)/var/gridftp.log&lt;/string&gt;
        &lt;/array&gt;
        &lt;key&gt;Sockets&lt;/key&gt;
        &lt;dict&gt;
            &lt;key&gt;Listeners&lt;/key&gt;
            &lt;dict&gt;
                &lt;key&gt;SockServiceName&lt;/key&gt;
                &lt;string&gt;gsiftp&lt;/string&gt;
            &lt;/dict&gt;
        &lt;/dict&gt;
        &lt;key&gt;inetdCompatibility&lt;/key&gt;
        &lt;dict&gt;
            &lt;key&gt;Wait&lt;/key&gt;
            &lt;false/&gt;
        &lt;/dict&gt;
        &lt;key&gt;StandardErrorPath&lt;/key&gt;
        &lt;string&gt;/dev/null&lt;/string&gt;
        &lt;key&gt;EnvironmentVariables&lt;/key&gt;
        &lt;dict&gt;
            &lt;key&gt;GLOBUS_LOCATION&lt;/key&gt;
            &lt;string&gt;(globus_location)&lt;/string&gt;
            &lt;key&gt;LD_LIBRARY_PATH&lt;/key&gt;
            &lt;string&gt;(globus_location)/lib&lt;/string&gt;
        &lt;/dict&gt;
    &lt;/dict&gt;
&lt;/plist&gt;
</pre><p>Provided that the configuration file is stored in <code class="filename">/System/Library/LaunchDaemons/globus.gridftp.plist</code>, the following command starts the GridFTP server:</p><pre class="screen"><span class="command"><strong>launchctl load /System/Library/LaunchDaemons/globus.griftp.plist</strong></span></pre><p>The server will be started automatically with a system, unless the value of the key 'Disabled' is changed from <code class="code">&lt;false/&gt;</code> to <code class="code">&lt;true/&gt;</code>.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-admin-user-pems"></a>4.5. User permissions</h3></div></div></div><p>Users are mapped to a local account on the server machine and file permissions are
        handled by the operating systems. In the anonymous mode, users that connect to the server
        will posses all the same rights as the user that the server process is run as (directly or
        via -anonymous-user).</p><p>In case of username/password authentication, the users are mapped to the uid
        corresponding to the username in the GridFTP password file and the access permissions for
        the users is same as that of the UID that they are mapped to. If SSH based authentication is
        used, upon successful authentication, SSHD maps users to a local account and the GridFTP
        server is run as the mapped local user. The access permissions are the same as that of the
        mapped local user.</p><p>If GSI is used, upon successful authentication an authorization callout is invoked to
        (a) verify authorization and (b) determine the local user id as which the request should be
        executed. This callout is linked dynamically. Globus GridFTP provides an implementation that
        supports a Globus "gridmapfile". Sites can also provide alternative implementations. Server
        does a setuid to the local user id as determined by the authorization callout and the access
        permissions are the same as that of the local user id.</p><p>GridFTP server provides an option to disable certain FTP commands:
        </p><pre class="screen"> -disable-command-list &lt;string&gt;</pre><p> Where &lt;string&gt; represents a
        comma separated list of client commands that will be disabled. Default: not set.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="idm14796555760"></a>5. <span class="command"><strong>globus-gridftp-server</strong></span> quickstart</h2></div></div></div><p>The following is a quick guide to running the server and using the client:</p><p>Look through the list of options for globus-gridftp-server:</p><pre class="screen">globus-gridftp-server --help</pre><p>Start the server in anonymous mode (discussed more fully <a href="#gridftp-admin-config-security-anonymous" class="olink">here</a>):</p><pre class="screen">globus-gridftp-server -control-interface 127.0.0.1 -aa -p 5000</pre><p>where: </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">&#8211;control-interface</span></dt><dd>is the hostname or IP address of the interface to listen for control
              connections on . This
              option is only needed here as a rudimentary means of security for this simple example.
            </dd><dt><span class="term">&#8211;aa</span></dt><dd>enables anonymous mode</dd><dt><span class="term">&#8211;p</span></dt><dd>indicates on which port the server listens.</dd></dl></div><p>Run a two party transfer with client:</p><pre class="screen">globus-url-copy -v file:///etc/group ftp://localhost:5000/tmp/group</pre><p>Run 3rd party transfer:</p><pre class="screen">globus-url-copy -v ftp://localhost:<em class="replaceable"><code>port</code></em>/etc/group ftp://localhost:<em class="replaceable"><code>port</code></em>/tmp/group2</pre><p>Experiment with -dbg, and -vb options for debugging and checking the performance of your
      setup:</p><pre class="screen">globus-url-copy -dbg file:///etc/group ftp://localhost:5000/tmp/group</pre><pre class="screen">globus-url-copy -vb file:///dev/zero ftp://localhost:5000/dev/null</pre><p>where:</p><div class="variablelist"><a name="debugging-options"></a><dl class="variablelist"><dt><span class="term"><code class="option"> -dbg</code></span></dt><dd><p>A useful option when something is not working. It results in a GridFTP control
            channel protocol dump (along with other useful information) to stderr. If you understand
            the GridFTP protocol, or you have ambition to understand it, this can be a very useful
            tool to discover various problems in your setup such as overloaded servers and
            firewalls. When submitting a bug report or asking a question on the support email lists
            one should always send along the -dbg output.</p></dd><dt><span class="term"><code class="option">-vb</code></span></dt><dd><p>Provides a type of progress bar of the user to observe the rate at which their
            transfer is progressing.</p></dd></dl></div><p>Ctrl-c - Kill the server.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>There are many possible options and configurations with <span class="command"><strong>globus-gridftp-server</strong></span>. For some guidelines on setting it up for your situation,
        see <a href="#gridftp-admin-tuning" class="olink">Chapter 3, <i>Key Admin Settings and Tuning Recommendations</i></a>.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="idm14796534912"></a>6. Enabling File Sharing with Globus Sharing Service</h2></div></div></div><p>To enable file sharing using <a class="ulink" href="https://www.globus.org/researchers/plus-plans" target="_top">Globus
	      Sharing</a>, you have to add the <a class="ulink" href="../securityd2b.tar.gz" target="_top">Globus Sharing CA
	      certificates</a> to your trusted certificates directory
	      (/etc/grid-security/certificates) and use '-sharing-dn' option in the server
	      as follows:
</p><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>globus-gridftp-server -sharing-dn
"/C=US/O=Globus Consortium/OU=Globus Connect User/CN=__transfer__"</strong></span>
</pre><p>
	and use '-sharing-rp' option to restrict the file paths allowed for
	sharing:
</p><pre class="screen"><code class="prompt">globus@elephant% </code><span class="command"><strong>globus-gridftp-server -sharing-rp &lt;path&gt; </strong></span>
</pre></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-admin-tuning"></a>Chapter 3. Key Admin Settings and Tuning Recommendations</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm14801091072">1. Concurrent Instances</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14801087456">1.1. System memory considerations</a></span></dt><dt><span class="section"><a href="#idm14801085008">1.2. I/O bandwidth considerations</a></span></dt><dt><span class="section"><a href="#idm14801081936">1.3. Why More Than One?</a></span></dt><dt><span class="section"><a href="#idm14801074080">1.4. Setting the instance cap</a></span></dt></dl></dd><dt><span class="section"><a href="#idm14801071776">2. Disk Block Size</a></span></dt><dt><span class="section"><a href="#idm14801069264">3. Host Tuning</a></span></dt><dt><span class="section"><a href="#idm14801067600">4. Data Interface</a></span></dt></dl></div><a class="indexterm" name="idm14801096368"></a><a class="indexterm" name="idm14801095344"></a><a class="indexterm" name="idm14801094320"></a><a class="indexterm" name="idm14801093296"></a><p>The <span class="command"><strong>globus-gridftp-server</strong></span> is a flexible and tunable piece of software.
      It is easy for an admin to get lost in all of the options it offers. This document intends to
      highlight some of the more commonly important options related to performance and robustness.
      It does not intend to account for all of the options but rather to give the system
      administator a better perspective into how to set some of the less obvious controls.</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="idm14801091072"></a>1. Concurrent Instances</h2></div></div></div><p>A very important option for a system administrator to set is the number of simultaneous
        GridFTP transfers allowed. In other words, the number of clients that are allowed to connect
        to the server at the same time.</p><p>GridFTP is designed to be a high performance, on-demand data transfer service. Quite a
        bit of system resources (mainly memory) are allocated to each client connection and this is
        with the assumption that the session will consume even more system resources (CPU, net/disk
        bandwidth) when performing a high speed data transfer. For this reason, the system
        administrator must evaluate the resource their host machine has to offer and set a
        reasonable limit to the number of client connects allowed at one time.</p><p>When determining the instance concurrency level, there are two major factors to
        consider: <span class="strong"><strong>system memory</strong></span> helps determine the upper limit
        of the instance range and <span class="strong"><strong>available I/O bandwidth</strong></span> helps
        determine the lower limit.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm14801087456"></a>1.1. System memory considerations</h3></div></div></div><p>First and foremost is system memory. The recommended instance count based on system
          memory is: </p><pre class="screen">instance count = system memory / 34</pre><p>Each instance of a GridFTP server will require about 2MB of memory just to handle the
          connection in a sane way. Beyond that is the amount of memory required to handle a fast,
          TCP-based data transfer. A safe rule of thumb here is 32MB. This allows for a TCP buffer
          size of 16MB (which is a common client selection for high performance WAN bandwidth delay
          products) and a user space buffer to match that value. 2MB + 16MB + 16MB = 34MB, thus the
          denominator in the above formula.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm14801085008"></a>1.2. I/O bandwidth considerations</h3></div></div></div><p>Simultaneous clients share the available I/O resources. Most often it is beneficial to
          allocate enough bandwidth so that each client can transfer data at an acceptable rate. In
          a simple model, the higher the instance count, the lower the transfer rates for each
          client. At some point it is beneficial for the GridFTP server to reject connections in an
          attempt to provide a higher level of service to its currently connected clients. There is
          also a point where too many simultaneous clients can cause thrashing and drop network
          packets. Obviously this situation should be avoided.</p><p>While no client wants to be rejected, a higher level service can take advantage of
          this by either trying again later at a more efficient time, reordering its work load, or
          finding a replica. RFT provides some of this functionality and other such services are
          being researched and designed.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm14801081936"></a>1.3. Why More Than One?</h3></div></div></div><p>When considering the right concurrent instance level it is helpful to consider why
          there should ever be more than one at a time. There are three major reasons for
          this:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><span class="strong"><strong>The other side of the connection is the
                bottleneck.</strong></span></p><p>If we assume that each transfer moves as fast as our system can send it, then,
              when considering overall throughput, having two connections going at half speed is
              roughly the same thing as having 2 full speed connections run one at a time. However,
              if the remote end of the connection is the bottleneck, then there is unused local
              bandwidth from which another simultaneous connection and thus the overall system can
              benefit. </p></li><li class="listitem"><p><span class="strong"><strong>Hide the overhead.</strong></span></p><p>Another important aspect of simultaneous connections is that the needed overhead
              of control messaging can be overlapped with the payload of another sessions data
              transfer. Hiding this processing and messaging latency makes for a more efficient
              system with a higher overall throughput.</p></li><li class="listitem"><p><span class="strong"><strong>Provide an interactive service.</strong></span></p><p>In some case, users may find connection rejections unacceptable and would prefer a
              slower overall system provided they could connect to it immediately for the purpose of
              an interactive session.</p></li></ol></div><p>In the case of #3 the the highest safe level of instance count possible is ideal. In
          the other two case the ideal number is less deterministic. At least 10 instance is always
          recommended.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm14801074080"></a>1.4. Setting the instance cap</h3></div></div></div><p> If using GFork or Xinetd, set the instance cap by adding the following line to the
          configuration file: </p><pre class="screen">instance = &lt;integer&gt;</pre><p>If running the GridFTP server as a daemon, use the following option to set the
          instance cap: </p><pre class="screen"> -connections-max &lt;integer&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="idm14801071776"></a>2. Disk Block Size</h2></div></div></div><p>The <span class="command"><strong>globus-gridftp-server</strong></span> sits on top of various file systems. Each
        file system has its own ideal access patterns and I/O buffer sizes. To provide the user with
        some means of control, we offer the option:
        </p><pre class="screen">-blocksize &lt;number&gt;</pre><p>This number indicates the size of the read requests posted to the disk.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="idm14801069264"></a>3. Host Tuning</h2></div></div></div><p>We recommend that you update the kernel TCP buffer settings and TCP
      congestion control algorithm as recommended <a class="ulink" href="http://fasterdata.es.net/fasterdata/host-tuning/" target="_top">here</a> for
      achieving maximum performance.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="idm14801067600"></a>4. Data Interface</h2></div></div></div><p>On systems that have multiple network interfaces, the system admin likely wants to
        associate data transfers with the fastest possible NIC available. This can be done in the
        GridFTP server by using the option:
        </p><pre class="screen">--data-interface &lt;ip address&gt;</pre></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-admin-advanced"></a>Chapter 4. Advanced Configuration</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#gridftp-config-udt">1. Configuring GridFTP to use UDT instead of TCP </a></span></dt><dd><dl><dt><span class="section"><a href="#idm14801059168">1.1. Prerequisites</a></span></dt><dt><span class="section"><a href="#idm14801055008">1.2. Steps</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-separated">2. Separation of Processes (Split Process)</a></span></dt><dt><span class="section"><a href="#gridftp-admin-striped">3. Configuring GridFTP for Cluster-to-Cluster (or
        Striped) data movement</a></span></dt><dt><span class="section"><a href="#combo-striped-split">4. Combining Split Process and Striped configuration</a></span></dt><dt><span class="section"><a href="#chroot-gridftp">5. Configuring chrooted GridFTP server</a></span></dt><dt><span class="section"><a href="#gridftp-admin-server-gfork">6. Running with GFork Master Plugin</a></span></dt><dt><span class="section"><a href="#gridftp-user-access">7. Accessing data from other data interfaces</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14797901376">7.1. GridFTP and DSIs</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-protocol">7.1.1. GridFTP Protocol Module</a></span></dt><dt><span class="section"><a href="#gridftp-data_transform">7.1.2. Data Transform Functionality</a></span></dt><dt><span class="section"><a href="#gridftp-dsi">7.1.3. Data Storage Interface (DSI) / Data Transform module</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-admin-dsis">7.2. Plugging in a Data Storage Interface (DSI)</a></span></dt><dt><span class="section"><a href="#gridftp-howto-access-posix">7.3. Accessing data in a non-POSIX file data source
          that has a POSIX interface</a></span></dt></dl></dd></dl></div><p>It is assumed that the toolkit installation was successful. For more information, see the
        <a href="../../admin/install/#gtadmin" class="olink">Installing GT 6.0</a>. Also be sure to reference <a href="#gridftp-configuring" class="olink">Chapter 2, <i>Configuring GridFTP</i></a> and <a href="#globus-gridftp-server" class="olink"><span class="command"><strong>globus-gridftp-server</strong></span></a>.</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-config-udt"></a>1. Configuring GridFTP to use UDT instead of TCP </h2></div></div></div><a class="indexterm" name="idm14801062368"></a><a class="indexterm" name="idm14801060960"></a><p> UDT is bundled with Globus starting with Globus v4.2, so downloading UDT separately is
        no longer needed. </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm14801059168"></a>1.1. Prerequisites</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Threaded Globus GridFTP server. 
              In GT5, the server is non-threaded by default. 
	     Refer to
                <a href="#gridftp-admin-installing-threaded" class="olink">Section 3, &#8220;Enabling Threading in GridFTP&#8221;</a> for
              information on how to enable threading in GridFTP server.</p></li><li class="listitem"><p>For client-server transfers, threaded globus-url-copy. For third-party
              (server-server) transfers, threaded globus-url-copy is not needed. Refer to
                <a href="#gridftp-admin-installing-threaded" class="olink">Section 3, &#8220;Enabling Threading in GridFTP&#8221;</a> for
              information on how to enable threading in
              globus-url-copy.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm14801055008"></a>1.2. Steps</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p> Build and install UDT </p><pre class="screen">globus$ make udt ("make gridftp udt" if gridftp is not built and installed already)
                
                globus$ make install</pre></li><li class="listitem"><p> Configure GridFTP server
              </p><pre class="screen">If you run the GridFTP server from xinetd, add '-dc-whitelist
                  udt,gsi,tcp' to 'server_args' in /etc/xinetd.d/gsiftp 
                </pre><p>
              Alternatively, you can use the file $GLOBUS_LOCATION/etc/gridftp.conf to configure
              this. Add the following to that file:
              </p><pre class="screen">
                  dc-whitelist udt,gsi,tcp
                </pre><p> If you
              run the server from commandline:
              </p><pre class="screen">
                  $GLOBUS_LOCATION/sbin/globus-gridftp-server -dc-whitelist
                  udt,gsi,tcp
                </pre></li><li class="listitem"><p> Run globus-url-copy with new command line option "-udt" </p></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-admin-separated"></a>2. Separation of Processes (Split Process)</h2></div></div></div><a class="indexterm" name="idm14801048128"></a><a class="indexterm" name="idm14801046720"></a><p>The GridFTP server can be separated into front end and data node processes. This is the
        architecture used to achieve a striped server, but it can also be exploited to achieve a
        higher level of security.</p><p>Running the server as <code class="computeroutput">root</code> is often desirable because it allows the server to fork and setuid
        on a child process related to an authenticated user. This allows the server to leverage the
        operating system's file system permissions and other security devices. However, it is not at
        all desirable to have a <code class="computeroutput">root</code>-running process listening on a
        port open to the world. If an attacker were to compromise the process, they could obtain
        root-level access to the machine.</p><p>To overcome this security risk, the GridFTP
        server can be run in a front end/back end manner. The front end can be run as any user, say
        user <code class="computeroutput">globus</code>, that has very limited access to the machine.
        The front end is the process open to the outside world. If it is compromised, an attacker
        has only gained access to that limited account. The back end is run as root, but configured
        to only allow connections from the front end.</p><p>This does, however, require that a
        copy of the <a href="../../admin/install/#gtadmin-basic-host" class="olink">host cert and host
          key</a> be owned by the non-privileged user. If you use this configuration, the
        non-privileged user should not have write permission to executables, configuration files,
        etc. This provides greater security and also allows for proxying and load balancing. Many
        backend data movers can be behind a single point of client contact. Each client is assigned
        a different backend in a round robin fashion.</p><p>To start the front end,
        run:</p><pre class="screen">globus-gridftp-server -p 7000 -r localhost:7001</pre><p>To start
        the back end,
      run:</p><pre class="screen">globus-gridftp-server -p 7001 -dn -allow-from 127.0.0.1</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-admin-striped"></a>3. Configuring GridFTP for Cluster-to-Cluster (or
        Striped) data movement</h2></div></div></div><a class="indexterm" name="idm14801038464"></a><p>The GridFTP server supports separate front end (client control connection) and back end
        (data node) processes. In addition, a single front end process may connect to multiple back
        end data nodes.</p><p>When multiple back end data nodes are available, the server is
        said to be in a <span class="emphasis"><em>striped</em></span> configuration, or simply, is a striped server.
        In this mode, transfers are divided over all available data nodes, thus allowing the
        combined bandwidth of all data nodes to be used.</p><p>This is recommended for
        improved performance of large (1GB+) file transfers. This can also be useful if you want to
        use full data encryption and need to tether together many hosts to handle the processing
        load. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The connection between the front end and data nodes is referred to as the
            <span class="emphasis"><em>IPC channel</em></span>.</p></td></tr></table></div><p>The ability to use inetd or daemon execution modes applies to both front end
        servers and data nodes, and the same certificate and user requirements apply.</p><p>To
        start the front end, run:
        </p><pre class="screen">globus-gridftp-server &lt;args&gt; -r &lt;host:port&gt;[,&lt;host:port&gt;,...]</pre><p>
        To start the data-node, run: </p><pre class="screen">globus-gridftp-server -p &lt;port&gt; -dn</pre><p> The
          <code class="computeroutput">-p &lt;port&gt;</code> option used on the data-node is the port
        that will be used for IPC connections. This is the port that you will register with the
        front end server.</p><p>For example:
        </p><pre class="screen">machineB&gt; globus-gridftp-server -p 6000 -dn
machineC&gt; globus-gridftp-server -p 7000 -dn
machineA&gt; globus-gridftp-server -p 5000 -r machineB:6000,machineC:7000</pre><p>
        The client would only connect to the front end at <code class="computeroutput">machineA:5000</code>, for example, using globus-url-copy with the
          <code class="option">-stripe</code> option:
        </p><pre class="screen">globus-url-copy -stripe gsiftp://machineA:5000/file file:///destination
   <span class="strong"><strong>or</strong></span>
globus-url-copy -stripe gsiftp://machineA:5000/file gsiftp://<em class="replaceable"><code>machineX</code></em>/destination</pre><p>
        Where machineX may be another striped server or a standard GridFTP server.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="combo-striped-split"></a>4. Combining Split Process and Striped configuration</h2></div></div></div><p>Furthermore striped servers and split process can be combined. You can have an 8 node
        cluster that only uses 2 nodes at a time in a striped server configuration and load balances
        across the rest of the nodes. TODO: any other details here?</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="chroot-gridftp"></a>5. Configuring chrooted GridFTP server</h2></div></div></div><p>GridFTP server can be configured to restrict access to specific
      path using the command-line option '-chroot-path &lt;path&gt;' This path 
must contain a valid certificate structure, /etc/passwd, and /etc/groups. A helper script 'globus-gridftp-server-setup-chroot' available in $GLOBUS_LOCATION/sbin, can help create a suitable directory structure.
     </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-admin-server-gfork"></a>6. Running with GFork Master Plugin</h2></div></div></div><a class="indexterm" name="idm14801023696"></a><p>GFork is a service like inetd that listens on a TCP port and runs a configurable
        executable in a child process whenever a connection is made. GFork also creates
        bi-directional pipes between the child processes and the master service. These pipes are
        used for interprocess communication between the child process executables and a master
        process plugin. More information on GFork can be found <a href="#gridftp-admin-gfork-master" class="olink">here</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-user-access"></a>7. Accessing data from other data interfaces</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm14797901376"></a>7.1. GridFTP and DSIs</h3></div></div></div><a class="indexterm" name="idm14799066256"></a><a class="indexterm" name="idm14798773984"></a><p>The following information is helpful if you want to use GridFTP to access data in DSIs (such as HPSS and SRB), and non-POSIX data sources.</p><p>Architecturally, the Globus GridFTP <a href="#server" class="glossterm"><em class="glossterm">server</em></a> can be divided into 3 modules:  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">the GridFTP protocol module,</li><li class="listitem"> the (optional) data transform module, and</li><li class="listitem">the Data Storage Interface (DSI).</li></ul></div><p>In the GT 6.0 implementation, the data transform module and the DSI have been merged, although we plan to have separate, chainable, data 
    transform modules in the future.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This architecture does NOT apply to the WU-FTPD implementation (GT3.2.1 and lower).</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gridftp-protocol"></a>7.1.1. GridFTP Protocol Module</h4></div></div></div><p>The GridFTP protocol module is the module that reads and writes to the network and implements the GridFTP protocol.  This module should not need to be 
      modified 
    since to do so would make the server non-protocol compliant, and unable to communicate with other servers.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gridftp-data_transform"></a>7.1.2. Data Transform Functionality</h4></div></div></div><p>The data transform functionality is invoked by using the ERET (extended retrieve) and ESTO (extended store) commands.  It is seldom used and bears careful 
  consideration before it is implemented, but in the right circumstances can be very useful.  In theory, any computation could be invoked this way, but it was primarily 
  intended for cases where some simple pre-processing (such as a partial get or sub-sampling) can greatly reduce the network load.  The disadvantage to this is 
  that you remove any real option for planning, brokering, etc., and any significant computation could adversely affect the data transfer performance.  Note that the 
    <a href="#client" class="glossterm"><em class="glossterm">client</em></a> must also support the ESTO/ERET functionality as well.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gridftp-dsi"></a>7.1.3. Data Storage Interface (DSI) / Data Transform module</h4></div></div></div><p>The Data Storage Interface (DSI) / Data Transform module knows how to read and write to the "local" storage system and can optionally transform the data.  
    We put local in quotes because in a complicated storage system, the storage may not be directly attached, but for performance reasons, it should be relatively close 
    (for instance on the same LAN). </p><p>The interface consists of functions to be implemented such as send (get), receive (put), command (simple commands that simply 
    succeed or fail like mkdir), etc..  </p><p>Once these functions have been implemented for a specific storage system, a client should not need to know or care what is actually 
    providing the data.  The server can either be configured specifically with a specific DSI, i.e., it knows how to interact with a single class of storage system, or one 
      particularly 
      useful function for the ESTO/ERET functionality mentioned above is to load and configure a DSI on the fly.</p><p>See <a href="../developer/#gridftp-developer-dsi" class="olink">Appendix B, <i>Developing DSIs for GridFTP</i></a> for more information.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-admin-dsis"></a>7.2. Plugging in a Data Storage Interface (DSI)</h3></div></div></div><a class="indexterm" name="idm14801019040"></a><p>GridFTP can be used as a network interface to existing Data Storage Interfaces (DSIs)
          using the <code class="option">-dsi</code> option. With this option the DSI plugs into the backend
          (compatible with striping) and is transparent to the client or remote party. It can be
          used with either the GT standard DSI plugins or with <a href="../developer/#gridftp-developer-dsi" class="olink">custom-built DSI plugins</a>. The standard DSI
          plugins available in a default GT installation are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a href="#gridftp-SRB" class="olink">Storage Resource Broker (SRB)</a></li></ul></div><p>The above link point to complete information about setting up and
          running the GridFTP server with these DSIs.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-howto-access-posix"></a>7.3. Accessing data in a non-POSIX file data source
          that has a POSIX interface</h3></div></div></div><a class="indexterm" name="idm14801013216"></a><a class="indexterm" name="idm14801012192"></a><p>If you want to access data in a non-POSIX file data source that has a POSIX interface,
          the standard server will do just fine. Just make sure it is really POSIX-like (out of
          order writes, contiguous byte writes, etc).</p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-admin-experimental"></a>Chapter 5. Experimental Features</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#gridftp-config-netlogger">1. Configuring GridFTP to enable Netlogger's bottleneck detection</a></span></dt><dt><span class="section"><a href="#gridftp-config-multi">2. Configuring multicasting/broadcasting</a></span></dt><dt><span class="section"><a href="#gridftp-admin-gwtftp">3. GridFTP Where There Is FTP (GWTFTP)</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-config-netlogger"></a>1. Configuring GridFTP to enable Netlogger's bottleneck detection</h2></div></div></div><p>For information on enabling bottleneck detection via Netlogger, see the <a class="ulink" href="http://www.cedps.net/index.php/Gridftp-netlogger" target="_top">Gridftp-netlogger</a> page on
        the CEDPS website.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-config-multi"></a>2. Configuring multicasting/broadcasting</h2></div></div></div><a class="indexterm" name="idm14801007088"></a><p>To enable <a href="../user/#gridftp-user-experimental-multicasting" class="olink">multicasting</a>, you must whitelist the <code class="computeroutput">gridftp_multicast</code> driver with the <code class="option">-fs-whitelist
          file,gridftp_multicast</code>
        option:</p><pre class="screen">globus-gridftp-server -fs-whitelist file,gridftp_multicast</pre><p>The
        above command whitelists both the <code class="computeroutput">file</code> driver and the
          <code class="computeroutput">gridftp_multicast</code> driver. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The <code class="computeroutput">file</code> driver is the default <a href="../../xio/#xio" class="olink">XIO</a> driver that handles reading and writing to file systems
            (disks). By default, this driver is already whitelisted. However, if you use the
              <code class="option">-fs-whitelist</code> option, you must set <span class="emphasis"><em>all</em></span> the
            drivers you want whitelisted (and the <code class="computeroutput">file</code> driver will
            still be needed to allow reads and writes to disk for non-multicast users.</p></td></tr></table></div><p>For information about using multicasting, click <a href="../user/#gridftp-user-experimental-multicasting" class="olink">here</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-admin-gwtftp"></a>3. GridFTP Where There Is FTP (GWTFTP)</h2></div></div></div><a class="indexterm" name="idm14800997440"></a><a class="indexterm" name="idm14800996416"></a><p>GridFTP Where There Is FTP (GWTFTP) is an intermediate program that acts as a proxy
        between existing FTP clients and GridFTP servers. Users can connect to GWFTP with their
        favorite standard FTP client, and GWFTP will then connect to a GridFTP server on the
        client&#8217;s behalf. To clients, GWFTP looks much like an FTP proxy server. When wishing to
        contact a GridFTP server, FTP clients instead contact GWTFTP.</p><p>Clients tell GWFTP
        their ultimate destination via the FTP <span class="command"><strong>USER
            <em class="replaceable"><code>&lt;username&gt;</code></em></strong></span> command. Instead of entering their
        username, client users send the
        following:</p><pre class="screen">USER <em class="replaceable"><code>&lt;GWTFTP username&gt;</code></em>::<em class="replaceable"><code>&lt;GridFTP server URL&gt;</code></em></pre><p>This
        command tells GWTFTP the GridFTP endpoint with which the client wants to communicate. For
        example:</p><pre class="screen">USER bresnaha::gsiftp://wiggum.mcs.anl.gov:2811/</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Requires <a href="../../gsic/#gsic" class="olink">GSI C security</a>.</p></td></tr></table></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-admin-testing"></a>Chapter 6. Testing</h1></div></div></div><a class="indexterm" name="idm14800989344"></a><a class="indexterm" name="idm14800988320"></a><p>If the globus-ftp-client-test package has been installed, our standard test suite may be
      run to verify functionality on your platform. Simply set up the globus environment, chdir to
        <code class="computeroutput">$GLOBUS_LOCATION/test/globus_ftp_client_test/</code> and run
        <code class="computeroutput">./TESTS.pl</code>.</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-admin-debugging"></a>Chapter 7. Debugging</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#gridftp-logging">1. Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#idm14799622080">1.1. Configuring CEDPS format system administration logs</a></span></dt><dt><span class="section"><a href="#idm14798222704">1.2. Configuring traditional format system administration logs</a></span></dt><dt><span class="section"><a href="#idm14796722320">1.3. Netlogger-style logging</a></span></dt></dl></dd></dl></div><a class="indexterm" name="idm14800984496"></a><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-logging"></a>1. Logging</h2></div></div></div><a class="indexterm" name="idm14800716256"></a><p>As of Globus 4.2.0, GridFTP server provides system administration logs in 2 different formats. The CEDPS best practices compliant format is a new format 
provided by GridFTP server available in Globus 6.0. For more details on the CEDPS Logging format, see 
<a class="ulink" href="http://cedps.net/index.php/LoggingBestPractices" target="_top">http://cedps.net/index.php/LoggingBestPractices</a>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm14799622080"></a>1.1. Configuring CEDPS format system administration logs</h3></div></div></div><pre class="screen">globus-gridftp-server -log-module stdio_ng -log-level info,warn,error -logfile /var/log/gridftp.log</pre><p>For more information about the logging options, see <a href="#globus-gridftp-server" class="olink">globus-gridftp-server(8)</a>.</p><p>Sample log file: <a class="ulink" href="/toolkit/docs/6/6.0/data/gridftp/gridftp.log1" target="_top">gridftp.log1</a></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm14798222704"></a>1.2. Configuring traditional format system administration logs</h3></div></div></div><pre class="screen">globus-gridftp-server -log-module stdio -log-level info,warn,error -logfile /var/log/gridftp.log</pre><p>which is the same as</p><pre class="screen">globus-gridftp-server -log-level info,warn,error -logfile /var/log/gridftp.log</pre><p><code class="code">stdio</code> is the default log-module.</p><p>Sample log file: <a class="ulink" href="/toolkit/docs/6/6.0/data/gridftp/gridftp.log2" target="_top">gridftp.log2</a></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm14796722320"></a>1.3. Netlogger-style logging</h3></div></div></div><p>Apart from the 2 formats mentioned above, GridFTP server can log netlogger style information for each transfer.</p><pre class="screen">globus-gridftp-server -log-transfer /var/log/gridftp.log</pre><p>Sample log file: <a class="ulink" href="/toolkit/docs/6/6.0/data/gridftp/gridftp.log3" target="_top">gridftp.log3</a></p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-troubleshooting"></a>Chapter 8. Troubleshooting</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#gridftp-error-codes">1. Error Codes in GridFTP</a></span></dt><dt><span class="section"><a href="#idm14795509776">2. Establish control channel connection</a></span></dt><dt><span class="section"><a href="#idm14794461024">3. Try running globus-url-copy</a></span></dt><dt><span class="section"><a href="#idm14792476032">4. If your server starts...</a></span></dt><dt><span class="section"><a href="#gridftp-troubleshooting-latency">5. High latency for GridFTP server connections</a></span></dt></dl></div><a class="indexterm" name="idm14797881584"></a><a class="indexterm" name="idm14793767040"></a><p>If you are having problems using the GridFTP <a href="#server" class="glossterm"><em class="glossterm">server</em></a>, try the steps
        listed below. If you have an error, try checking the server logs if you have access to them.
        By default, the server logs to stderr, unless it is running from inetd, or its execution
        mode is detached, in which case logging is disabled by default. </p><p> The command
        line options -d , -log-level, -L and -logdir can affect where logs will be written, as can
        the configuration file options log_single and log_unique. See the <a href="../pi/#globus-gridftp-server" class="olink">globus-gridftp-server(8)</a> for more information on these
            and other configuration options.</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-error-codes"></a>1. Error Codes in GridFTP</h2></div></div></div><a class="indexterm" name="idm14800160464"></a><div class="table"><a name="gridftp-errors-table"></a><p class="title"><b>Table 8.1. GridFTP Errors</b></p><div class="table-contents"><table summary="GridFTP Errors" border="1" width="700px"><colgroup><col align="left" class="c1"><col align="left" class="c2"><col align="left" class="c3"></colgroup><thead><tr><th align="left">Error Code</th><th align="left">Definition</th><th align="left">Possible Solutions</th></tr></thead><tbody><tr><td align="left"><code class="code">
    globus_ftp_client: the server responded with an error
530 530-globus_xio: Authentication Error
530-OpenSSL Error: s3_srvr.c:2525: in library: SSL routines, 
     function SSL3_GET_CLIENT_CERTIFICATE: no certificate returned
530-globus_gsi_callback_module: Could not verify credential
530-globus_gsi_callback_module: Can't get the local trusted CA certificate: 
Untrusted self-signed certificate in chain with hash d1b603c3
530 End.
  </code></td><td align="left">This error message indicates that the GridFTP server doesn't trust the certificate authority (CA) that issued your certificate.</td><td align="left">
You need to ask the GridFTP server administrator to install your CA certificate chain in the GridFTP server's trusted certificates directory.
  </td></tr><tr><td align="left"><code class="code">
  globus_ftp_control: gss_init_sec_context failed
OpenSSL Error: s3_clnt.c:951: in library: SSL routines, function 
SSL3_GET_SERVER_CERTIFICATE: certificate verify failed
globus_gsi_callback_module: Could not verify credential
globus_gsi_callback_module: Can't get the local trusted CA certificate: 
Untrusted self-signed certificate in chain with hash d1b603c3
    </code></td><td align="left">This error message indicates that your local system doesn't trust the certificate authority (CA) that issued the certificate on the resource you are connecting to.</td><td align="left">
You need to ask the resource administrator which CA issued their certificate and  install the CA certificate in the local trusted certificates directory.
  </td></tr><tr><td align="left"><code class="code">
  530-globus_xio: Authentication Error
  530-globus_gsi_callback_module: Could not verify credential
  530-globus_gsi_callback_module: Could not verify credential
  530-globus_gsi_callback_module: Invalid CRL: The available CRL has expired
  530 End.
    </code></td><td align="left">This error message indicates one of the following: 
  Certificate
  Revocation List (CRL) for the source or destination server CA at the client has
  expired or CRL for client CA has expired at source or destination server or
  CRL for source (destination) server CA has expired at destination (source)
  server. CRL is a file {CA_hash}.r0 in /etc/grid-security/certificates or
  ${USER_HOME}/.globus/certificates or ${X509_CERT_DIR}
  </td><td align="left">
  The tool available at http://dist.eugridpma.info/distribution/util/fetch-crl/
  can be run in a crontab to keep the CRLs up to date.
  </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="idm14795509776"></a>2. Establish control channel connection</h2></div></div></div><p>Verify that you can establish a control channel connection and that the server has
            started successfully by telnetting to the port on which the server is running: </p><pre class="screen">% telnet localhost 2811
                Trying 127.0.0.1...
                Connected to localhost.
                Escape character is '^]'.
                220 GridFTP Server mldev.mcs.anl.gov 2.0 (gcc32dbg, 1113865414-1) ready.</pre><p>If you see anything other than a 220 banner such as the one above, the server has not
            started correctly.</p><p>Verify that there are no configuration files being unexpectedly loaded from
            /etc/grid-security/gridftp.conf or $GLOBUS_LOCATION/etc/gridftp.conf. If those files
            exist, and you did not intend for them to be used, rename them to .save, or specify -c
            none on the command line and try again.</p><p>If you can log into the machine where the server is, try running the server from the
            command line with only the -s option: </p><pre class="screen">$GLOBUS_LOCATION/sbin/globus-gridftp-server -s</pre><p>The server will print the port it is listening on: </p><pre class="screen">Server listening at gridftp.mcs.anl.gov:57764</pre><p>Now try and telnet to that port. If you still do not get the banner listed above,
            something is preventing the socket connection. Check firewalls, tcp-wrapper, etc.</p><p>If you now get a correct banner, add -p 2811 (you will have to disable (x)inetd on
            port 2811 if you are using them or you will get port already in use):</p><pre class="screen">$GLOBUS_LOCATION/sbin/globus-gridftp-server -s -p 2811</pre><p>Now telnet to port 2811. If this does not work, something is blocking port 2811. Check
            firewalls, tcp-wrapper, etc.</p><p>If this works correctly then re-enable your normal server, but remove all options but
            -i, -s, or -S.</p><p>Now telnet to port 2811. If this does not work, something is wrong with your service
            configuration. Check /etc/services and (x)inetd config, have (x)inetd restarted, etc.</p><p>If this works, begin adding options back one at a time, verifying that you can telnet
            to the server after each option is added. Continue this till you find the problem or get
            all the options you want. </p><p>At this point, you can establish a control connection. Now try running
            globus-url-copy.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="idm14794461024"></a>3. Try running globus-url-copy</h2></div></div></div><p>Once you've verified that you can establish a control connection, try to make a
            transfer using globus-url-copy.</p><p>If you are doing a <a href="#client" class="glossterm"><em class="glossterm">client</em></a>/server transfer (one of your URLs has
                <code class="filename">file:</code> in it) then try:</p><pre class="screen">globus-url-copy -vb -dbg gsiftp://host.server.running.on/dev/zero file:///dev/null</pre><p>This will run until you control-c the transfer. If that works, reverse the direction:</p><pre class="screen">globus-url-copy -vb -dbg file:///dev/zero gsiftp://host.server.running.on/dev/null</pre><p>Again, this will run until you control-c the transfer.</p><p>If you are doing a <a href="#third-party-transfers" class="glossterm"><em class="glossterm">third party
            transfer</em></a>, run this command:</p><pre class="screen">globus-url-copy -vb -dbg gsiftp://host.server1.on/dev/zero gsiftp://host.server2.on/dev/null</pre><p>Again, this will run until you control-c the transfer.</p><p>If the above transfers work, try your transfer again. If it fails, you likely have
            some sort of file permissions problem, typo in a file name, etc.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="idm14792476032"></a>4. If your server starts...</h2></div></div></div><p>If the server has started correctly, and your problem is with a security failure or
            gridmap lookup failure, verify that you have security configured properly <a href="../../admin/install/#gtadmin-basic-security" class="olink">here</a>.</p><p>If the server is running and your client successfully authenticates but has a problem
            at some other time during the session, please ask for help on <a class="ulink" href="http://dev.globus.org/wiki/Mailing_Lists" target="_top">gt-user@globus.org</a>. When you
            send mail or submit bugs, please always include as much of the following information as
            possible:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Specs on all hosts involved (OS, processor, RAM, etc).</li><li class="listitem">globus-url-copy -version</li><li class="listitem">globus-url-copy -versions </li><li class="listitem">Output from the telnet test above.</li><li class="listitem">The actual command line you ran with -dbg added. Don't worry if the output
                    gets long.</li><li class="listitem">Check that you are getting a FQDN and /etc/hosts that is sane.</li><li class="listitem">The server configuration and setup (/etc/services entries, (x)inetd
                    configs, etc.).</li><li class="listitem"> Any relevant lines from the server logs (not the entire log
                please).</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-troubleshooting-latency"></a>5. High latency for GridFTP server connections</h2></div></div></div><p> If you run GridFTP servers via Xinetd and notice high latency for connections and/or
            transfers, check if <code class="filename">/etc/xinetd.conf</code> or the gsiftp service
            configuration inside <code class="filename">/etc/xinetd.d</code> is set to log USERID as follows:
            </p><pre class="screen">log_on_success += USERID
log_on_failure += USERID</pre><p>Such a configuration tells Xinetd to log the remote user using the method defined in
            RFC 1413, which causes an ident client to attempt to query the machine that the
            connection is coming from before the service will run. Even when this succeeds, the
            response can't be trusted, and more often than not it is rejected or simply dropped
            (which results in the longest delays) by the remote firewall.</p><p>Latency can be reduced by making sure Xinetd does <span class="emphasis"><em>not</em></span> log the
            USERID.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-usage"></a>Chapter 9. Usage statistics collection by the Globus Alliance </h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#gridftp-usage-stats">1. GridFTP-specific usage statistics</a></span></dt></dl></div><a class="indexterm" name="idm14793036512"></a><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-usage-stats"></a>1. GridFTP-specific usage statistics</h2></div></div></div><p>
The following GridFTP-specific usage statistics are sent in a UDP packet at 
the end of each transfer, in addition to the standard header information 
described in the  <a class="ulink" href="/toolkit/docs/6/6.0/Usage_Stats.html" target="_top">Usage Stats</a> section.
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"> Start time of the transfer </li><li class="listitem"> End time of the transfer </li><li class="listitem"> Version string of the server </li><li class="listitem"> TCP buffer size used for the transfer </li><li class="listitem"> Block size used for the transfer </li><li class="listitem"> Total number of bytes transferred </li><li class="listitem"> Number of parallel streams used for the transfer </li><li class="listitem"> Number of stripes used for the transfer </li><li class="listitem"> Type of transfer (STOR, RETR, LIST) </li><li class="listitem"> FTP response code -- Success or failure of the transfer </li></ul></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The client (globus-url-copy) does NOT send any data.  It is the <span class="emphasis"><em>servers</em></span> that send the usage statistics.</p></td></tr></table></div><p> 
We have made a concerted effort to collect only data that is not too intrusive 
or private and yet still provides us with information that will help improve 
and gauge the usage of the GridFTP server.  Nevertheless, if you wish to disable 
this feature for GridFTP only, use the <code class="option">-disable-usage-stats</code> option of <a href="#globus-gridftp-server" class="olink">globus-gridftp-server</a>.  Note that you can disable transmission
of usage statistics globally for all C components by setting 
"GLOBUS_USAGE_OPTOUT=1" in your environment.  
</p><p>Also, please see our <a class="ulink" href="/toolkit/docs/latest-stable/Usage_Stats.html" target="_top">policy statement</a> on
  the collection of usage statistics. </p></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-admin-command"></a>Appendix A. GridFTP Admin Tool</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="refentrytitle"><a href="#globus-gridftp-server">globus-gridftp-server</a></span><span class="refpurpose"> &#8212; Configures the GridFTP Server</span></dt></dl></div><div class="refentry"><a name="globus-gridftp-server"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>globus-gridftp-server &#8212; Configures the GridFTP Server</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="command">globus-gridftp-server</code> </p></div></div><div class="refsect1"><a name="idm14792596704"></a><h2>Tool description</h2><a class="indexterm" name="idm14792527120"></a><a class="indexterm" name="idm14793285296"></a><p><span class="command"><strong>globus-gridftp-server</strong></span> configures the GridFTP server using a config file
      and/or commandline options.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Command line options and configuration file options may both be used, but the command
        line <span class="emphasis"><em>overrides</em></span> the config file.</p></td></tr></table></div><p>The configuration file for the GridFTP <a href="#server" class="glossterm"><em class="glossterm">server</em></a> is read from
      the following locations, in the given order. Only the first file found will be loaded:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Path specified with the <code class="computeroutput">-c &lt;configfile&gt;</code>
            command line option.</li><li class="listitem">
            <code class="filename">$GLOBUS_LOCATION/etc/gridftp.conf</code>
          </li><li class="listitem">
            <code class="filename">/etc/grid-security/gridftp.conf</code>
          </li></ul></div><p>Options are one per line, with the format:
      </p><pre class="screen">&lt;option&gt; &lt;value&gt;</pre><p> If the value contains spaces, they should be
      enclosed in double-quotes ("). Flags or boolean options should only have a value of 0 or 1.
      Blank lines and lines beginning with # are ignored.</p><p>For example:
      </p><pre class="screen">  port 5000
  allow_anonymous 1
  anonymous_user bob
  banner "Welcome!"
      </pre><div class="refsect2"><a name="idm14796686608"></a><h3>Developer notes</h3><p>The Globus implementation of the GridFTP <a href="#server" class="glossterm"><em class="glossterm">server</em></a> draws on: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>three IETF RFCs: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">RFC 959</li><li class="listitem">RFC 2228</li><li class="listitem">RFC 2389</li></ul></div></li><li class="listitem"> an IETF Draft: MLST-16</li><li class="listitem">the GridFTP protocol specification, which is Global Grid Forum (GGF) Standard
              GFD.020.</li></ul></div><p>The command line tools and the <a href="#client" class="glossterm"><em class="glossterm">client</em></a> library completely hide the
        details of the protocol from the user and the developer. Unless you choose to use the
        control library, it is not necessary to have a detailed knowledge of the protocol.</p></div></div><div class="refsect1"><a name="idm14796678704"></a><h2>Command syntax</h2><p>The basic syntax for <span class="command"><strong>globus-gridftp-server</strong></span> is:
      </p><pre class="screen">globus-gridftp-server <a href="#commandlineoptions-server" class="olink">[optional command line switches]</a></pre><p>To use <span class="command"><strong>globus-gridftp-server</strong></span> with a config file, make sure to use the
        <code class="option">-c &lt;configfile&gt;</code> option.</p></div><div class="refsect1"><a name="commandlineoptions-server"></a><h2>Command line options</h2><p>The table below lists config file options, associated command line options (if available)
      and descriptions. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Any boolean option can be negated on the command line by preceding the specified option
        with '-no-' or '-n'. example: -no-cas or -nf.</p></td></tr></table></div><div class="refsect2"><a name="gridftp-server-config_options-info"></a><h3>Informational Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">help &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-h</code>
          , </span><span class="term">
            <code class="option">-help</code>
          </span></dt><dd><p>Show usage information and exit.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">version &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-v</code>
          , </span><span class="term">
            <code class="option">-version</code>
          </span></dt><dd><p>Show version information for the server and exit.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">versions &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-V</code>
          , </span><span class="term">
            <code class="option">-versions</code>
          </span></dt><dd><p>Show version information for <span class="strong"><strong>all</strong></span> loaded globus
              libraries and exit.</p><p>Default value: FALSE</p></dd></dl></div></div><div class="refsect2"><a name="gridftp-server-config_options-modes"></a><h3>Modes of Operation</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">inetd &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-i</code>
          , </span><span class="term">
            <code class="option">-inetd</code>
          </span></dt><dd><p>Run under an inetd service.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">daemon &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-s</code>
          , </span><span class="term">
            <code class="option">-daemon</code>
          </span></dt><dd><p>Run as a daemon. All connections will fork off a new process and setuid if
              allowed. See <a href="#gridftp-admin-daemon_mode" class="olink">Section 4.4.1, &#8220;Running in daemon mode&#8221;</a>
              for more information.</p><p>Default value: TRUE</p></dd><dt><span class="term">
            <code class="option">detach &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-S</code>
          , </span><span class="term">
            <code class="option">-detach</code>
          </span></dt><dd><p>Run as a background daemon detached from any controlling terminals. See <a href="#gridftp-admin-daemon_mode" class="olink">Section 4.4.1, &#8220;Running in daemon mode&#8221;</a> for more
              information.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">ssh</code>
          , </span><span class="term">
            <code class="option">-ssh</code>
          </span></dt><dd><p>Run over a connected ssh session. </p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">exec &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-exec &lt;string&gt;</code>
          </span></dt><dd><p>For statically compiled or non-GLOBUS_LOCATION standard binary locations, specify
              the full path of the server binary here. Only needed when run in <a href="#gridftp-admin-daemon_mode" class="olink">daemon
              mode</a>.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">chdir &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-chdir</code>
          </span></dt><dd><p>Change directory when the server starts. This will change directory to the dir
              specified by the chdir_to option.</p><p>Default value: TRUE</p></dd><dt><span class="term">
            <code class="option">chdir_to &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-chdir-to &lt;string&gt;</code>
          </span></dt><dd><p>Directory to chdir to after starting. Will use <code class="computeroutput">/</code>
              if not set.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">fork &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-f</code>
          , </span><span class="term">
            <code class="option">-fork</code>
          </span></dt><dd><p>Server will fork for each new connection. Disabling this option is only
              recommended when debugging. Note that non-forked servers running as 'root' will only
              accept a single connection and then exit.</p><p>Default value: TRUE</p></dd><dt><span class="term">
            <code class="option">single &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-1</code>
          , </span><span class="term">
            <code class="option">-single</code>
          </span></dt><dd><p>Exit after a single connection.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">chroot_path &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-chroot-path &lt;string&gt;</code>
          </span></dt><dd><p>Path to become the new root after authentication.  This path must contain a valid certificate structure, <code class="filename">/etc/passwd</code>, and <code class="filename">/etc/groups</code>.  The command globus-gridftp-server-setup-chroot can help create a suitable directory structure. </p><p>Default value: not set</p></dd></dl></div></div><div class="refsect2"><a name="gridftp-server-config_options-security"></a><h3>Authentication, Authorization, and Security Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">auth_level &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-auth-level &lt;number&gt;</code>
          </span></dt><dd><p>
              </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">0 = Disables all authorization checks.</li><li class="listitem">1 = Authorize identity only.</li><li class="listitem">2 = Authorize all file/resource accesses.</li></ul></div><p>
            </p><p>If not set, the GridFTP Server uses level 2 for front ends and level 1 for data
              nodes.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">ipc_allow_from &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-ipc-allow-from &lt;string&gt;</code>
          </span></dt><dd><p>Only allow IPC connections (applicable for backend servers in a striped
              configuration) from these source IP addresses. Specify a comma-separated list of IP
              address fragments. A match is any IP address that starts with the specified fragment.
              Example: '192.168.1.' will match and allow a connection from 192.168.1.45. Note that
              if this option is used, any address not specifically allowed will be denied.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">ipc_deny_from &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-ipc-deny-from &lt;string&gt;</code>
          </span></dt><dd><p>Deny IPC connections (applicable for backend servers in a striped configuration)
              from these source IP addresses. Specify a comma-separated list of IP address
              fragments. A match is any IP address that starts with the specified fragment. Example:
              '192.168.2.' will match and deny a connection from 192.168.2.45.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">allow_from &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-allow-from &lt;string&gt;</code>
          </span></dt><dd><p>Only allow connections from these source IP addresses. Specify a comma-separated
              list of IP address fragments. A match is any IP address that starts with the specified
              fragment. Example: '192.168.1.' will match and allow a connection from 192.168.1.45.
              Note that if this option is used, any address not specifically allowed will be
              denied.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">deny_from &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-deny-from &lt;string&gt;</code>
          </span></dt><dd><p>Deny connections from these source IP addresses. Specify a comma-separated list of
              IP address fragments. A match is any IP address that starts with the specified
              fragment. Example: '192.168.2.' will match and deny a connection from
              192.168.2.45.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">secure_ipc &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-si</code>
          , </span><span class="term">
            <code class="option">-secure-ipc</code>
          </span></dt><dd><p>Use GSI security on the IPC channel.</p><p>Default value: TRUE</p></dd><dt><span class="term">
            <code class="option">ipc_auth_mode &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-ia &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-ipc-auth-mode &lt;string&gt;</code>
          </span></dt><dd><p>Set GSI authorization mode for the IPC connection. Options are one of the
              following: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">none</li><li class="listitem">host</li><li class="listitem">self</li><li class="listitem">subject:[subject]</li></ul></div><p>Default value: host</p></dd><dt><span class="term">
            <code class="option">allow_anonymous &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-aa</code>
          , </span><span class="term">
            <code class="option">-allow-anonymous</code>
          </span></dt><dd><p>Allow cleartext anonymous access. If server is running as root, anonymous_user
              must also be set. Disables IPC security.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">anonymous_names_allowed &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-anonymous-names-allowed &lt;string&gt;</code>
          </span></dt><dd><p>Comma-separated list of names to treat as anonymous users when allowing anonymous
              access. If not set, the default names of 'anonymous' and 'ftp' will be allowed. Use
              '*' to allow any username.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">anonymous_user &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-anonymous-user &lt;string&gt;</code>
          </span></dt><dd><p>User to setuid to for an anonymous connection. Only applies when running as
              root.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">anonymous_group &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-anonymous-group &lt;string&gt;</code>
          </span></dt><dd><p>Group to setgid to for an anonymous connection. If not set, the default group of
              anonymous_user will be used.</p><p>Default value: not set</p></dd><dt><span class="term">
	    <code class="option">allow_root</code>
	  , </span><span class="term">
	    <code class="option">-allow-root</code>
	  </span></dt><dd><p>Allow clients to be mapped to the root account.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">pw_file &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-password-file &lt;string&gt;</code>
          </span></dt><dd><p>Enable cleartext access and authenticate users against this <code class="filename">/etc/passwd</code> formatted file.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">connections_max &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-connections-max &lt;number&gt;</code>
          </span></dt><dd><p>Maximum concurrent connections allowed. Only applies when running in <a href="#gridftp-admin-daemon_mode" class="olink">daemon mode</a>.
              Unlimited if not set.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">connections_disabled &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-connections-disabled</code>
          </span></dt><dd><p>Disable all new connections. Does not affect ongoing connections. This must be set
              in the configuration file and then a SIGHUP issued to the server in order to reload
              the configuration.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">offline_msg &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-offline-msg &lt;string&gt;</code>
          </span></dt><dd><p> Custom message to be displayed to clients when the server is offline via the
              connections_disabled or connections_max = 0 options. </p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">disable_command_list &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-disable-command-list &lt;string&gt;</code>
          </span></dt><dd><p> A comma seperated list of client commands that will be disabled. </p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">authz_callouts </code>
          , </span><span class="term">
            <code class="option">-authz-callouts </code>
          </span></dt><dd><p> Enable the GSI authorization callout framework. </p><p>Default value: TRUE</p></dd><dt><span class="term">
	    <code class="option">restrict_paths </code>
	  , </span><span class="term">
	    <code class="option">-rp </code>
	  , </span><span class="term">
	    <code class="option">-restrict-paths </code>
	  </span></dt><dd><p>A comma separated list of full paths that clients may access.
	    Each path may be prefixed by R and/or W, denoting read or write
	    access, otherwise full access is granted.  If a given path is a
	    directory, all contents and subdirectories will be given the same
	    access.  Order of paths does not matter -- the permissions on the
	    longest matching path will apply.  The special character '~' will be
	    replaced by the authenticated user's home directory.  Note that if
	    the authenticated user's home directory is not accessible, the home
	    directory and starting path will be set to '/'.  By default all
	    paths are allowed, and access control is handled by the OS.
	    </p><p>Default value: not set</p></dd><dt><span class="term">
	    <code class="option">rp_follow_symlinks </code>
	  , </span><span class="term">
	    <code class="option">-rp-follow-symlinks </code>
	  </span></dt><dd><p>Allow following symlinks that lead to restricted paths.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">acl </code>
          , </span><span class="term">
            <code class="option">-em</code>
          , </span><span class="term">
            <code class="option">-acl </code>
          </span></dt><dd><p> A comma seperated list of ACL or event modules to load. </p><p>Default value: not set</p></dd></dl></div></div><div class="refsect2"><a name="gridftp-server-config_options-logging"></a><h3>Logging Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">log_level &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-d &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-log-level &lt;string&gt;</code>
          </span></dt><dd><p>Log level. A comma-separated list of levels from the following: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">ERROR</li><li class="listitem">WARN</li><li class="listitem">INFO</li><li class="listitem">DUMP</li><li class="listitem">ALL</li></ul></div><p> For example:
              </p><pre class="screen">globus-gridftp-server -d error,warn,info</pre><p>You may also specify a
              numeric level of 1-255.</p><p>Default value: ERROR</p></dd><dt><span class="term">
            <code class="option">log_module &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-log-module &lt;string&gt;</code>
          </span></dt><dd><p>Indicates the <code class="filename">globus_logging</code> module that will be loaded. If
              not set, the default <code class="computeroutput">stdio</code> module will be used and
              the logfile options (see next option) will apply. </p><p>Built-in modules are <code class="computeroutput">stdio</code> and <code class="computeroutput">syslog</code>. Log module options may be set by specifying
                <code class="computeroutput">module:opt1=val1:opt2=val2</code>. Available options for
              the built-in modules are: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="option">interval</code> - Indicates buffer flush interval. Default is 5
                    seconds. A 0 second flush interval will disable periodic flushing, and the
                    buffer will only flush when it is full.</p></li><li class="listitem"><p><code class="option">buffer</code> - Indicates buffer size. Default is 64k. A value of
                    0k will disable buffering and all messages will be written immediately.</p></li></ul></div><p> Example:
              </p><pre class="screen">-log-module stdio:buffer=4096:interval=10</pre><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">log_single &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-l &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-logfile &lt;string&gt;</code>
          </span></dt><dd><p>Indicates the path of a single file to which you want to log all activity. If
              neither this option nor <code class="computeroutput">log_unique</code> is set, logs will
              be written to stderr, unless the execution mode is detached, or inetd, in which case
              logging will be disabled.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p> You have to provide full path </p></td></tr></table></div><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">log_unique &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-L &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-logdir &lt;string&gt;</code>
          </span></dt><dd><p>Partial path to which <code class="computeroutput">gridftp.(pid).log</code> will be
              appended to construct the log filename. Example: </p><pre class="screen">-L /var/log/gridftp/</pre><p>
              will create a separate log (<code class="filename">/var/log/gridftp/gridftp.xxxx.log</code>)
              for each process (which is normally each new <a href="#client" class="glossterm"><em class="glossterm">client</em></a> session).
              If neither this option nor <code class="computeroutput">log_single</code> is set, logs
              will be written to stderr, unless the execution mode is detached, or inetd, in which
              case logging will be disabled.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p> You have to provide full path </p></td></tr></table></div><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">log_transfer &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-Z &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-log-transfer &lt;string&gt;</code>
          </span></dt><dd><p>Log NetLogger-style info for each transfer into this file.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p> You have to provide full path </p></td></tr></table></div><p>Default value: not set</p><p> Example: DATE=20050520163008.306532 HOST=localhost PROG=globus-gridftp-server
              NL.EVNT=FTP_INFO START=20050520163008.305913 USER=ftp FILE=/etc/group BUFFER=0
              BLOCK=262144 NBYTES=542 VOLUME=/ STREAMS=1 STRIPES=1 DEST=[127.0.0.1] TYPE=RETR
              CODE=226 </p><p>Time format is YYYYMMDDHHMMSS.UUUUUU (microsecs).</p><p>
              </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">DATE: time the transfer completed.</li><li class="listitem">START: time the transfer started.</li><li class="listitem">HOST: hostname of the server.</li><li class="listitem">USER: username on the host that transfered the file.</li><li class="listitem">BUFFER: tcp buffer size (if 0 system defaults were used).</li><li class="listitem">BLOCK: the size of the data block read from the disk and posted to the
                    network.</li><li class="listitem">NBYTES: the total number of bytes transfered.</li><li class="listitem">VOLUME: the disk partition where the transfer file is stored.</li><li class="listitem">STREAMS: the number of parallel TCP streams used in the
                    transfer.</li><li class="listitem">STRIPES: the number of stripes used on this end of the
                    transfer.</li><li class="listitem">DEST: the destination host.</li><li class="listitem">TYPE: the transfer type, RETR is a send and STOR is a receive (ftp 959
                    commands).</li><li class="listitem">CODE: the FTP rfc959 completion code of the transfer. 226 indicates
                    success, 5xx or 4xx are failure codes.</li></ul></div><p>
            </p></dd><dt><span class="term">
            <code class="option">log_filemode &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-log-filemode &lt;string&gt;</code>
          </span></dt><dd><p>File access permissions of log files. Should be an octal number such as 0644 (the
              leading 0 is required).</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">disable_usage_stats &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-disable-usage-stats</code>
          </span></dt><dd><p>Disable transmission of per-transfer usage statistics. See the <a class="ulink" href="../../../Usage_Stats.html" target="_top">Usage Statistics</a> section in the online
              documentation for more information.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">usage_stats_target &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-usage-stats-target &lt;string&gt;</code>
          </span></dt><dd><p>Comma-separated list of contact strings for usage statistics listeners. The format
              of &lt;string&gt; is <code class="computeroutput">host:port</code>.</p><p>Default value: <code class="computeroutput">usage-stats.globus.org:4810</code></p><p>
              <span class="strong"><strong>Example:</strong></span>
            </p><pre class="screen">-usage-stats-target usage-stats.globus.org:4810,usage-stats.uc.teragrid.org:5920</pre><p>In this example, the usage statistics will be transmitted to the default Globus
              target (<code class="computeroutput">usage-stats.globus.org:4810</code>) and another
              target (<code class="computeroutput">usage-stats.uc.teragrid.org:5920</code>).</p><p> The usage stats sent to a particular receiver may be customized by configuring it
              with a taglist (host:port!taglist) The taglist is a list of characters that each
              correspond to a usage stats tag. When this option is unset, stats are reported to
              usage-stats.globus.org:4810. If you set your own receiver, and wish to continue
              reporting to the Globus receiver, you will need to add it manually. The list of
              available tags follow. Tags marked * are reported by default.</p><p>
              </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"> *(e) START - start time of transfer </li><li class="listitem"> *(E) END - end time of transfer </li><li class="listitem"> *(v) VER - version string of gridftp server </li><li class="listitem"> *(b) BUFFER - tcp buffer size used for transfer </li><li class="listitem"> *(B) BLOCK - disk blocksize used for transfer </li><li class="listitem"> *(N) NBYTES - number of bytes transferred </li><li class="listitem"> *(s) STREAMS - number of parallel streams used </li><li class="listitem"> *(S) STRIPES - number of stripes used </li><li class="listitem"> *(t) TYPE - transfer command: RETR, STOR, LIST, etc </li><li class="listitem"> *(c) CODE - ftp result code (226 = success, 5xx = fail) </li><li class="listitem"> *(D) DSI - DSI module in use </li><li class="listitem"> *(A) EM - event modules in use </li><li class="listitem"> *(T) SCHEME - ftp, gsiftp, sshftp, etc. (client supplied) </li><li class="listitem"> *(a) APP - guc, rft, generic library app, etc. (client supplied)
                  </li><li class="listitem"> *(V) APPVER - version string of above. (client supplied) </li><li class="listitem"> (f) FILE - name of file/data transferred </li><li class="listitem"> (i) CLIENTIP - ip address of host running client (control channel)
                  </li><li class="listitem"> (I) DATAIP - ip address of source/dest host of data (data channel)
                  </li><li class="listitem"> (u) USER - local user name the transfer was performed as </li><li class="listitem"> (d) USERDN - DN that was mapped to user id </li><li class="listitem"> (C) CONFID - ID defined by -usage-stats-id config option </li><li class="listitem"> (U) SESSID - unique id that can be used to match transfers in a session
                    and transfers across source/dest of a third party transfer. (client supplied)
                  </li></ul></div><p>
            </p></dd><dt><span class="term">
            <code class="option">usage_stats_id &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-usage-stats-id &lt;string&gt;</code>
          </span></dt><dd><p> Identifying tag to include in usage statistics data. </p><p>Default value: not set</p></dd></dl></div></div><div class="refsect2"><a name="gridftp-server-config_options-remotedata"></a><h3>Single and Striped Remote Data Node Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">remote_nodes &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-r &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-remote-nodes &lt;string&gt;</code>
          </span></dt><dd><p>Comma-separated list of remote node contact strings. See <a href="#gridftp-admin-striped" class="olink">Remote data-nodes and
                striped operations</a> and <a href="#gridftp-admin-separated" class="olink">Separation of processes for higher
                security</a> for examples of using this option.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">data_node &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-dn</code>
          , </span><span class="term">
            <code class="option">-data-node</code>
          </span></dt><dd><p>This server is a back end data node. See <a href="#gridftp-admin-separated" class="olink">Separation of processes for higher
                security</a> for an example of using this option.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">stripe_blocksize &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-sbs &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-stripe-blocksize &lt;number&gt;</code>
          </span></dt><dd><p>Size in bytes of sequential data that each stripe will transfer.</p><p>Default value: 1048576</p></dd><dt><span class="term">
            <code class="option">stripe_count &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-stripe-count &lt;number&gt;</code>
          </span></dt><dd><p> Number of stripes to use per transfer when this server controls that number. If
              remote nodes are statically configured (via -r or remote_nodes), this will be set to
              that number of nodes, otherwise the default is 1. </p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">stripe_layout &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-sl &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-stripe-layout &lt;number&gt;</code>
          </span></dt><dd><p>Stripe layout. 1 = Partitioned, 2 = Blocked.</p><p>Default value: 2</p></dd><dt><span class="term">
            <code class="option">stripe_blocksize_locked &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-stripe-blocksize-locked;</code>
          </span></dt><dd><p>Do not allow client to override stripe blocksize with the <span class="command"><strong>OPTS
                RETR</strong></span> command.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">stripe_layout_locked &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-stripe-layout-locked</code>
          </span></dt><dd><p>Do not allow client to override stripe layout with the <span class="command"><strong>OPTS
                RETR</strong></span> command.</p><p>Default value: FALSE</p></dd></dl></div></div><div class="refsect2"><a name="gridftp-server-config_options-disk"></a><h3>Disk Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">blocksize &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-bs &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-blocksize &lt;number&gt;</code>
          </span></dt><dd><p>Size in bytes of data blocks to read from disk before posting to the
              network.</p><p>Default value: 262144</p></dd><dt><span class="term">
            <code class="option">sync_writes &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-sync-writes</code>
          </span></dt><dd><p>Flush disk writes before sending a restart marker. This attempts to ensure that
              the range specified in the restart marker has actually been committed to disk. This
              option will probably impact performance and may result in different behavior on
              different storage systems. See the man page for <span class="command"><strong>sync()</strong></span> for more
              information.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">use_home_dirs </code>
          , </span><span class="term">
            <code class="option">-use-home-dirs </code>
          </span></dt><dd><p> Set the startup directory to the authenticated users home dir. </p><p>Default value: TRUE</p></dd><dt><span class="term">
            <code class="option">perms &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-perms &lt;string&gt;</code>
          </span></dt><dd><p> Set the default permissions for created files. Should be an octal number such as
              0644. The default is 0644. Note: If umask is set it will affect this setting -- i.e.
              if the umask is 0002 and this setting is 0666, the resulting files will be created
              with permissions of 0664. </p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">file_timeout &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-file-timeout &lt;number&gt;</code>
          </span></dt><dd><p> Timeout in seconds for all disk accesses. A value of 0 disables the timeout. </p><p>Default value: not set</p></dd></dl></div></div><div class="refsect2"><a name="gridftp-server-config_options-network"></a><h3>Network Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">port &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-p &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-port &lt;number&gt;</code>
          </span></dt><dd><p>Port on which a front end will listen for client control channel connections or on
              which a data node will listen for connections from a front end. If not set, a random
              port will be chosen and printed via the logging mechanism. See <a href="#gridftp-admin-striped" class="olink">Remote data-nodes and
                striped operations</a> and <a href="#gridftp-admin-separated" class="olink">Separation of processes for higher
                security</a> for examples of using this option.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">control_interface &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-control-interface &lt;string&gt;</code>
          </span></dt><dd><p>Hostname or IP address of the interface to listen for control connections on. If
              not set, will listen on all interfaces.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">data_interface &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-data-interface &lt;string&gt;</code>
          </span></dt><dd><p>Hostname or IP address of the interface to use for data connections. If not set
              will use the current control interface.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">ipc_interface &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-ipc-interface &lt;string&gt;</code>
          </span></dt><dd><p>Hostname or IP address of the interface to use for IPC connections. If not set,
              will listen on all interfaces.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">hostname &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-hostname &lt;string&gt;</code>
          </span></dt><dd><p>Effectively sets the above <code class="option">control_interface</code>,
                <code class="option">data_interface</code> and <code class="option">ipc_interface</code> options.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">ipc_port &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-ipc-port &lt;number&gt;</code>
          </span></dt><dd><p>Port on which the front end will listen for data node connections.</p><p>Default value: not set</p></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">control_preauth_timeout &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-control-preauth-timeout &lt;number&gt;</code>
          </span></dt><dd><p>Time in seconds to allow a client to remain connected to the control channel
              without activity before authenticating.</p><p>Default value: 120</p></dd><dt><span class="term">
            <code class="option">control_idle_timeout &lt;number&gt;;</code>
          , </span><span class="term">
            <code class="option">-control-idle-timeout &lt;number&gt;</code>
          </span></dt><dd><p>Time in seconds to allow a client to remain connected to the control channel
              without activity.</p><p>Default value: 600</p></dd><dt><span class="term">
            <code class="option">ipc_idle_timeout &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-ipc-idle-timeout &lt;number&gt;</code>
          </span></dt><dd><p>Idle time in seconds before an unused IPC connection will close.</p><p>Default value: 900</p></dd><dt><span class="term">
            <code class="option">ipc_connect_timeout &lt;number&gt;</code>
          , </span><span class="term">
            <code class="option">-ipc-connect-timeout &lt;number&gt;</code>
          </span></dt><dd><p>Time in seconds before cancelling an attempted IPC connection.</p><p>Default value: 60</p></dd><dt><span class="term">
	    <code class="option">port_range &lt;string&gt;</code>
	  , </span><span class="term">
	    <code class="option">-port-range &lt;string&gt;</code>
	  </span></dt><dd><p>Port range to use for incoming connections. The format is
	    "startport,endport". This, along with -data-interface, can be used
	    to enable operation behind a firewall and/or when NAT is involved.
	    This is the same as setting the environment variable
	    GLOBUS_TCP_PORT_RANGE.</p><p>Default value: not set</p></dd></dl></div></div><div class="refsect2"><a name="gridftp-server-config_options-user-msg"></a><h3>User Messages</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">banner &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-banner &lt;string&gt;</code>
          </span></dt><dd><p>Message that is displayed to the client before authentication.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">banner_file &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-banner-file &lt;string&gt;</code>
          </span></dt><dd><p>Read banner message from this file.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">banner_terse &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-banner-terse</code>
          </span></dt><dd><p>When this is set, the minimum allowed banner message will be displayed to
              unauthenticated clients.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">banner_append &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-banner-append</code>
          </span></dt><dd><p> When this is set, the message set in the 'banner' or 'banner_file' option will be
              appended to the default banner message rather than replacing it. </p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">login_msg &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-login-msg &lt;string&gt;</code>
          </span></dt><dd><p>Message that is displayed to the client after authentication.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">login_msg_file &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-login-msg-file &lt;string&gt;</code>
          </span></dt><dd><p>Read login message from this file.</p><p>Default value: not set</p></dd></dl></div></div><div class="refsect2"><a name="gridftp-server-config_options-module"></a><h3>Module Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">load_dsi_module &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-dsi &lt;string&gt;</code>
          </span></dt><dd><p>Load this Data Storage Interface module. File and remote modules are defined by
              the server. If not set, the file module is loaded, unless the <code class="option">remote</code>
              option is specified, in which case the remote module is loaded. An additional
              configuration string can be passed to the DSI using the format <code class="computeroutput">[module
                name]:[configuration string]</code>. The format of the configuration
              string is defined by the DSI being loaded.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">allowed_modules &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-allowed-modules &lt;string&gt;</code>
          </span></dt><dd><p>Comma-separated list of ERET/ESTO modules to allow and, optionally, specify an
              alias for. Example: </p><pre class="screen">-allowed-modules module1,alias2:module2,module3</pre><p>
              (module2 will be loaded when a client asks for alias2).</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">dc_whitelist &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-dc-whitelist &lt;string&gt;</code>
          </span></dt><dd><p> A comma separated list of drivers allowed on the network stack. </p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">fs_whitelist &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-fs-whitelist &lt;string&gt;</code>
          </span></dt><dd><p> A comma separated list of drivers allowed on the disk stack. </p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">popen_whitelist &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-popen-whitelist &lt;string&gt;</code>
          </span></dt><dd><p> A comma seperated list of programs that the popen driver is allowed to execute,
              when used on the network or disk stack. An alias may also be specified, so that a
              client does not need to specify the full path. Format is [alias:]prog,[alias:]prog.
              example: /bin/gzip,tar:/bin/tar </p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">dc_default &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-dc-default &lt;string&gt;</code>
          </span></dt><dd><p>A comma separated list of XIO drivers and options representing the default network stack. Format is of each driver entry is driver1[:opt1=val1;opt2=val2;...]. The bottom of the stack, the transport driver, is always first.</p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">fs_default &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-fs-default &lt;string&gt;</code>
          </span></dt><dd><p>A comma separated list of XIO drivers and options representing the default disk stack. Format is of each driver entry is driver1[:opt1=val1;opt2=val2;...]. The bottom of the stack, the transport driver, is always first.</p><p>Default value: not set</p></dd></dl></div></div><div class="refsect2"><a name="gridftp-server-config_options-other"></a><h3>Other Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
            <code class="option">configfile &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-c &lt;string&gt;</code>
          </span></dt><dd><p>Path to configuration file that should be loaded. Otherwise will attempt to load
                <code class="filename">$GLOBUS_LOCATION/etc/gridftp.conf</code> and <code class="filename">/etc/grid-security/gridftp.conf</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p> You have to provide full path </p></td></tr></table></div><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">config_dir &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-C &lt;string&gt;</code>
          </span></dt><dd><p>Path to directory holding configuration files that should be
	    loaded. Files will be loaded in alphabetical order, and in the event
	    of duplicate parameters the last loaded file will take precedence.
	    Note that the main configuration file, if one exists, will always be
	    loaded last.
	    </p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">config_base_path &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-config-base-path &lt;string&gt;</code>
          </span></dt><dd><p>Base path to use when config and log path options are not full
	    paths. By default this is the current directory when the process is
	    started.
	    </p><p>Default value: not set</p></dd><dt><span class="term">
            <code class="option">debug &lt;0|1&gt;</code>
          , </span><span class="term">
            <code class="option">-debug</code>
          </span></dt><dd><p>Set options that make the server easier to debug. Forces no-fork, no-chdir, and
              allows core dumps on bad signals instead of exiting cleanly. Not recommended for
              production servers. Note that non-forked servers running as root will only accept a
              single connection and then exit.</p><p>Default value: FALSE</p></dd><dt><span class="term">
            <code class="option">pidfile &lt;string&gt;</code>
          , </span><span class="term">
            <code class="option">-pidfile &lt;string&gt;</code>
          </span></dt><dd><p>Write PID of the GridFTP server to this path. May contain
	    variable references to ${localstatedir}
	    </p><p>Default value: not set</p></dd></dl></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/warning.png"></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Any FLAG can be negated by prepending <code class="option">-no</code> or <code class="option">-n</code> to the command line option.</p></td></tr></table></div></div></div><div class="refsect1"><a name="idm14797041360"></a><h2>Limitations</h2><p>For transfers using parallel data transport streams and for transfers using multiple
      computers at each end, the direction of the connection on the data channels must go from the
      sending to the receiving side. For more information about this limitations see <a class="ulink" href="http://www.ogf.org/documents/GFD.20.pdf" target="_top">http://www.ogf.org/documents/GFD.20.pdf</a>.</p><p>Globus GridFTP server does not run on windows</p></div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-SRB"></a>Appendix B. GT 6.0 GridFTP: Setting up Storage Resource
        Broker (SRB)</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#gridftp-SRB-intro">1. Introduction</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-architecture">2. Architecture</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-software">3. Software</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-building">4. Building</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-SRB-building-globus">4.1. Building Globus</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-building-SRB">4.2. Building SRB</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-building-SRBDSI">4.3. Building SRB-DSI</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-SRB-administration">5. Administration</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-SRB-config-file">5.1. Creating and setting up the SRB configuration file</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-gridmap-file">5.2. Setting up the gridmap file</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-SRB-running">6. Running</a></span></dt><dt><span class="section"><a href="#gridftp-SRB-seealso">7. See Also</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-SRB-intro"></a>1. Introduction</h2></div></div></div><p>The Storage Resource Broker Data Storage Interface (SRB-DSI) is an extension to the
            GridFTP server that allows it to interact with SRB. Plugging this extension into a
            GridFTP server allows the GridFTP server to access a SRB resource and serve it to any
            GridFTP client as though it were a filesystem.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-SRB-architecture"></a>2. Architecture</h2></div></div></div><div class="mediaobject" align="center"><img src="srb-dsi.gif" align="middle" alt="SRB DSI Architecture"></div><p>The above image shows the architecture of the system. There are 4 major components:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="emphasis"><em>SRB Server </em></span>- This is where the data is stored. It is
                    accessed by the GridFTP server via the standard SRB protocols using GSI_AUTH.
                </li><li class="listitem"><span class="emphasis"><em>SRB-DSI</em></span> - This component is the bridge between GridFTP
                    and SRB. All operation requests and data are routed through this component. The
                    GridFTP server makes requests of it, then it translates these requests into SRB
                    client commands. </li><li class="listitem"><span class="emphasis"><em>GridFTP Server</em></span> - A standard GridFTP 6.0 server is loaded with the SRB-DSI.
                    Clients contact this server to access data in a SRB resource. The server passes
                    the request to the SRB-DSI which, as described above, passes the request on to
                    the SRB server. The responses to the requests return along the same path.
                </li><li class="listitem"><span class="emphasis"><em>GridFTP Client </em></span>- A stock GridFTP client (like <span class="command"><strong>globus-url-copy</strong></span>). No modifications to the client are
                needed.</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-SRB-software"></a>3. Software</h2></div></div></div><p>You need the following items to use the SRB-DSI:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="emphasis"><em>Globus Toolkit</em></span> - You need the GridFTP distributed with
                    GT (compatible with 4.0.1 or later). You can find that <a class="ulink" href="http://www.globus.org/toolkit/downloads/6.0/" target="_top">here</a>.
                </li><li class="listitem"><span class="emphasis"><em>SRB Client 3.4.0</em></span> - You only need the client libraries
                    to build the SRB-DSI, but you will need access to a running SRB server and
                    resource. You can find the client libraries <a class="ulink" href="http://www.sdsc.edu/srb/tarfiles/main.html" target="_top">here</a>. </li><li class="listitem"><span class="emphasis"><em>SRB-DSI </em></span>- You can find the SRB-DSI <a class="ulink" href="http://www-unix.mcs.anl.gov/~bresnaha/SRB_DSI_Doc/globus_srb_dsi-latest.tar.gz" target="_top">here</a>.</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-SRB-building"></a>4. Building</h2></div></div></div><p>Instructions for building <a href="../../admin/install/#gtadmin" class="olink">Globus</a> and <a class="ulink" href="http://www.sdsc.edu/srb" target="_top">SRB</a> are well documented in the above links.
            The following sections describe one way of building these two packages. However, if any
            questions or errors are discovered, the reader should look to the above links for
            solutions.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-SRB-building-globus"></a>4.1. Building Globus</h3></div></div></div><p>Download the source installer, choose a path on your filesystem for your
                    <code class="computeroutput">GLOBUS_LOCATION</code>, and run the following:</p><pre class="screen">
% bunzip2 gt6.0-all-source-installer.tar.bz2
% tar -xvf gt6.0-all-source-installer.tar
% export GLOBUS_LOCATION=&lt;path you chose for your GLOBUS_LOCATION&gt;
% ./configure --prefix=$GLOBUS_LOCATION
% make gridftp globus_gridftp_server-thr
% source $GLOBUS_LOCATION/etc/globus-user-env.sh</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-SRB-building-SRB"></a>4.2. Building SRB</h3></div></div></div><pre class="screen">
% ./configure  --enable-gsi-auth --enable-globus-location=$GLOBUS_LOCATION --enable-globus-flavor=&lt;a threaded globus flavor&gt;
% make</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-SRB-building-SRBDSI"></a>4.3. Building SRB-DSI</h3></div></div></div><p>The SRB-DSI is a GPT package. More information about GPT package installation can
                be found <a class="ulink" href="http://www.gridpackagingtools.org/" target="_top">here</a>. Most users
                should simply need:</p><pre class="screen">
gpt-build -force CONFIGOPTS_GPTMACRO="--with-srb-path=&lt;location of SRB source tree&gt;"  globus_srb_dsi-0.13.tar.gz &lt;threaded flavor&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-SRB-administration"></a>5. Administration</h2></div></div></div><p>Before you can run the GridFTP server with the SRB-DSI, you need to set up some files. </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-SRB-config-file"></a>5.1. Creating and setting up the SRB configuration file</h3></div></div></div><p> A configuration file must be created at:</p><pre class="screen">$GLOBUS_LOCATION/etc/gridftp_srb.conf</pre><p>The following values must be set in this file:</p><pre class="screen">
srb_hostname &lt;host&gt;:&lt;port&gt;
srb_hostname_dn &lt;domain name to expect from SRB server&gt;
srb_default_resource &lt;default srb resource to use&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-SRB-gridmap-file"></a>5.2. Setting up the gridmap file</h3></div></div></div><p>Additionally, the gridmap file must be special for this DSI. Along with the
                subject name and username, the SRB-DSI needs to know the SRB domain name for the
                user. This is handled by adding an additional value to the gridmap file:</p><pre class="screen"> 
"&lt;user security DN&gt;" &lt;srb user name&gt;@&lt;domain name&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-SRB-running"></a>6. Running</h2></div></div></div><p>Once you have the configuration files in place, you can run the server. </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>All options of the server apply, but the parameter <code class="computeroutput">-dsi srb
                    -auth-level 4</code>
                <span class="emphasis"><em>must</em></span> also be used.</p></td></tr></table></div><p>For more information on setting these values and running the GridFTP server see <a href="#gridftp-configuring" class="olink">Chapter 2, <i>Configuring GridFTP</i></a>. </p><p>Most users can run with:</p><pre class="screen"> 
$GLOBUS_LOCATION/sbin/globus-gridftp-server -p &lt;port&gt; -dsi srb -auth-level 4</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-SRB-seealso"></a>7. See Also</h2></div></div></div><p>See the <a class="ulink" href="http://www-unix.mcs.anl.gov/~bresnaha/SRB_DSI_Doc/README.txt" target="_top">README</a> file for more information.</p></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="gridftp-admin-gfork-master"></a>Appendix C. Running the Globus GridFTP Server With GFork</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#gridftp-gfork-master-intro">1. Introduction</a></span></dt><dt><span class="section"><a href="#gridftp-gfork-master-use-case">2. Use Cases</a></span></dt><dt><span class="section"><a href="#gridftp-gfork-config">3. Configuration</a></span></dt><dt><span class="section"><a href="#gridftp-gfork-striped">4. GFork and Striped Servers</a></span></dt><dd><dl><dt><span class="section"><a href="#gridftp-gfork-striped-frontend">4.1. Frontend Configuration</a></span></dt><dt><span class="section"><a href="#gridftp-gfork-striped-backend">4.2. Backend Configuration</a></span></dt></dl></dd><dt><span class="section"><a href="#gridftp-gfork-memory-mgt">5. GFork with Memory Management</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-gfork-master-intro"></a>1. Introduction</h2></div></div></div><p>GFork is a user-configurable super-server daemon very similar to xinetd in that it
        listens on a TCP port. When clients connect to a port, it runs an administrator-defined
        program which services that client connection, just as xinetd does.</p><p>An unfortunate drawback to xinetd is that there is no way to maintain or share long-term
        information. Every time a client connects, a new process is created; and every time that
        client disconnects, the process is destroyed. All of the information regarding the specific
        interactions with a given client is lost with these transient processes. A further
        disadvantage is that there is no way for these service instances to share service-specific
        information with each other while they are running.</p><p>There are times when it is useful for a service to maintain long-term service-specific
        state, or for a service to share state across client connections. GFork is designed to
        address this situation. GFork runs a long term master program (that is user-defined) and
        forms communication links via UNIX pipes between this process and all client connection
        child processes. This allows long-term state to be maintained in memory and allows for
        communication between all nodes.</p><p>Associated with a GFork instance is a master process. When GFork starts, it runs a
        user-defined master program and opens up bi-directional pipes to it. The master program runs
        for the lifetime of the GFork daemon. The master is free to do whatever it wants; it is a
        user-defined program. Some master programs listen on alternative TCP connections to have
        state remotely injected. Others monitor system resources, such as memory, in order to best
        share resources. As clients connect to the TCP listener, child processes are forked which
        then service the client connection. Bi-directional pipes are opened up to the child
        processes as well. These pipes allow for communication between the master program and all
        child processes. The master program and the child programs have their own protocol for
        information exchange over these links. GFork is just a framework for safely and quickly
        creating these links.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-gfork-master-use-case"></a>2. Use Cases</h2></div></div></div><p>The creation of GFork was motivated by the Globus GridFTP server. GridFTP can be run as
        a striped server where there is a frontend and several backends. The backends run in tandem
        to transfer files faster by tying together many NICs. The frontend is the contact point for
        the client where transfer requests are made. When the frontend is run out of inetd, the list
        of possible backends must be statically configured. Unfortunately, backends tend to come and
        go. Sometimes backends fail, and sometimes backends are added to a pool. We needed a way to
        have a [fixme good synopsis: dynamic pool of backends for use in live transfers]. To accomplish
        this we created GFork.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-gfork-config"></a>3. Configuration</h2></div></div></div><p>A major difference between GFork configuration and xinetd is that GFork only runs one
        service per instance, where xinetd runs many services per instance all associated with many
        different ports. GFork takes a single configuration file and handles a single service. If
        there is demand, GFork will be enhanced to handle many services in the way that xinetd does.</p><p>Running the globus-gridftp-server under GFork is almost identical to running it under
        xinetd. First, you need a configuration file:</p><pre class="screen">service gridftp2
{
env += GLOBUS_LOCATION=&lt;path to GL&gt;
env += LD_LIBRARY_PATH=&lt;path to GL&gt;/lib
server = &lt;path to GL&gt;/sbin/globus-gridftp-server
server_args = -i 
server_args += -d ALL -l &lt;path to GL&gt;/var/gridftp.log
port = 5000
}</pre><p>That portion is identical to xinetd. In fact, an existing xinetd configuration file
        should work.</p><p>When running GridFTP out of GFork, the server should be run with a master program. The
        master program provides enhanced functionality such as dynamic backend registration for
        striped servers, managed system memory pools and internal data monitoring for both striped
        and non-striped servers.</p><p>To run with a master program, the following two lines are needed in the config file.</p><pre class="screen">
master = &lt;path to GL&gt;/libexec/gfs-gfork-master
master_args = &lt;options&gt;</pre><p>These last two options relate to the master program and work in the same way that
          <code class="computeroutput">server</code> and <code class="computeroutput">server_args</code>
        do. The first line tells GFork what master program to use (for the GridFTP server, we use
          <span class="command"><strong>gfs-gfork-master</strong></span>). The second line provides options to the master
        program.</p><p>The full list of master options are as follows (this is to date only, run the program
        with <code class="option">--help</code> for newer options):</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">-b | --reg-cs &lt;contact string&gt;</span></dt><dd><p>Contact to the frontend registry. This option makes it a data node.</p></dd><dt><span class="term">-df | --dn-file &lt;path&gt;</span></dt><dd><p>Path to a file containing the list of acceptable DNs. Default is system gridmap
              file.</p></dd><dt><span class="term">-G | --gsi &lt;bool&gt;</span></dt><dd><p>Enable or disable GSI. Default is on.</p></dd><dt><span class="term">-h | --help</span></dt><dd><p>Print the help message.</p></dd><dt><span class="term">-l | --logfile &lt;path&gt;</span></dt><dd><p>Path to the logfile.</p></dd><dt><span class="term">-p | --port &lt;int&gt;</span></dt><dd><p>Port where the server listens for connections.</p></dd><dt><span class="term">-s | --stripe-count &lt;int&gt;</span></dt><dd><p>The maximum number of stripes to give to each server. A value of 0 indicates all
              stripes are available.</p></dd><dt><span class="term">-u | --update-interval &lt;int&gt;</span></dt><dd><p>Number of seconds between registration updates.</p></dd></dl></div><p>The following is an example GFork configuration file:</p><pre class="screen">service gridftp2
    {
    instances = 100
    env += GLOBUS_LOCATION=/home/bresnaha/Dev/Globus-gfork3/GL
    env += LD_LIBRARY_PATH=/home/bresnaha/Dev/Globus-gfork3/GL/lib
    server = /home/bresnaha/Dev/Globus-gfork3/GL/sbin/globus-gridftp-server
    server_args = -i -aa
    server_args += -d ALL -l /home/bresnaha/tst.log
    server_args += -dsi remote -repo-count 1
    nice = 10
    port = 5000
    master = /home/bresnaha/Dev/Globus-gfork3/GL/libexec/gfs-gfork-master
    master_args = -port 6065 -l /home/bresnaha/master.log -G n
    master_args += -dn /home/bresnaha/master_gridmap
    }</pre><p>Once you have a configuration file, run GFork with:</p><pre class="screen">% gfork -c &lt;path to config file&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-gfork-striped"></a>4. GFork and Striped Servers</h2></div></div></div><p>As mentioned in <a href="#gridftp-admin-striped" class="olink">Section 3, &#8220;Configuring GridFTP for Cluster-to-Cluster (or
        Striped) data movement&#8221;</a>, GridFTP offers a powerful
        enhancement called striped servers. In this mode a GridFTP server is set up with a single
        frontend and one or more backends. All of the backends work in concert to transfer a single
        file and thereby achieve high throughput rates. Here we describe how to configure one
        frontend and multiple backends for use as a striped server with GFork.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-gfork-striped-frontend"></a>4.1. Frontend Configuration</h3></div></div></div><p>The frontend server described here is run using dynamic backends. We need additional
          options for both the GridFTP server and the master program. The following lines are added
          to the config file:</p><pre class="screen">server_args += -dsi remote 
master_args = -port 8588
master_args += -df &lt;path to gridmap file&gt;</pre><p>The first line is an additional argument to the GridFTP server. It tells the server
          that it will be operating in split mode (separate frontend and backend processes) and that
          it will be using the frontend. (Specifically it tells the server to use the 'remote' DSI).</p><p>The second line tells the master program on which port it should listen for backend
          registrations. Backend services can then connect to this port to notify the frontend of
          their existence. By default, a registration is good for 10 minutes, but a backend is free
          to refresh its registration. In this way, a frontend is provided with the list of possible
          backends (stripes) which may be used for a transfer.</p><p>The third line provides the master program with a list of authorized DNs. Each line in
          the file must contain a GSI DN (certificate subject). In order to register, the backend
          must authenticate and provide its DN. The provided DN is checked against this file. In
          other words, the file is a list of DNs that may register with the frontend. If the master
          program is not given a <code class="option">-df</code> option and is given the <code class="option">-G</code>
          option, then there is no registration security at all.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gridftp-gfork-striped-backend"></a>4.2. Backend Configuration</h3></div></div></div><p>Any striped server setup can have more than one backend service. Furthermore, any one
          computer can run multiple backends. The following explains how to set up a backend server.
          These steps should be repeated for each needed backend instance.</p><p>A backend server may also be run with GFork, it just needs different options for both
          the GridFTP server and the master program. A sample backend config file is shown here:</p><pre class="screen">service gridftp2
{
env += GLOBUS_LOCATION=&lt;path to GL&gt;
env += LD_LIBRARY_PATH=&lt;path to GL&gt;/lib

server = &lt;path to GL&gt;/sbin/globus-gridftp-server
server_args = -i  
server_args += -dn
master = &lt;path to GL&gt;/libexec/gfs-gfork-master
master_args = -b localhost:8588
}</pre><p>Notable additions to this file are:</p><pre class="screen">server_args += -dn
master_args = -b localhost:8588</pre><p>The first line tells the GridFTP server that it will be a 'data node', which is
          another name for a backend.</p><p>The second line tells the master program two things, first that it will be a master of
          a data node, and second what the frontend's registration contact point is. Note that in
          our example we have a hostname of 'localhost' and a port of '8588'. 8588 is (and must be)
          the same port that was provided to the frontend's master program in the previous step.</p><p>Once the configuration file is complete, run GFork again as follows:</p><pre class="screen">% gfork -c &lt;conf file&gt;</pre><p>This will start up the data node and the master program will register itself to the
          frontend and refresh its registration every 5 minutes (default setting).</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gridftp-gfork-memory-mgt"></a>5. GFork with Memory Management</h2></div></div></div><p>Another feature of the GridFTP GFork plugin is memory usage limiting. Under extreme
        client loads, it is possible that GridFTP servers require more memory than the system has
        available. Due to a common kernel memory allocation scheme known as optimistic provisioning,
        this situation can lead to a full consumption of memory resources and thus trigger the out
        of memory handler. The OOM handler will kill processes in a difficult-to-predict way in
        order to free up memory. This will leave the system in an unpredicatable and unstable state;
        obviously, this is a situation that we want to avoid.</p><p>To control this situation, the GridFTP GFork plugin has a memory limiting option. This
        will attempt to limit memory usage to a given value or to the maximum amount of RAM in the
        system. Most of the memory is given to the first few connections, but when the plugin
        detects that it is overloaded, each session is limited to half the available memory.</p><p>To enable this feature, one of two options must be passed to the master program via the
          <code class="option">master_args</code> in the config file:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">-m</span></dt><dd>Limits memory consumption to amount of RAM in the system.</dd><dt><span class="term">-M &lt;formated int&gt;</span></dt><dd>Limits memory to the given value.</dd></dl></div><p>Another important option should be provided in the GFork config file:
        <code class="option">instance</code>. When a client connects to GFork, a GridFTP server instance is
        executed. This instance requires a certain amount of RAM. If connections are coming in too
        fast, this can act as a DOS attack. Limiting the number of allowed simultaneous connections
        will help the memory management algorithm do its job. This limit is set with:</p><pre class="screen">instance = &lt;int&gt;</pre><p>We recommend a value of 100 or |RAM|/2M, whichever is smaller.</p><p>The following is an example of a GFork configuration file with memory limiting enabled:</p><pre class="screen">service gridftp2
{
instance = 100  
env += GLOBUS_LOCATION=&lt;path to GL&gt;
env += LD_LIBRARY_PATH=&lt;path to GL&gt;/lib
server = &lt;path to GL&gt;/sbin/globus-gridftp-server
server_args = -i
server_args += -dn
master = &lt;path to GL&gt;/libexec/gfs-gfork-master
master_args = -M 512M
}</pre></div></div><div class="glossary"><div class="titlepage"><div><div><h1 class="title"><a name="glossary-gridftpAdmin"></a>Glossary</h1></div></div></div><div class="glossdiv"><h3 class="title">C</h3><dl><dt><a name="client"></a><span class="glossterm">client</span></dt><dd class="glossdef"><p>A process that sends commands and receives responses. Note that in GridFTP, the client may or may not take part in the actual movement of data.
                        </p></dd><dt><a name="client-server-transfer"></a><span class="glossterm">client/server transfer</span></dt><dd class="glossdef"><p>In a client/server transfer, there are only two entities involved in
                              the transfer, the client entity and the server entity. We use the term
                              entity here rather than process because in the implementation provided
                              in GT5, the server entity may actually run as two or more separate
                              processes. </p><p>The client will either move data from or to his local host. The client
                              will decide whether or not he wishes to connect to the server to
                              establish the data channel or the server should connect to him (MODE E
                              dictates who must connect).</p><p>If the client wishes to connect to the server, he will send the PASV
                              (passive) command. The server will start listening on an ephemeral
                              (random, non-privileged) port and will return the IP and port as a
                              response to the command. The client will then connect to that IP/Port. </p><p>If the client wishes to have the server connect to him, the client
                              would start listening on an ephemeral port, and would then send the
                              PORT command which includes the IP/Port as part of the command to the
                              server and the server would initiate the TCP connect. Note that this
                              decision has an impact on traversing firewalls. For instance, the
                              client's host may be behind a firewall and the server may not be able
                              to connect. </p><p>Finally, now that the data channel is established, the client will
                              send either the RETR &#8220;filename&#8221; command to transfer a file from the
                              server to the client (GET), or the STOR &#8220;filename&#8221; command to transfer
                              a file from the client to the server (PUT). </p></dd></dl></div><div class="glossdiv"><h3 class="title">S</h3><dl><dt><a name="scheduler"></a><span class="glossterm">scheduler</span></dt><dd class="glossdef"><p>Term used to describe a job scheduler mechanism to which GRAM
                              interfaces. It is a networked system for submitting, controlling, and
                              monitoring the workload of batch jobs in one or more computers. The
                              jobs or tasks are scheduled for execution at a time chosen by the
                              subsystem according to an available policy and availability of
                              resources. Popular job schedulers include Portable Batch System (PBS),
                              Platform LSF, and IBM LoadLeveler.</p></dd><dt><a name="server"></a><span class="glossterm">server</span></dt><dd class="glossdef"><p>A process that receives commands and sends responses to
                              those commands. Since it is a server or service, and it receives
                              commands, it must be listening on a port somewhere to receive the
                              commands. Both FTP and GridFTP have IANA registered ports. For FTP it
                              is port 21, for GridFTP it is port 2811. This is normally handled via
                              inetd or xinetd on Unix variants. However, it is also possible to
                              implement a daemon that listens on the specified port. This is
                              described more fully in in the Architecture section of the GridFTP
                              Developer's Guide.</p></dd></dl></div><div class="glossdiv"><h3 class="title">T</h3><dl><dt><a name="third-party-transfers"></a><span class="glossterm">third party transfers</span></dt><dd class="glossdef"><p>In the simplest terms, a third party transfer moves a file between two
                              GridFTP servers.</p><p> The following is a more detailed, programmatic description. </p><p>In a third party transfer, there are three entities involved. The
                              client, who will only orchestrate, but not actually take place in the
                              data transfer, and two servers one of which will be sending data to
                              the other. This scenario is common in Grid applications where you may
                              wish to stage data from a data store somewhere to a supercomputer you
                              have reserved. The commands are quite similar to the client/server
                              transfer. However, now the client must establish two control channels,
                              one to each server. He will then choose one to listen, and send it the
                              PASV command. When it responds with the IP/port it is listening on,
                              the client will send that IP/port as part of the PORT command to the
                              other server. This will cause the second server to connect to the
                              first server, rather than the client. To initiate the actual movement
                              of the data, the client then sends the RETR filename command to the
                              server that will read from disk and write to the network (the
                              sending server) and will send the STOR filename command to the
                              other server which will read from the network and write to the disk
                              (the receiving server). </p><p>See Also <a class="glossseealso" href="#client-server-transfer">client/server transfer</a>.</p></dd></dl></div></div><div class="index"><div class="titlepage"><div><div><h1 class="title"><a name="idm14800975664"></a>Index</h1></div></div></div><div class="index"><div class="indexdiv"><h3>A</h3><dl><dt>accessing data</dt><dd><dl><dt>non-POSIX data source, <a class="indexterm" href="#idm14797901376">GridFTP and DSIs</a></dt><dt>non-POSIX file data
            source that has a POSIX interface, <a class="indexterm" href="#gridftp-howto-access-posix">Accessing data in a non-POSIX file data source
          that has a POSIX interface</a></dt></dl></dd><dt>admin scenarios</dt><dd><dl><dt>running in daemon mode, <a class="indexterm" href="#gridftp-admin-daemon_mode">Running in daemon mode</a></dt></dl></dd><dt>administrative settings, recommended, <a class="indexterm" href="#gridftp-admin-tuning">Key Admin Settings and Tuning Recommendations</a></dt></dl></div><div class="indexdiv"><h3>B</h3><dl><dt>building and installing</dt><dd><dl><dt>general instructions, <a class="indexterm" href="#gridftp-admin-installing">Building
    and Installing</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>C</h3><dl><dt>commandline tool</dt><dd><dl><dt>globus-gridftp-server, <a class="indexterm" href="#idm14792596704">Tool description</a></dt></dl></dd><dt>configuration interface for GridFTP, <a class="indexterm" href="#gridftp-configuring">Configuring GridFTP</a></dt><dt>configuring GridFTP</dt><dd><dl><dt>multicasting, <a class="indexterm" href="#gridftp-config-multi">Configuring multicasting/broadcasting</a></dt><dt>run with GFork, <a class="indexterm" href="#gridftp-admin-server-gfork">Running with GFork Master Plugin</a></dt><dt>run with UDT for third party transfers, <a class="indexterm" href="#gridftp-config-udt">Configuring GridFTP to use UDT instead of TCP </a></dt><dt>typical, <a class="indexterm" href="#gridftp-config-types">Typical configuration</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>D</h3><dl><dt>deploying</dt><dd><dl><dt>running under inetd or xinetd, <a class="indexterm" href="#gridftp-admin-inetd">Running under
          inetd or xinetd</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>E</h3><dl><dt>errors, <a class="indexterm" href="#gridftp-error-codes">Error Codes in GridFTP</a></dt></dl></div><div class="indexdiv"><h3>G</h3><dl><dt>globus-gridftp-server, <a class="indexterm" href="#idm14792596704">Tool description</a></dt></dl></div><div class="indexdiv"><h3>L</h3><dl><dt>logging, <a class="indexterm" href="#gridftp-admin-debugging">Debugging</a>, <a class="indexterm" href="#gridftp-logging">Logging</a></dt></dl></div><div class="indexdiv"><h3>M</h3><dl><dt>moving files</dt><dd><dl><dt>existing
        FTP, <a class="indexterm" href="#gridftp-admin-gwtftp">GridFTP Where There Is FTP (GWTFTP)</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>P</h3><dl><dt>performance, <a class="indexterm" href="#gridftp-admin-tuning">Key Admin Settings and Tuning Recommendations</a></dt></dl></div><div class="indexdiv"><h3>T</h3><dl><dt>testing, <a class="indexterm" href="#gridftp-admin-testing">Testing</a></dt><dt>troubleshooting for GridFTP, <a class="indexterm" href="#gridftp-troubleshooting">Troubleshooting</a></dt><dt>tuning, <a class="indexterm" href="#gridftp-admin-tuning">Key Admin Settings and Tuning Recommendations</a></dt></dl></div><div class="indexdiv"><h3>U</h3><dl><dt>usage statistics for GridFTP, <a class="indexterm" href="#gridftp-usage">Usage statistics collection by the Globus Alliance </a></dt></dl></div></div></div></div>
