<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<div class="book"><div class="titlepage"><div><div><h1 class="title"><a name="gsiopensshPI"></a> GT 6.0 Component Guide to Public Interfaces: GSI-OpenSSH</h1></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="reference"><a href="#gsiopenssh-cmd">I. GSI-OpenSSH Commands</a></span></dt><dd><dl><dt><span class="refentrytitle"><a href="#gsissh">gsissh</a></span><span class="refpurpose"> &#8212; Secure remote login</span></dt><dt><span class="refentrytitle"><a href="#gsiscp">gsiscp</a></span><span class="refpurpose"> &#8212; Secure remote file copy</span></dt><dt><span class="refentrytitle"><a href="#gsisftp">gsisftp</a></span><span class="refpurpose"> &#8212; Secure file transfer</span></dt></dl></dd><dt><span class="chapter"><a href="#gsiopenssh-configuring">1. Configuring</a></span></dt><dt><span class="chapter"><a href="#gsiopenssh-pi-env">2. Environment variable interface</a></span></dt><dd><dl><dt><span class="section"><a href="#gsiopenssh-env-var">1. Environmental variables for GSI-OpenSSH</a></span></dt></dl></dd><dt><span class="appendix"><a href="#gsiopenssh-error-codes">A. Errors</a></span></dt><dt><span class="glossary"><a href="#glossary-opensshPI">Glossary</a></span></dt></dl></div><div class="reference"><div class="titlepage"><div><div><h1 class="title"><a name="gsiopenssh-cmd"></a>GSI-OpenSSH Commands</h1></div></div><hr></div><div class="partintro"><div></div><div class="abstract"><p class="title"><b>Abstract</b></p><p> The <a href="#gsissh" class="olink"><span class="refentrytitle">gsissh</span>(1)</a>, <a href="#gsiscp" class="olink"><span class="refentrytitle">gsiscp</span>(1)</a>, and <a href="#gsisftp" class="olink"><span class="refentrytitle">gsisftp</span>(1)</a> commands provide the same
      interfaces as the standard
      OpenSSH <span class="emphasis"><em>ssh</em></span>, <span class="emphasis"><em>scp</em></span>,
      and <span class="emphasis"><em>sftp</em></span> commands, respectively, with the added
      ability to perform X.509 <a href="#proxy-cred" class="glossterm"><em class="glossterm">proxy credential</em></a> authentication and
      delegation.</p></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="refentrytitle"><a href="#gsissh">gsissh</a></span><span class="refpurpose"> &#8212; Secure remote login</span></dt><dt><span class="refentrytitle"><a href="#gsiscp">gsiscp</a></span><span class="refpurpose"> &#8212; Secure remote file copy</span></dt><dt><span class="refentrytitle"><a href="#gsisftp">gsisftp</a></span><span class="refpurpose"> &#8212; Secure file transfer</span></dt></dl></div></div><div class="refentry"><a name="gsissh"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>gsissh &#8212; Secure remote login</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="command">gsissh</code> </p></div></div><div class="refsect1"><a name="idm345746123904"></a><h2>Tool description</h2><p>Use the <span class="emphasis"><em>gsissh</em></span> command to securely login to a
  remote machine.</p></div><div class="refsect1"><a name="idm345745881968"></a><h2>Command syntax</h2><p>
  <span class="emphasis"><em>gsissh</em></span> [-l login_name] hostname | user@hostname [command]
</p></div></div><div class="refentry"><a name="gsiscp"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>gsiscp &#8212; Secure remote file copy</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="command">gsiscp</code> </p></div></div><div class="refsect1"><a name="idm345744331120"></a><h2>Tool description</h2><p>Use the <span class="emphasis"><em>gsiscp</em></span> command to securely copy files to
  or from a remote machine.</p></div><div class="refsect1"><a name="idm345744329840"></a><h2>Command syntax</h2><p>
  <span class="emphasis"><em>gsiscp</em></span> [-P   port]
    [[user@]host1:]file1 [...]  [[user@]host2:]destfile
</p></div></div><div class="refentry"><a name="gsisftp"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>gsisftp &#8212; Secure file transfer</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="command">gsisftp</code> </p></div></div><div class="refsect1"><a name="idm345744324464"></a><h2>Tool description</h2><p>The <span class="emphasis"><em>gsisftp</em></span> command provides an interactive
  interface for transferring files to and from remote machines.</p></div><div class="refsect1"><a name="idm345744323184"></a><h2>Command syntax</h2><p>
  <span class="emphasis"><em>gsisftp</em></span> [[user@]host[:dir[/]]]
</p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gsiopenssh-configuring"></a>Chapter 1. Configuring</h1></div></div></div><p>
  The GSI-enabled OpenSSH software is installed with a default set of
  configuration files, described below.
  You may want to modify the <code class="filename">ssh_config</code> file before using the
  clients and the <code class="filename">sshd_config</code> file before using the server.
</p><p>
    If the GSI-enabled OpenSSH install script finds existing SSH key
    pairs, it will create symbolic links to them rather than
    generating new key pairs.  The SSH key pairs are not required for
    GSI authentication.  However, if you wish to support other SSH
    authentication methods, make sure the sshd (running as root) can
    read the key pair files (i.e., beware of NFS mounts with
    root_squash).  If running multiple sshds on a system, we recommend
    configuring them so they all use the same key pairs (i.e., use
    symbolic links) to avoid client-side confusion.
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">$GLOBUS_LOCATION/etc/ssh/moduli</code></p><div class="blockquote"><blockquote class="blockquote"><p>moduli is a crypto parameter for generating keys.</p></blockquote></div></li><li class="listitem"><p><code class="filename">$GLOBUS_LOCATION/etc/ssh/ssh_config</code></p><div class="blockquote"><blockquote class="blockquote"><p>ssh_config contains options that are read by ssh, scp, and sftp at 
    run-time.  The installed version is the default provided by
    OpenSSH, with GSI authentication and X11Forwarding enabled.
    You may need to customize
    this file for compatibility with your system SSH installation
    (i.e., compare it with /etc/ssh/ssh_config).</p></blockquote></div></li><li class="listitem"><p><code class="filename">$GLOBUS_LOCATION/etc/ssh/ssh_host_key[.pub]</code></p><div class="blockquote"><blockquote class="blockquote"><p>Your system's RSA public-/private-key pair for SSH protocol 1
    communications.</p></blockquote></div></li><li class="listitem"><p><code class="filename">$GLOBUS_LOCATION/etc/ssh/ssh_host_dsa[.pub]</code></p><div class="blockquote"><blockquote class="blockquote"><p> Your system's DSA public-/private-key pair for SSH protocol 2 
    communications.</p></blockquote></div></li><li class="listitem"><p><code class="filename">$GLOBUS_LOCATION/etc/ssh/ssh_host_rsa[.pub]</code></p><div class="blockquote"><blockquote class="blockquote"><p>Your system's RSA public-/private-key pair for SSH protocol 2 
    communications.</p></blockquote></div></li><li class="listitem"><p><code class="filename">$GLOBUS_LOCATION/etc/ssh/ssh_prng_cmds</code></p><div class="blockquote"><blockquote class="blockquote"><p>ssh_prng_cmds contains paths to a number of files that ssh-keygen may 
    need to use if your system does not have a built-in entropy pool (like 
    /dev/random).</p></blockquote></div></li><li class="listitem"><p><code class="filename">$GLOBUS_LOCATION/etc/ssh/sshd_config</code>
</p><div class="blockquote"><blockquote class="blockquote"><p>sshd_config contains options that are read by sshd when it starts
    up.  The installed version is the default provided by OpenSSH, with
    X11Forwarding enabled.  You may need to customize this file for
    compatibility with your system SSH installation (i.e., compare it 
    with /etc/ssh/sshd_config).  For example, to enable PAM
    authentication, you may need to set "UsePAM yes" in this file.</p></blockquote></div></li></ul></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gsiopenssh-pi-env"></a>Chapter 2. Environment variable interface</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#gsiopenssh-env-var">1. Environmental variables for GSI-OpenSSH</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="gsiopenssh-env-var"></a>1. Environmental variables for GSI-OpenSSH</h2></div></div></div><p>The GSI-enabled OpenSSHD needs to be able to find certain files and
    directories in order to properly function.</p><p>The items that OpenSSHD needs to be able to locate, their default
    location and the environment variable to override the default
    location are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="emphasis"><em>Host key</em></span>
      </p><div class="blockquote"><blockquote class="blockquote"><p>Default location: /etc/grid-security/hostkey.pem</p><p>Override with X509_USER_KEY environment variable </p></blockquote></div></li><li class="listitem"><p><a href="#host-cert" class="glossterm"><em class="glossterm">Host certificate</em></a>
      </p><div class="blockquote"><blockquote class="blockquote"><p>Default location: /etc/grid-security/hostcert.pem</p><p>Override with X509_USER_CERT environment variable</p></blockquote></div></li><li class="listitem"><p><a href="#grid-map-file" class="glossterm"><em class="glossterm">Grid map file</em></a>
      </p><div class="blockquote"><blockquote class="blockquote"><p>Default location: /etc/grid-security/grid-mapfile</p><p>Override with GRIDMAP environment variable</p></blockquote></div><p> </p></li><li class="listitem"><p><span class="emphasis"><em>Certificate directory</em></span>
      </p><div class="blockquote"><blockquote class="blockquote"><p>Default location: /etc/grid-security/certificates</p><p>Override with X509_CERT_DIR environment variable </p></blockquote></div></li></ul></div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="gsiopenssh-error-codes"></a>Appendix A. Errors</h1></div></div></div><a class="indexterm" name="idm345748460112"></a><div class="table"><a name="gsiopenssh-errors-table"></a><p class="title"><b>Table A.1. GSI-OpenSSH Errors</b></p><div class="table-contents"><table summary="GSI-OpenSSH Errors" border="1" width="700px"><colgroup><col align="left" class="c1"><col align="left" class="c2"><col align="left" class="c3"></colgroup><thead><tr><th align="left">Error Code</th><th align="left">Definition</th><th align="left">Possible Solutions</th></tr></thead><tbody><tr><td align="left"><code class="code">GSS-API error Failure acquiring GSSAPI credentials: GSS_S_CREDENTIALS_EXPIRED</code></td><td align="left">This means that your proxy certificate has expired.</td><td align="left">
Run <a href="../../gsic/pi/#grid-proxy-init" class="olink">grid-proxy-init</a> to acquire a new proxy certificate, then run <code class="code">gsissh</code> again.
  </td></tr><tr><td align="left"><code class="code">...no proxy credentials...</code></td><td align="left">Failing to run grid-proxy-init to create a user proxy with which to connect will result in the client notifying you that no local credentials 
   exist. Any attempt to authenticate using GSI will fail in this case.

</td><td align="left">
Verify that your GSI proxy has been properly initialized via <a href="../../gsic/pi/#grid-proxy-info" class="olink">grid-proxy-info</a>. 
   If you need to initialize the proxy, use the command <a href="../../gsic/pi/#grid-proxy-init" class="olink">grid-proxy-init</a>.
  </td></tr><tr><td align="left"><code class="code">...bad file system permissions on private key; key must only be readable by the user...</code></td><td align="left">The host key that the SSH server is using for GSI authentication must only be readable by the user which owns it. 
   Any other permissions will cause this error.

</td><td align="left">
Make sure that the host key's UNIX permissions are mode 400 (that is, it should only have mode readable for the user that owns the file, 
and no other mode bits should be set).
  </td></tr><tr><td align="left"><code class="code">...gssapi received empty username; failed to set username from gssapi context; Failed external-keyx for &lt;user&gt; from &lt;host&gt; &lt;port&gt;...</code></td><td align="left">If the server was passed an "implicit username" (i.e. requested to map the incoming connection to a username based on some 
   contextual clues such as the certificate's subject), and no entry exists in the grid-mapfile for the incoming connection's certificate subject, 
   the server should output a clue that states it is unable to set the username against which to authenticate.

</td><td align="left">
Add an entry for the user to the <a href="../../gsic/pi/#gsic-env-gridmapfile" class="olink">Section 1.2, &#8220;Gridmap file&#8221;</a>.
  </td></tr><tr><td align="left"><code class="code">...INTERNAL ERROR: authenticated invalid user xxx...</code></td><td align="left">If the subject name given in the system's grid-mapfile points to a non-existent user, the server will give an internal error 
   which is best caught when it is running in debugging mode.

</td><td align="left">
Add a new account to the system matching the username pointed at by the user's subject in the grid-mapfile.
  </td></tr><tr><td align="left"><code class="code">...gssapi received empty username; no suitable client data; failed to set username from gssapi context; Failed external-keyx for &lt;user&gt; from &lt;host&gt; &lt;port&gt;...</code></td><td align="left"> Should the user attempt to connect without first creating a proxy certificate, or if the user is connecting via a SSH client that does 
   not support GSI authentication, the server will note that no GSSAPI data was sent to it. Verify that the client is able to connect through 
   another GSI service (such as the gatekeeper) to make sure that the user's proxy has been created correctly.

</td><td align="left">
Verify that you are using a GSI-enabled SSH client and that your GSI proxy has been properly initialized via 
   <a href="../../gsic/pi/#grid-proxy-info" class="olink">grid-proxy-info</a>. If you need to initialize this proxy, use the command <a href="../../gsic/pi/#grid-proxy-init" class="olink">grid-proxy-init</a>.
  </td></tr></tbody></table></div></div><br class="table-break"></div><div class="glossary"><div class="titlepage"><div><div><h1 class="title"><a name="glossary-opensshPI"></a>Glossary</h1></div></div></div><div class="glossdiv"><h3 class="title">G</h3><dl><dt><a name="grid-map-file"></a><span class="glossterm">grid map file</span></dt><dd class="glossdef"><p> A file containing entries mapping certificate subjects to local user
                              names. This file can also serve as a access control list for GSI
                              enabled services and is typically found in
                                    <code class="filename">/etc/grid-security/grid-mapfile</code>. For more
                              information see the Gridmap section <a href="../../gsic/admin/#setting-up-gridmap" class="olink">here</a>.</p></dd></dl></div><div class="glossdiv"><h3 class="title">H</h3><dl><dt><a name="host-cert"></a><span class="glossterm">host certificate</span></dt><dd class="glossdef"><p> An <a class="ulink" href="#EEC" target="_top">EEC</a> belonging to a host. When using GSI this certificate is
                              typically stored in
                              <code class="filename">/etc/grid-security/hostcert.pem</code>. For more
                              information on possible host certificate locations see the <a href="../../gsic/developer/#gsic-env-credentials" class="olink">GSI C Developer's Guide</a>. </p></dd></dl></div><div class="glossdiv"><h3 class="title">P</h3><dl><dt><a name="proxy-cred"></a><span class="glossterm">proxy credentials</span></dt><dd class="glossdef"><p> The combination of a proxy certificate and its corresponding private
                              key. GSI typically stores proxy credentials in
                                          <code class="filename">/tmp/x509up_u<em class="replaceable"><code>&lt;uid&gt;</code></em>
                              </code>, where &lt;uid&gt; is the user id of the proxy
                              owner.</p></dd></dl></div></div></div>
