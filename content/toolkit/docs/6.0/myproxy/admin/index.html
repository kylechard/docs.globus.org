<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<div class="book"><div class="titlepage"><div><div><h1 class="title"><a name="myproxyAdmin"></a>GT 6.0 MyProxy: System Administrator's Guide</h1></div><div><div class="abstract"><p class="title"><b>Introduction</b></p><p>
This guide contains advanced configuration information for system administrators
  working with MyProxy. It provides references to information
  on procedures typically performed by system administrators, including installation,
  configuring, deploying, and testing the installation.</p><p>  </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../docbook/xsl/docbook-xsl-1.78.1/images/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p> This information is in addition to the basic Globus Toolkit prerequisite, 
      overview, installation, security configuration instructions in <a href="../../admin/install/#gtadmin" class="olink">Installing GT 6.0</a>.  
      Read through this guide before continuing!</p></td></tr></table></div><p>A typical MyProxy configuration has one dedicated myproxy-server for
  the site, with MyProxy clients installed on all systems where other
  Globus Toolkit client software is installed. </p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="chapter"><a href="#myproxy-admin-installing">1. Building and Installing</a></span></dt><dt><span class="chapter"><a href="#myproxy-configuring">2. Configuring </a></span></dt><dt><span class="chapter"><a href="#myproxy-admin-deploying">3. Deploying</a></span></dt><dt><span class="chapter"><a href="#myproxy-admin-testing">4. Testing</a></span></dt><dt><span class="chapter"><a href="#myproxy-admin-security_considerations">5. Security Considerations</a></span></dt><dd><dl><dt><span class="section"><a href="#myproxy-security-considerations">1. MyProxy Security Considerations</a></span></dt></dl></dd><dt><span class="chapter"><a href="#myproxy-admin-debugging">6. Debugging</a></span></dt><dd><dl><dt><span class="section"><a href="#myproxy-logging">1. Logging</a></span></dt></dl></dd><dt><span class="chapter"><a href="#myproxy-user-troubleshooting">7. Troubleshooting</a></span></dt><dd><dl><dt><span class="section"><a href="#myproxy-error-codes">1. Errors</a></span></dt><dt><span class="section"><a href="#myproxy-errors">2. Additional MyProxy Troubleshooting</a></span></dt></dl></dd><dt><span class="chapter"><a href="#myproxy-usage">8. Usage statistics collection</a></span></dt><dd><dl><dt><span class="section"><a href="#myproxy-usage-stats">1. MyProxy usage statistics collection</a></span></dt></dl></dd><dt><span class="glossary"><a href="#glossary-myproxyAdmin">Glossary</a></span></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="myproxy-admin-installing"></a>Chapter 1. Building and Installing</h1></div></div></div><p>MyProxy is built and installed as part of a default GT 6.0 installation. For
    basic installation instructions, see <a href="../../admin/install/#gtadmin" class="olink">Installing GT 6.0</a>. No extra installation steps are required
  for this component.</p><p>If you wish to install MyProxy without installing the rest
  of the Globus Toolkit, follow the instructions in
  <a href="../../admin/install/#gtadmin" class="olink">Installing GT 6.0</a> 
  with the following changes.  First, you do not need Ant, a JDK, or a
  JDBC database to build only MyProxy.
  Second, instead of running "make",
  run:
</p><pre class="screen">globus$ make gsi-myproxy</pre><p>
  This will install the MyProxy client and server programs.
  For client-only installations, simply do not configure or use the installed server.
</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="myproxy-configuring"></a>Chapter 2. Configuring </h1></div></div></div><p>No additional configuration is required to use MyProxy clients after they
  are installed, although you may want to set the MYPROXY_SERVER environment
  variable to the hostname of your myproxy-server in the default user environment
  on your systems.</p><p>
Please refer to the 
<a class="ulink" href="http://myproxy.ncsa.uiuc.edu/adminguide.html" target="_top">MyProxy Admin Guide</a>
for MyProxy server configuration instructions.
</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="myproxy-admin-deploying"></a>Chapter 3. Deploying</h1></div></div></div><p>
A sample SysV-style
boot script for MyProxy is installed at
<code class="filename">$GLOBUS_LOCATION/share/myproxy/etc.init.d.myproxy</code>.
To install on Linux, copy the file to <code class="filename">/etc/rc.d/init.d/myproxy</code> and run
<span class="command"><strong>chkconfig --add myproxy</strong></span>.
You will need to edit the file to set the <code class="filename">GLOBUS_LOCATION</code> environment
variable correctly.
</p><p>
Alternatively, to run the myproxy server out of inetd or xinetd, you
need to do the following as root:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">   Add the entries in
       <code class="filename">$GLOBUS_LOCATION/share/myproxy/etc.services</code>.modifications to the
       <code class="filename">/etc/services</code> or <code class="filename">/etc/inet/services</code> file.</li><li class="listitem">   Add the entries in
       <code class="filename">$GLOBUS_LOCATION/share/myproxy/etc.inetd.conf.modifications</code> to
       <code class="filename">/etc/inetd.conf</code> or <code class="filename">/etc/inet/inetd.conf</code>, or copy
       <code class="filename">$GLOBUS_LOCATION/share/myproxy/etc.xinetd.myproxy</code> to
       <code class="filename">/etc/xinetd.d/myproxy</code>.  You'll need to modify the paths in the
       file according to your installation.</li><li class="listitem">   Reactivate the inetd (or xinetd).
       This is typically accomplished by sending the SIGHUP signal to
       the daemon.  Refer to the inetd or xinetd man page for your system.</li></ul></div><p>
In addition, an example cron script is provided in <code class="filename">$GLOBUS_LOCATION/share/myproxy/myproxy.cron</code>
for removing expired/revoked credentials from the repository.
You will need to edit the file to set the <code class="filename">GLOBUS_LOCATION</code>
environment variable correctly before installing in (for example) <code class="filename">/etc/cron.hourly</code>. 
</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="myproxy-admin-testing"></a>Chapter 4. Testing</h1></div></div></div><p>
To verify your myproxy-server installation and configuration, you can
run the myproxy-server directly from your shell.
  If using a <a href="#host-cert" class="glossterm"><em class="glossterm">host certificate</em></a>, you will need to run the myproxy-server
as root.

First, make sure your Globus environment is setup in your shell.
Set the <code class="filename">GLOBUS_LOCATION</code> environment variable to the location of your
MyProxy installation.  

Then, depending on your shell, run one of the following commands.
</p><p>
For csh shells:
</p><div class="blockquote"><blockquote class="blockquote"><p>
<span class="command"><strong>source $GLOBUS_LOCATION/etc/globus-user-env.csh</strong></span>
</p></blockquote></div><p>
For sh shells:
</p><div class="blockquote"><blockquote class="blockquote"><p>
<span class="command"><strong>. $GLOBUS_LOCATION/etc/globus-user-env.sh</strong></span>
</p></blockquote></div><p>
Then, run <span class="command"><strong>$GLOBUS_LOCATION/sbin/myproxy-server -d</strong></span>.
The <code class="option">-d</code> argument runs the myproxy-server in debug mode.
It will write debugging messages to the terminal and
exit after servicing a single request.
You will need to start it once for each test request.
In another shell, you can run the MyProxy client programs to test the
server.
</p><p>
If run without the <code class="option">-d</code> argument,
the myproxy-server program will start up and background itself.
It accepts connections on TCP port 7512, forking off a separate child
to handle each incoming connection.
It logs information via the syslog service under the daemon facility.
</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="myproxy-admin-security_considerations"></a>Chapter 5. Security Considerations</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#myproxy-security-considerations">1. MyProxy Security Considerations</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="myproxy-security-considerations"></a>1. MyProxy Security Considerations</h2></div></div></div><p>
You should choose a well-protected host to run the myproxy-server
on. Consult with security-aware personnel at your site. You want a host
that is secured to the level of a Kerberos KDC, that has limited user
access, runs limited services, and is well monitored and maintained in
terms of security patches.
</p><p>
For a typical myproxy-server installation, 
the host on which the myproxy-server is running must
    have /etc/grid-security created and a <a href="#host-cert" class="glossterm"><em class="glossterm">host certificate</em></a> installed.
In this case, the myproxy-server will run as root so it can access the
host certificate and key.
</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="myproxy-admin-debugging"></a>Chapter 6. Debugging</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#myproxy-logging">1. Logging</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="myproxy-logging"></a>1. Logging</h2></div></div></div><a class="indexterm" name="idm254338545664"></a><p>
The myproxy-server logs to the system logger (syslog) LOG_DAEMON
facility.
Alternatively, run
</p><div class="blockquote"><blockquote class="blockquote"><p><span class="command"><strong>myproxy-server -d</strong></span></p></blockquote></div><p>
from a terminal.
In that mode, the myproxy-server will write debugging messages to the
terminal and exit after servicing a single request.
</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="myproxy-user-troubleshooting"></a>Chapter 7. Troubleshooting</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#myproxy-error-codes">1. Errors</a></span></dt><dt><span class="section"><a href="#myproxy-errors">2. Additional MyProxy Troubleshooting</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="myproxy-error-codes"></a>1. Errors</h2></div></div></div><a class="indexterm" name="idm254315913216"></a><div class="table"><a name="myproxy-errors-table"></a><p class="title"><b>Table 7.1. MyProxy Errors</b></p><div class="table-contents"><table summary="MyProxy Errors" border="1" width="700px"><colgroup><col align="left" class="c1"><col align="left" class="c2"><col align="left" class="c3"></colgroup><thead><tr><th align="left">Error Code</th><th align="left">Definition</th><th align="left">Possible Solutions</th></tr></thead><tbody><tr><td align="left"><code class="code"> MyProxy server name does not match expected name</code></td><td align="left"><p>This error appears as a mutual authentication failure or a server authentication failure, and the error message should list two names: 
   the expected name of the MyProxy server and the actual authenticated name.</p> 
   <p>By default, the MyProxy clients expect the MyProxy server to be running with a host certificate that matches the target hostname. 
   This error can occur when running the MyProxy server under a non-host certificate or if the server is running on a machine with multiple hostnames.</p> The MyProxy clients authenticate the identity of the MyProxy server to avoid sending passphrases and credentials to rogue servers.
  <p> If the expected name contains an IP address, your system is unable to do a reverse lookup on that address to get the canonical hostname of the server, indicating either a problem with that machine's DNS record or a problem with the resolver on your system.</p></td><td align="left">
If the server name shown in the error message is acceptable, set the <code class="envar">MYPROXY_SERVER_DN</code> environment variable to that name to resolve the problem.
  </td></tr><tr><td align="left"><code class="code">Error in bind(): Address already in use</code></td><td align="left">This error indicates that the myproxy-server port (default: 7512) is in use by another process, probably another myproxy-server 
   instance. You cannot run multiple instances of the myproxy-server on the same network port.</td><td align="left">
If you want to run multiple instances of the myproxy-server on a machine, you can specify different ports with the <code class="option">-p</code> option, 
   and then give the same <code class="option">-p</code> option to the MyProxy commands to tell them to use the myproxy-server on that port.
  </td></tr><tr><td align="left"><code class="code">grid-proxy-init failed</code></td><td align="left">This error indicates that the grid-proxy-init command failed when myproxy-init attempted to run it, which implies a problem with the 
   underlying Globus installation.</td><td align="left">
Run <pre class="screen">grid-proxy-init -debug -verify</pre> for more information. 
  </td></tr><tr><td align="left"><code class="code">User not authorized</code></td><td align="left">An error from the myproxy-server saying you are "not authorized" to complete an operation typically indicates that the 
   <code class="filename">myproxy-server.config</code> file settings are restricting your access to the myproxy-server. It is possible that the 
   myproxy-server is running with the default <code class="filename">myproxy-server.config</code> file, which does not authorize any operations.</td><td align="left">
See <a href="#myproxy-configuring" class="olink">Configuring MyProxy</a>  for more information.
  </td></tr><tr><td align="left"><code class="code">Unable to verify remote side's credentials</code></td><td align="left">
    An error saying "Unable to verify remote side's credentials,"
    "Couldn't verify the remote certificate," or "alert bad certificate"
    often indicates that the client or server's certificate is signed by
    an untrusted Certification Authority (CA). The client must have a CA
    certificate and signing policy file installed in
    <code class="filename">/etc/grid-security/certificates</code> for the CA that signed the server's
    certificate. Likewise, the server must have a CA certificate and
    signing policy file installed in <code class="filename">/etc/grid-security/certificates</code> for
    the CA that signed the client's certificate.
  </td><td align="left">
    See <a href="../../gsic/admin/#gsic-configuring" class="olink">Configuring Certificates</a> for more information.
  </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="myproxy-errors"></a>2. Additional MyProxy Troubleshooting</h2></div></div></div><p>For additional information, see the
  <a class="ulink" href="http://myproxy.ncsa.uiuc.edu/troubleshooting.html" target="_top">MyProxy Troubleshooting Page</a> at NCSA.
</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="myproxy-usage"></a>Chapter 8. Usage statistics collection</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#myproxy-usage-stats">1. MyProxy usage statistics collection</a></span></dt></dl></div><a class="indexterm" name="idm254338995632"></a><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="myproxy-usage-stats"></a>1. MyProxy usage statistics collection</h2></div></div></div><p>
By default, the myproxy-server will send a UDP packet containing usage
information to 
usage-stats.cilogon.org:4810 after serving each request. 
See the
<a class="ulink" href="http://myproxy.ncsa.uiuc.edu/privacy" target="_top">MyProxy Privacy Policy</a>
    for details. You can see the Globus Usage Statistics policy <a class="ulink" href="/toolkit/docs/latest-stable/Usage_Stats.html" target="_top">here</a>.
</p></div></div><div class="glossary"><div class="titlepage"><div><div><h1 class="title"><a name="glossary-myproxyAdmin"></a>Glossary</h1></div></div></div><div class="glossdiv"><h3 class="title">H</h3><dl><dt><a name="host-cert"></a><span class="glossterm">host certificate</span></dt><dd class="glossdef"><p> An <a class="ulink" href="#EEC" target="_top">EEC</a> belonging to a host. When using GSI this certificate is
                              typically stored in
                              <code class="filename">/etc/grid-security/hostcert.pem</code>. For more
                              information on possible host certificate locations see the <a href="../../gsic/developer/#gsic-env-credentials" class="olink">GSI C Developer's Guide</a>. </p></dd></dl></div></div></div>
