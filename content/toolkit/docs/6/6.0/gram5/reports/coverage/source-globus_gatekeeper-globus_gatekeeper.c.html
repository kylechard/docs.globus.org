<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- source.template -->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
      <title>Code Coverage for globus_gatekeeper.c</title>
      <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
      <link href="coverage.css" rel="stylesheet" type="text/css" />
  </head>

  <body>
      <table class="srcView">
      
        <tr>
          <td class="lineCount">1</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * Copyright 1999-2006 University of Chicago</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">3</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">4</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">5</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * you may not use this file except in compliance with the License.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">6</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * You may obtain a copy of the License at</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">7</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">8</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * http://www.apache.org/licenses/LICENSE-2.0</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">9</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">10</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * Unless required by applicable law or agreed to in writing, software</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">11</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">12</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">13</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * See the License for the specific language governing permissions and</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">14</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * limitations under the License.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">15</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">16</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">17</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">18</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">gram_gatekeeper.c</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">19</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">20</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">21</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    Resource Managemant gatekeeper.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">22</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">23</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">CVS Information:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">24</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">25</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    $Source: /home/ec2-user/alliance-web/alliance/toolkit/docs/5.2/5.2.5/gram5/reports/coverage/source-globus_gatekeeper-globus_gatekeeper.c.html,v $</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">26</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    $Date: 2013/06/19 18:13:35 $</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">27</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    $Revision: 1.1 $</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">28</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    $Author: bester $</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">29</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">30</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> This source file has been modified by Brent Milne (BMilne@lbl.gov)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">31</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> with extensions for UNICOS.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">32</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> September 1998</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">33</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">34</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">35</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">36</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">37</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                             Include header files</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">38</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">39</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(_AIX32) &amp;&amp; !defined(_ALL_SOURCE)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">40</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define _ALL_SOURCE</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">41</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">42</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;globus_config.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">43</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;globus_gatekeeper_config.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">44</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">45</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;stdio.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">46</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;stdlib.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">47</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;ctype.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">48</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;fcntl.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">49</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;pwd.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">50</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/param.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">51</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;unistd.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">52</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;errno.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">53</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;signal.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">54</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/types.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">55</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/uio.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">56</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/socket.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">57</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/select.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">58</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;syslog.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">59</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;netdb.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">60</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;netinet/in.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">61</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">62</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined (HAVE_NETINET_TCP_H)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">63</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   include &lt;netinet/tcp.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">64</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">65</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">66</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;time.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">67</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/stat.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">68</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/file.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">69</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/ioctl.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">70</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/signal.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">71</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;sys/wait.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">72</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">73</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifdef HAVE_MALLOC_H</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">74</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   include &lt;malloc.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">75</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">76</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">77</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;globus_gss_assist.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">78</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;gssapi.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">79</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">80</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifndef _HAVE_GSI_EXTENDED_GSSAPI</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">81</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;globus_gss_ext_compat.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">82</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">83</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">84</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(TARGET_ARCH_SOLARIS)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">85</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;termios.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">86</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">87</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">88</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(TARGET_ARCH_AIX)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">89</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define netlen_t size_t</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">90</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">91</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define netlen_t int</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">92</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">93</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">94</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;arpa/inet.h&gt; /* for inet_ntoa() */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">95</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">96</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if HAVE_STRINGS_H</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">97</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;strings.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">98</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">99</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">100</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if HAVE_STRING_H</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">101</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;string.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">102</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">103</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">104</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(TARGET_ARCH_CRAYT3E)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">105</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;unicos.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">106</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">107</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">108</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(HAVE_PROJ_H) &amp;&amp; defined(TARGET_ARCH_IRIX)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">109</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &lt;proj.h&gt;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">110</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">111</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">112</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if !defined(MAXPATHLEN) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">113</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   define MAXPATHLEN PATH_MAX</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">114</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">115</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">116</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifndef HAVE_SETENV</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">117</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">extern int setenv();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">118</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">119</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">120</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifndef HAVE_UNSETENV</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">121</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">extern void unsetenv();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">122</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">123</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">124</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#include &quot;globus_gatekeeper_utils.h&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">125</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">126</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">127</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                               Type definitions</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">128</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">129</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">130</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define SERVICE_ARGS_MAX 100</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">131</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/* offsets in the service command line after tokenize */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">132</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/* note the one before the path gets overlaid */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">133</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define SERVICE_OPTIONS_INDEX 0</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">134</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define SERVICE_USER_INDEX 1</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">135</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define SERVICE_PATH_INDEX 2</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">136</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define SERVICE_ARG0_INDEX 3</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">137</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define SERVICE_ARG1_INDEX 4</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">138</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">139</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define SERVICE_OPTIONS_MAX 20</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">140</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">141</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                          Module specific prototypes</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">142</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">143</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void doit(void);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">144</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int logging_startup(void);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">145</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int logging_phase2(void);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">146</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void failure(short failure_type, char *s);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">147</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void notice(int, char *s);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">148</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int net_accept(int socket);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">149</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void net_setup_listener(int backlog, int *port, int *socket);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">150</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void error_check(int val, char *string);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">151</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *timestamp(void);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">152</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void null_terminate_string(char ** s, size_t len);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">153</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">154</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char * genfilename(char * prefix, char * path, char * sufix);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">155</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">156</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int get_content_length(char * http_message, char * http_body);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">157</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">158</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * GSSAPI - credential handle for this process</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">159</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">160</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static gss_cred_id_t credential_handle = GSS_C_NO_CREDENTIAL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">161</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static gss_cred_id_t delegated_cred_handle = GSS_C_NO_CREDENTIAL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">162</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static gss_ctx_id_t  context_handle    = GSS_C_NO_CONTEXT;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">163</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">164</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">165</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> * local definition of restrictions oid</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">166</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> *</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">167</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"> */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">168</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">169</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">extern</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">170</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">const gss_OID_desc * const gss_restrictions_extension;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">171</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">172</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">173</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                       Define module specific variables</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">174</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">175</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define MAXARGS 256</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">176</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define DEFAULT_PORT 754</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">177</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define MAX_MESSAGE_LENGTH 100000</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">178</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifndef GRAM_K5_EXE</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">179</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#       define GRAM_K5_EXE &quot;globus-k5&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">180</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">181</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifndef GLOBUS_LIBEXECDIR</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">182</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#  define GLOBUS_LIBEXECDIR &quot;libexec&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">183</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">184</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifndef GLOBUS_GATEKEEPER_HOME</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">185</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#       define GLOBUS_GATEKEEPER_HOME &quot;/etc&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">186</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">187</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifndef LOGFILE</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">188</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define LOGFILE &quot;&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">189</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">190</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">191</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifndef PATH_MAX</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">192</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define PATH_MAX MAXPATHLEN</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">193</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">194</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">195</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define FAILED_AUTHORIZATION        1</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">196</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define FAILED_SERVICELOOKUP        2</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">197</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define FAILED_SERVER               3</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">198</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define FAILED_NOLOGIN              4</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">199</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define FAILED_AUTHENTICATION       5</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">200</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define FAILED_PING                 6</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">201</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">202</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#undef MIN</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">203</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define MIN(a,b) ((a) &lt; (b) ? (a) : (b))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">204</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">205</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char     tmpbuf[1024];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">206</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define notice2(i,a,b) {sprintf(tmpbuf, a,b); notice(i,tmpbuf);}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">207</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define notice3(i,a,b,c) {sprintf(tmpbuf, a,b,c); notice(i,tmpbuf);}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">208</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define notice4(i,a,b,c,d) {sprintf(tmpbuf, a,b,c,d); notice(i,tmpbuf);}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">209</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define notice5(i,a,b,c,d,e) {sprintf(tmpbuf, a,b,c,d,e); notice(i,tmpbuf);}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">210</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define failure2(t,a,b) {sprintf(tmpbuf, a,b); failure(t,tmpbuf);}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">211</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define failure3(t,a,b,c) {sprintf(tmpbuf, a,b,c); failure(t,tmpbuf);}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">212</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define failure4(t,a,b,c,d) {sprintf(tmpbuf, a,b,c,d); failure(t,tmpbuf);}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">213</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">214</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define FORK_AND_EXIT	1</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">215</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define FORK_AND_WAIT	2</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">216</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#define DONT_FORK	3</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">217</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int	launch_method = FORK_AND_EXIT;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">218</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">219</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">extern int      errno;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">220</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">221</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      connection_fd;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">222</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      listener_fd = -1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">223</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">224</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static FILE *   usrlog_fp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">225</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   logfile = LOGFILE;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">226</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   acctfile;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">227</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static volatile int	logrotate;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">228</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static pid_t    gatekeeper_pid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">229</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static unsigned reqnr;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">230</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char     test_dat_file[1024];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">231</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      gatekeeper_test;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">232</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      gatekeeper_uid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">233</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      daemon_port;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">234</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      logging_syslog;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">235</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      logging_usrlog;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">236</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      debug;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">237</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      foreground;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">238</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      krb5flag;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">239</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      run_from_inetd;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">240</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   gatekeeperhome = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">241</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   job_manager_exe = &quot;globus-job-manager&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">242</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   jm_conf_path = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">243</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   libexecdir = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">244</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   libexecdirr = GLOBUS_LIBEXECDIR;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">245</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   service_name = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">246</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   grid_services = &quot;etc/grid-services&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">247</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   gridmap = &quot;etc/gridmap&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">248</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   globuskmap = &quot;etc/globuskmap&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">249</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   globuscertdir = &quot;cert&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">250</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   globuskeydir = &quot;key&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">251</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   globusnologin =&quot;globus-nologin&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">252</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   x509_cert_dir = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">253</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   x509_cert_file = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">254</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   x509_user_proxy = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">255</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   x509_user_cert = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">256</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   x509_user_key = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">257</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *   desired_name_char = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">258</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      ok_to_send_errmsg = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">259</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static FILE *   fdout;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">260</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int      got_ping_request = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">261</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">262</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">263</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       get_globusid()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">264</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    Get the globusid from gssapi or environment if possible.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">265</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">266</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">267</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">268</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char * </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">269</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">get_globusid()</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">270</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">271</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *            globusid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">272</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *            globusid_tmp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">273</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    gss_name_t        server_name = GSS_C_NO_NAME;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">274</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    gss_buffer_desc   server_buffer_desc = GSS_C_EMPTY_BUFFER;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">275</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    gss_buffer_t      server_buffer = &amp;server_buffer_desc; </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">276</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    OM_uint32         major_status = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">277</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    OM_uint32         minor_status = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">278</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    OM_uint32         minor_status2 = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">279</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">280</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if ((major_status = gss_inquire_cred(&amp;minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">281</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         credential_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">282</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         &amp;server_name,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">283</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         NULL,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">284</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         NULL,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">285</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         NULL)) == GSS_S_COMPLETE)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">286</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">287</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        major_status = gss_display_name(&amp;minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">288</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                        server_name,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">289</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                        server_buffer,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">290</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                        NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">291</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        gss_release_name(&amp;minor_status2, &amp;server_name);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">292</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">293</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">294</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * The gssapi_cleartext does not implement gss_inquire_cred,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">295</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * so fall back to using environment variable.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">296</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">297</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (major_status == GSS_S_COMPLETE) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">298</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">299</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        globusid = server_buffer_desc.value;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">300</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">301</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    else </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">302</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">303</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        globusid = getenv(&quot;GLOBUSID&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">304</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        globusid = (globusid ? globusid : &quot;GLOBUSID&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">305</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">306</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    globusid_tmp = strdup(globusid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">307</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">308</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (server_buffer_desc.value)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">309</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">310</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        gss_release_buffer(&amp;minor_status2, server_buffer);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">311</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">312</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    return globusid_tmp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">313</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">314</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">315</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">316</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       terminate()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">317</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    Handle a  SIGTERM, and specificly close the listener_fd</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">318</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                This should avoid problems when the gatekeeper</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">319</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                is shutdown. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">320</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">321</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">322</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">323</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">void </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">324</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">terminate(int s)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">325</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">326</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    notice2(LOG_NOTICE,&quot;Gatekeeper received signal:%d&quot;,s);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">327</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    if (listener_fd &gt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">328</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">329</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">330</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if 0</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">331</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/* may need to add code for unicos MLS to get socket closed */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">332</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#     if defined(TARGET_ARCH_CRAYT3E)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">333</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">334</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            if(gatekeeper_uid == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">335</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">336</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                close_unicos_socket(listener_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">337</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">338</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">339</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#     endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">340</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">341</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">342</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        if (close(listener_fd) == -1)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">343</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">344</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            notice3(LOG_ERR, &quot;Shutdown of %d: %.100s&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">345</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    listener_fd, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">346</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                        </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">347</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">348</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        listener_fd = -1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">349</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">350</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    failure2(FAILED_SERVER,&quot;Gatekeeper shutdown on signal:%d&quot;,s)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">351</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">352</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">353</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       reaper()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">354</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    Wait for any child processes that have terminated.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">355</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">356</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">357</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">358</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">void </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">359</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">reaper(int s)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">360</td>
          <td class="coverageCount">61348</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">361</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int pid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">362</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   ifdef HAS_WAIT_UNION_WAIT</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">363</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    union wait status;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">364</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">365</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int status;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">366</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">367</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">368</td>
          <td class="coverageCount">61348</td>
          <td class="srcCell"><span class="srcLine">    if (launch_method == DONT_FORK) return;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">369</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">370</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   ifdef HAS_WAIT3</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">371</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    while ((pid = wait3(&amp;status, WNOHANG, NULL)) &gt; 0) ;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">372</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   else</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">373</td>
          <td class="coverageCount">122696</td>
          <td class="srcCell"><span class="srcLine">    while ((pid = waitpid(-1, &amp;status, WNOHANG)) &gt; 0) ;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">374</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">375</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">} /* reaper() */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">376</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">377</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">378</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       rotatelog()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">379</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    Handle a SIGUSR1: set a flag indicating the logfile should be</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">380</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                  rotated by the main loop.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">381</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">382</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">383</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">384</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">385</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">rotatelog(int s)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">386</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">387</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    logrotate = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">388</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">389</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">390</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">391</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       new_acct_file()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">392</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    Rotate old and open new job accounting file.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">393</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">394</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">395</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">396</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">397</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">new_acct_file(void)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">398</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">399</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    static int acct_fd = -1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">400</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">401</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    if (acct_fd &gt;= 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">402</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">403</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	if (strcmp(acctfile, logfile) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">404</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">405</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    static int seqnr;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">406</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            char *acctpath = genfilename(gatekeeperhome, acctfile, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">407</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    char *oldpath = malloc(strlen(acctpath) + 64);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">408</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    time_t clock = time((time_t *) 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">409</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    struct tm *tmp = localtime(&amp;clock);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">410</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    int ret;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">411</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">412</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    sprintf(oldpath, &quot;%s.%04d%02d%02d%02d%02d%02d.%d&quot;, acctpath,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">413</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		tmp-&gt;tm_year + 1900, tmp-&gt;tm_mon + 1, tmp-&gt;tm_mday,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">414</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		tmp-&gt;tm_hour, tmp-&gt;tm_min, tmp-&gt;tm_sec, seqnr++);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">415</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">416</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    if ((ret = rename(acctpath, oldpath)) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">417</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">418</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		notice4(LOG_ERR, &quot;ERROR: cannot rename %s to %s: %s&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">419</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		    acctpath, oldpath, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">420</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">421</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">422</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">423</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		notice2(0, &quot;renamed accounting file %s&quot;, oldpath);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">424</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">425</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">426</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    free(acctpath);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">427</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    free(oldpath);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">428</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">429</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    if (ret) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">430</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		return;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">431</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">432</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">433</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">434</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	close(acct_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">435</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	acct_fd = -1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">436</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">437</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">438</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    if (!acctfile)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">439</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">440</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	acctfile = logfile;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">441</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">442</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">443</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    if (acctfile &amp;&amp; *acctfile)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">444</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">445</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	const char *acct_fd_var = &quot;GATEKEEPER_ACCT_FD&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">446</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	char *acctpath = genfilename(gatekeeperhome, acctfile, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">447</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">448</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	acct_fd = open(acctpath, O_WRONLY | O_APPEND | O_CREAT, 0644);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">449</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">450</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	if (acct_fd &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">451</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">452</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    notice3(LOG_ERR, &quot;ERROR: cannot open accounting file &#39;%s&#39;: %s&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">453</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		acctpath, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">454</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">455</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    unsetenv(acct_fd_var);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">456</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">457</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">458</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">459</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">460</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	     * Now inform JM via environment.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">461</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">462</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">463</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    char buf[32];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">464</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">465</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	    sprintf(buf, &quot;%d&quot;, acct_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">466</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">467</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	    setenv(acct_fd_var, buf, 1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">468</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">469</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	    notice4(0, &quot;%s=%s (%s)&quot;, acct_fd_var, buf, acctpath);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">470</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">471</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">472</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	free(acctpath);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">473</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">474</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">475</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">476</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">477</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       genfilename()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">478</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    generate an absolute file name given a starting prefix,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">479</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                a relative or absolute path, and a sufix</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">480</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                Only use prefix if path is relative.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">481</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">482</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:                a pointer to a string which could be freeded.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">483</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">484</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">485</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static char *</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">486</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">genfilename(char * prefixp, char * pathp, char * sufixp)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">487</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">488</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char * newfilename;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">489</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int    prefixl, pathl, sufixl;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">490</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char * prefix,  * path, * sufix;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">491</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">492</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">    prefix = (prefixp) ? prefixp : &quot;&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">493</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">    path   = (pathp) ? pathp : &quot;&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">494</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">    sufix  = (sufixp) ? sufixp : &quot;&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">495</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">496</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">    prefixl = strlen(prefix);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">497</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">    pathl   =  strlen(path);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">498</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">    sufixl  =  strlen(sufix); </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">499</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">500</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">    newfilename = (char *) calloc(1, (prefixl + pathl + sufixl + 3));</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">501</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">    if (newfilename) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">502</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">503</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">        if (*path != &#39;/&#39;)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">504</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">505</td>
          <td class="coverageCount">2667</td>
          <td class="srcCell"><span class="srcLine">            strcat(newfilename, prefix);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">506</td>
          <td class="coverageCount">2667</td>
          <td class="srcCell"><span class="srcLine">            if ((prefixl != 0) &amp;&amp; (prefix[prefixl-1] != &#39;/&#39;))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">507</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">508</td>
          <td class="coverageCount">2667</td>
          <td class="srcCell"><span class="srcLine">                strcat(newfilename, &quot;/&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">509</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">510</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">511</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">        strcat(newfilename, path);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">512</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">        if ((pathl  != 0) &amp;&amp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">513</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            (sufixl != 0) &amp;&amp; </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">514</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            (path[pathl-1] != &#39;/&#39;) &amp;&amp; </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">515</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            sufix[0] != &#39;/&#39;)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">516</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">517</td>
          <td class="coverageCount">2021</td>
          <td class="srcCell"><span class="srcLine">            strcat(newfilename, &quot;/&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">518</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">519</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">        strcat(newfilename, sufix);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">520</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">521</td>
          <td class="coverageCount">6003</td>
          <td class="srcCell"><span class="srcLine">    return newfilename;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">522</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">523</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">524</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">525</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       main()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">526</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">527</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">528</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">529</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">530</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">int </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">531</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">main(int xargc,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">532</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     char ** xargv)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">533</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">534</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    int argc = xargc;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">535</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    char ** argv = xargv;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">536</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int    i;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">537</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int    fd;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">538</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int    pid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">539</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int    ttyfd;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">540</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int    rc;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">541</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    netlen_t   namelen;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">542</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    struct sockaddr_in name;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">543</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    struct stat         statbuf;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">544</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">545</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* GSSAPI status vaiables */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">546</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    OM_uint32 major_status = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">547</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    OM_uint32 minor_status = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">548</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">549</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    rc = globus_module_activate(GLOBUS_GSI_GSS_ASSIST_MODULE);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">550</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if(rc != GLOBUS_SUCCESS)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">551</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">552</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        exit(1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">553</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">554</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">555</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(TARGET_ARCH_CRAYT3E)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">556</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    unicos_init();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">557</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">558</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">559</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">560</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Don&#39;t allow logins of /etc/nologins is defined. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">561</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Silently ignore them, as the sysadmin</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">562</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * must have other problems.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">563</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">564</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">565</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if ((rc = stat(&quot;/etc/nologin&quot;,&amp;statbuf)) == 0 )</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">566</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">567</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        exit (1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">568</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">569</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">570</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    gatekeeper_pid = getpid();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">571</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">572</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    gatekeeper_uid = getuid();</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">573</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (gatekeeper_uid == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">574</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">575</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">576</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * If root, use DEFAULT_PORT</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">577</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">578</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        daemon_port = DEFAULT_PORT;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">579</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">580</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">581</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">582</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">583</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * If not root, let net_setup_listener call provide the port</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">584</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * (may be overridden by the &quot;-p&quot; option, see below)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">585</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">586</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        daemon_port = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">587</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">588</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">589</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">590</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Decide if we are being run from inetd.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">591</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * If so, then stdin will be connected to a socket,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">592</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * so getpeername() will succeed.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">593</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">594</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">595</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    namelen = sizeof(name);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">596</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (getpeername(0, (struct sockaddr *) &amp;name, &amp;namelen) &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">597</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">598</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* set current working directory as default for </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">599</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * gatekeeperhome (-home path) when not run from inetd. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">600</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * otherwise it is NULL</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">601</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">602</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(TARGET_ARCH_LINUX) || defined(TARGET_ARCH_SOLARIS)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">603</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">604</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * There is a memory corruption bug in the getcwd in</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">605</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * glibc-2.1.1 and earlier</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">606</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         *</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">607</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * Solaris 2.5.1 does not have a correct implementation</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">608</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * of getcwd either.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">609</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         *</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">610</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">611</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">612</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            char tmppath[PATH_MAX];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">613</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">614</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            if(getwd(tmppath))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">615</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">616</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">                gatekeeperhome = strdup(tmppath);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">617</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">618</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">619</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">620</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">621</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            char *tmppath = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">622</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            int size = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">623</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            while ( (tmppath = getcwd (NULL, size)) == NULL )</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">624</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">625</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                size++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">626</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">627</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            gatekeeperhome = tmppath;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">628</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">629</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">630</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        run_from_inetd = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">631</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">632</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">633</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">634</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        run_from_inetd = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">635</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        gatekeeperhome = GLOBUS_GATEKEEPER_HOME;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">636</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">637</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * cant have stdout pointing at socket, some of the</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">638</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * old-old gssapi code writes to stdout so point at stderr</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">639</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">640</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        close(1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">641</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        (void) open(&quot;/dev/null&quot;,O_WRONLY);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">642</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">643</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">644</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    *test_dat_file = &#39;\0&#39;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">645</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">646</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Parse the command line arguments</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">647</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">648</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">649</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * But first see if the first parameter is a -c or -conf filename</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">650</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * which has the real parameter list. This is needed</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">651</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * since the parameters are getting long, and inetd/wrapper</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">652</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * may have a problem.  Will assume there are at most 52 </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">653</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * args, in a buffer of BUFSIZ at the most. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">654</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">655</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">656</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* But before that, check if there is a -test option</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">657</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * after the -c or -conf file. This will test the gatekeeper</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">658</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * -test can also be in the options file </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">659</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * this will run in forground, and not inetd</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">660</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">661</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">662</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (argc == 4 &amp;&amp; !strcmp(argv[3],&quot;-test&quot;))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">663</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">664</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        gatekeeper_test++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">665</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        argc--;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">666</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">667</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">668</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if ( argc == 3 &amp;&amp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">669</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         (!strcmp(argv[1],&quot;-c&quot;) ||</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">670</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">          !strcmp(argv[1],&quot;-conf&quot;))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">671</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        )</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">672</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">673</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char ** newargv;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">674</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char * newbuf;  </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">675</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        int newargc = 52;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">676</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        int  pfd;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">677</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">          </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">678</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        newargv = (char**) malloc(newargc * sizeof(char *)); /* not freeded */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">679</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        newbuf = (char *) malloc(BUFSIZ);  /* dont free */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">680</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        newargv[0] = argv[0];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">681</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        pfd = open(argv[2],O_RDONLY);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">682</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        i = read(pfd, newbuf, BUFSIZ-1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">683</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        if (i &lt; 0) </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">684</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            failure(FAILED_SERVER, &quot;Unable to read extra parameters&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">685</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        newbuf[i] = &#39;\0&#39;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">686</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        close(pfd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">687</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">688</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        newargv[0] = argv[0];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">689</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        newargc--;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">690</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        globus_gatekeeper_util_tokenize(newbuf, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">691</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                        &amp;newargv[1],</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">692</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                        &amp;newargc,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">693</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                        &quot; \t\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">694</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        argv = newargv;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">695</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        argc = newargc + 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">696</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">697</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">698</td>
          <td class="coverageCount">4753</td>
          <td class="srcCell"><span class="srcLine">    for (i = 1; i &lt; argc; i++)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">699</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">700</td>
          <td class="coverageCount">4753</td>
          <td class="srcCell"><span class="srcLine">        if ((strcmp(argv[i], &quot;-d&quot;) == 0) ||</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">701</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            (strcmp(argv[i], &quot;-debug&quot;) == 0 ))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">702</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">703</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            debug = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">704</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            foreground = 1;   /* Run in the forground */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">705</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">706</td>
          <td class="coverageCount">3395</td>
          <td class="srcCell"><span class="srcLine">        else if (strcmp(argv[i], &quot;-inetd&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">707</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">708</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            if(!run_from_inetd)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">709</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">710</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                if(!gatekeeper_test)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">711</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">712</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                    fprintf(stderr, &quot;Gatekeeper running as daemon, ignoring -inetd!\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">713</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">714</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">715</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">716</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">717</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                run_from_inetd = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">718</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                foreground = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">719</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">720</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">721</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">722</td>
          <td class="coverageCount">3395</td>
          <td class="srcCell"><span class="srcLine">        else if (((strcmp(argv[i], &quot;-p&quot;) == 0) ||</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">723</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                  (strcmp(argv[i], &quot;-port&quot;) == 0))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">724</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">725</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">726</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            daemon_port = atoi(argv[i+1]);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">727</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">728</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">729</td>
          <td class="coverageCount">4074</td>
          <td class="srcCell"><span class="srcLine">        else if (((strcmp(argv[i], &quot;-l&quot;) == 0) ||</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">730</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                  (strcmp(argv[i], &quot;-logfile&quot;) == 0))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">731</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">732</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">733</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            logfile =  argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">734</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">735</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">736</td>
          <td class="coverageCount">2716</td>
          <td class="srcCell"><span class="srcLine">        else if ((strcmp(argv[i], &quot;-acctfile&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">737</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">738</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">739</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            acctfile = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">740</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">741</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">742</td>
          <td class="coverageCount">3395</td>
          <td class="srcCell"><span class="srcLine">        else if ((strcmp(argv[i], &quot;-home&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">743</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">744</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">745</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            /* Also known as the ${deploy_prefix} */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">746</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            gatekeeperhome = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">747</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">748</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">749</td>
          <td class="coverageCount">2716</td>
          <td class="srcCell"><span class="srcLine">        else if ((strcmp(argv[i], &quot;-e&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">750</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">751</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">752</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            libexecdirr = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">753</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">754</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">755</td>
          <td class="coverageCount">2037</td>
          <td class="srcCell"><span class="srcLine">        else if ((strcmp(argv[i], &quot;-grid_services&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">756</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">757</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">758</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            grid_services = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">759</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">760</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">761</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* The jmconf and -jm are left here during the </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">762</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * cutover to the 1.1 so as to not have to change</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">763</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * the deploy scripts just yet. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">764</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">765</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        else if ((strcmp(argv[i], &quot;-jmconf&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">766</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">767</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">768</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            jm_conf_path =  argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">769</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">770</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">771</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        else if ((strcmp(argv[i], &quot;-jm&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">772</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">773</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">774</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            job_manager_exe =  argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">775</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">776</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">777</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        else if ((strcmp(argv[i], &quot;-t&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">778</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">779</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">780</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            strncpy(test_dat_file, argv[i+1],sizeof(test_dat_file));</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">781</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">782</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">783</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        else if (strcmp(argv[i], &quot;-test&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">784</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">785</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            gatekeeper_test++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">786</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">787</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">788</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        else if ((strcmp(argv[i], &quot;-globusid&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">789</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">790</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">791</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            setenv(&quot;GLOBUSID&quot;, argv[i+1],1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">792</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">793</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">794</td>
          <td class="coverageCount">1358</td>
          <td class="srcCell"><span class="srcLine">        else if ((strcmp(argv[i], &quot;-gridmap&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">795</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">796</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">797</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            gridmap = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">798</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">799</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">800</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if ((strcmp(argv[i], &quot;-globuskeydir&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">801</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">802</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">803</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            globuskeydir = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">804</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">805</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">806</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if ((strcmp(argv[i], &quot;-globuscertdir&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">807</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">808</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">809</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            globuscertdir = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">810</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">811</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">812</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">813</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* set environment variables used by gssapi_ssleay */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">814</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">815</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if ((strcmp(argv[i], &quot;-x509_cert_dir&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">816</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">817</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">818</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            x509_cert_dir = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">819</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">820</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">821</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if ((strcmp(argv[i], &quot;-x509_cert_file&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">822</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">823</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">824</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            x509_cert_file = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">825</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">826</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">827</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if ((strcmp(argv[i], &quot;-x509_user_proxy&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">828</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">829</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">830</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            x509_user_proxy = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">831</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">832</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">833</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if ((strcmp(argv[i], &quot;-x509_user_cert&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">834</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">835</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">836</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            x509_user_cert = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">837</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">838</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">839</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if ((strcmp(argv[i], &quot;-x509_user_key&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">840</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">841</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">842</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            x509_user_key = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">843</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">844</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">845</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">846</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if ((strcmp(argv[i], &quot;-desired_name&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">847</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">848</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">849</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            desired_name_char = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">850</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">851</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">852</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">853</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if ((strcmp(argv[i], &quot;-globuskmap&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">854</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">855</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">856</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            globuskmap = argv[i+1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">857</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            krb5flag = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">858</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">859</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">860</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if (strcmp(argv[i], &quot;-k&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">861</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">862</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            krb5flag = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">863</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">864</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if ((strcmp(argv[i], &quot;-f&quot;) == 0) ||</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">865</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 (strcmp(argv[i], &quot;-foreground&quot;) == 0))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">866</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">867</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            if(!run_from_inetd)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">868</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">869</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                /* make the daemon run in the Foreground */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">870</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">871</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                foreground = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">872</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                run_from_inetd = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">873</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">874</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">875</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	else if ((strcmp(argv[i], &quot;-launch_method&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">876</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		 &amp;&amp; (i + 1 &lt; argc))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">877</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">878</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    if(!run_from_inetd)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">879</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">880</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		fprintf(stderr, &quot;Gatekeeper running as daemon, &quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">881</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			&quot;ignoring -launch_method!\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">882</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">883</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    else if (strcmp(argv[i + 1], &quot;fork_and_exit&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">884</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">885</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		launch_method = FORK_AND_EXIT;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">886</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">887</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    else if (strcmp(argv[i + 1], &quot;fork_and_wait&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">888</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">889</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		launch_method = FORK_AND_WAIT;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">890</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">891</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    else if (strcmp(argv[i + 1], &quot;dont_fork&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">892</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">893</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		launch_method = DONT_FORK;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">894</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">895</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">896</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">897</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		fprintf(stderr, &quot;Bad -launch_method argument %s\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">898</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			argv[i + 1]);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">899</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">900</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    i++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">901</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">902</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">903</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">904</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">905</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            fprintf(stderr, &quot;Unknown argument %s\n&quot;, argv[i]);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">906</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            fprintf(stderr, &quot;Usage: %s %s %s %s %s %s %s %s %s %s\n &quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">907</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    argv[0], </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">908</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;{-conf parmfile [-test]} | {[-d[ebug] [-inetd | -f] [-p[ort] port] &quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">909</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;[-home path] [-l[ogfile] logfile] [-acctfile acctfile] [-e path] &quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">910</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;[-launch_method fork_and_exit|fork_and_wait|dont_fork] &quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">911</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;[-grid_services file] &quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">912</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;[-globusid globusid] [-gridmap file] &quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">913</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;[-x509_cert_dir path] [-x509_cert_file file]&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">914</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;[-x509_user_cert file] [-x509_user_key file]&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">915</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;[-x509_user_proxy file]&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">916</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;[-k] [-globuskmap file]&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">917</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;[-test]}&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">918</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                );</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">919</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            exit(1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">920</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">921</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">922</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">923</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">924</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * define libexec relative to home</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">925</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * if needed</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">926</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">927</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">928</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    libexecdir = genfilename(gatekeeperhome, libexecdirr, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">929</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">930</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">931</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Dont use default env proxy cert for gatekeeper if run as root</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">932</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * this might get left over. You can still use -x509_user_proxy</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">933</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">934</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">935</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (gatekeeper_uid == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">936</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">937</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        unsetenv(&quot;X509_USER_PROXY&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">938</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">939</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">940</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (gatekeeper_test)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">941</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">942</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        fprintf(stderr,&quot;Testing gatekeeper\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">943</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        if (getuid()) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">944</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">945</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">            fprintf(stderr,&quot;Local user id (uid)      : %d\n&quot;,gatekeeper_uid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">946</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">947</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">948</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">949</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            fprintf(stderr,&quot;Local user id (uid)      : root\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">950</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">951</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        fprintf(stderr,&quot;Home directory           : %s\n&quot;, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">952</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                (gatekeeperhome) ? gatekeeperhome : &quot;(not defined)&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">953</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        fprintf(stderr,&quot;Libexec directory        : %s\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">954</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                (libexecdir) ? libexecdir : &quot;(not defined)&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">955</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">956</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        run_from_inetd = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">957</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        foreground = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">958</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">959</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">960</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (gatekeeperhome)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">961</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">962</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        setenv(&quot;GLOBUS_LOCATION&quot;,gatekeeperhome,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">963</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">964</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">965</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    setenv(&quot;GRIDMAP&quot;, genfilename(gatekeeperhome,gridmap,NULL),1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">966</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">967</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (x509_cert_dir)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">968</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">969</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;X509_CERT_DIR&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">970</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               genfilename(gatekeeperhome,x509_cert_dir,NULL),</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">971</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">972</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">973</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (x509_cert_file)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">974</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">975</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;X509_CERT_FILE&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">976</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               genfilename(gatekeeperhome,x509_cert_file,NULL),</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">977</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">978</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">979</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (x509_user_proxy)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">980</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">981</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;X509_USER_PROXY&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">982</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               genfilename(gatekeeperhome,x509_user_proxy,NULL),</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">983</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">984</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">985</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">986</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (x509_user_cert)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">987</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">988</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;X509_USER_CERT&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">989</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               genfilename(gatekeeperhome,x509_user_cert,NULL),</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">990</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">991</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">992</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (x509_user_key)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">993</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">994</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;X509_USER_KEY&quot;, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">995</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               genfilename(gatekeeperhome,x509_user_key,NULL),</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">996</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">997</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">998</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (krb5flag) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">999</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1000</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;GLOBUSKMAP&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1001</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               genfilename(gatekeeperhome,globuskmap,NULL),</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1002</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1003</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1004</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1005</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (run_from_inetd)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1006</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1007</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        (void) close(2);  /* dont want messages. logging will use fd=2 */ </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1008</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        (void) open(&quot;/dev/null&quot;,O_WRONLY);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1009</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1010</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1011</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (logging_startup() != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1012</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1013</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;Logging startup failure&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1014</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1015</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1016</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    notice4(LOG_INFO, &quot;%s pid=%d starting at %s&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1017</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            argv[0], getpid(), timestamp());</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1018</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1019</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1020</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Setup SIGCHLD signal handler to reap processes that we create</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1021</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1022</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1023</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        struct sigaction act;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1024</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        act.sa_handler = reaper;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1025</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        sigemptyset(&amp;act.sa_mask);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1026</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        sigaddset(&amp;act.sa_mask, SIGCHLD);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1027</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        act.sa_flags = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1028</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        sigaction(SIGCHLD, &amp;act, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1029</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        if (!run_from_inetd)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1030</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1031</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            act.sa_handler = terminate;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1032</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            sigemptyset(&amp;act.sa_mask);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1033</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            sigaddset(&amp;act.sa_mask, SIGTERM);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1034</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            act.sa_flags = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1035</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            sigaction(SIGTERM, &amp;act, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1036</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1037</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">	act.sa_handler = rotatelog;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1038</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">	sigemptyset(&amp;act.sa_mask);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1039</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">	sigaddset(&amp;act.sa_mask, SIGUSR1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1040</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">	act.sa_flags = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1041</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">	sigaction(SIGUSR1, &amp;act, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1042</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1043</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1044</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (run_from_inetd)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1045</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1046</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        logging_phase2();</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1047</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        dup2(2,1); /* point stdout at log as well */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1048</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1049</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1050</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1051</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Always make stdout unbuffered: otherwise the fclose(stdout)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1052</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * in doit() will flush any buffered output again and again!</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1053</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1054</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    setbuf(stdout,NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1055</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1056</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* Get the GSS credential for the accepter</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1057</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * If not run_from_inetd we can prompt here.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1058</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * If we are running as a deamon, and should not</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1059</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * have any prompts</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1060</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1061</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    major_status = globus_gss_assist_acquire_cred_ext(&amp;minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1062</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                      desired_name_char,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1063</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                      GSS_C_INDEFINITE,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1064</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                      GSS_C_NO_OID_SET,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1065</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                      GSS_C_ACCEPT,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1066</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                      &amp;credential_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1067</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                      NULL,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1068</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                      NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1069</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1070</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (major_status != GSS_S_COMPLETE)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1071</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1072</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        globus_gss_assist_display_status(stderr,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1073</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         &quot;GSS failed getting server credentials: &quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1074</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         major_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1075</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1076</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1077</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1078</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;GSS failed to get server credentials\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1079</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1080</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1081</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if (gatekeeper_test) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1082</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1083</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        fprintf(stderr,&quot;Gatekeeper subject name  : \&quot;%s\&quot;\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1084</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                get_globusid());</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1085</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        fprintf(stderr,&quot;Gatekeeper test complete : Success!\n\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1086</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        fprintf(stderr,&quot;Gatekeeper shutting down!\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1087</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        exit(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1088</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1089</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1090</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1091</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char hostname[255];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1092</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char *globusid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1093</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        struct hostent *hp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1094</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char *fqdn;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1095</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char * contact_string;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1096</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">      </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1097</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">        gethostname(hostname, sizeof(hostname)-1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1098</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">      </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1099</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">        if ((hp = gethostbyname(hostname)))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1100</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1101</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">            fqdn = (char *) hp-&gt;h_name;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1102</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1103</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1104</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1105</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            fqdn = (hostname ? hostname : &quot;HOSTNAME&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1106</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1107</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">      </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1108</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">        globusid = get_globusid();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1109</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1110</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1111</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">        if (!run_from_inetd)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1112</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1113</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">            logging_phase2(); /* now set stderr to logfile after gss prompts */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1114</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1115</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">            net_setup_listener(2, &amp;daemon_port, &amp;listener_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1116</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">          </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1117</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#         if defined(TARGET_ARCH_CRAYT3E)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1118</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1119</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                if(gatekeeper_uid == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1120</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1121</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    set_unicos_sockopts(listener_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1122</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1123</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1124</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#         endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1125</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1126</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">      </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1127</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* ajr,vs --changed printf to sprintf, and added setenv</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1128</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * This is considered to be a temporary change */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1129</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">        if ((contact_string = (char *)malloc(strlen(fqdn) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1130</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                             + strlen(globusid) + 40))) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1131</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1132</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1133</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">            sprintf(contact_string, &quot;%s:%d:%s&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1134</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    fqdn, daemon_port, globusid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1135</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">            if (!run_from_inetd)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1136</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                printf(&quot;GRAM contact: %s\n&quot;, contact_string);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1137</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">            setenv(&quot;GLOBUS_GATEKEEPER_CONTACT_STRING&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1138</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                   contact_string,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1139</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                   1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1140</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1141</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">            if (!run_from_inetd &amp;&amp; strlen(contact_string)&lt;sizeof(tmpbuf)-15)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1142</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                notice2(LOG_INFO, &quot;GRAM contact: %s\n&quot;, contact_string);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1143</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1144</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">            free(contact_string);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1145</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1146</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">        free(globusid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1147</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1148</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1149</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    new_acct_file();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1150</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1151</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    if (run_from_inetd)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1152</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1153</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        (void) setsid();</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1154</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        doit();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1155</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1156</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1157</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1158</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">        if (!foreground)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1159</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1160</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1161</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">             * Fork off a child, terminate the parent, and detach</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1162</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">             * the child from the tty.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1163</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">             */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1164</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            if (fork())</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1165</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                exit(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1166</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1167</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    gatekeeper_pid = getpid();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1168</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1169</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            if (!logging_usrlog)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1170</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1171</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                (void) close(2); /* close stderr as well */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1172</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		(void) open(&quot;/dev/null&quot;,O_WRONLY);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1173</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1174</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1175</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            (void) close(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1176</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            (void) close(1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1177</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1178</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#           if (defined(SYSV) || \</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1179</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                defined(__hpux) || \</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1180</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                defined(CRAY) || \</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1181</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                defined(TARGET_ARCH_CYGWIN))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1182</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1183</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1184</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                char fname[256];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1185</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1186</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                /* mod here (variable &quot;fname&quot;) no longer in use. --milne */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1187</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                sprintf(fname, &quot;/dev/console&quot;); </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1188</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                fd = open (fname, O_RDWR);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1189</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                notice2(0, &quot;open dev console fd = %d\n&quot;, fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1190</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                if (fd &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1191</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1192</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    sprintf(fname, &quot;/dev/tty&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1193</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    fd = open (fname, O_RDWR);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1194</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1195</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                notice2(0, &quot;open dev tty fd = %d\n&quot;, fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1196</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                if (fd &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1197</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1198</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    sprintf(fname, &quot;/dev/null&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1199</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    fd = open (fname, O_RDWR);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1200</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1201</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                notice3(0, &quot;open %s fd = %d\n&quot;, fname, fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1202</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                (void) dup2(2, 1); /* point out at stderr or log */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1203</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1204</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#               if HAVE_SETSID</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1205</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                (void) setsid();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1206</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#               endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1207</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                (void) setpgrp();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1208</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1209</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#           else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1210</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1211</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                (void) open(&quot;/dev/null&quot;, O_RDONLY);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1212</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                (void) dup2(2, 1); /* point stdout to stderr */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1213</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                fd = open(&quot;/dev/tty&quot;, O_RDWR);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1214</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                if (fd &gt;= 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1215</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1216</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                    ioctl(fd, TIOCNOTTY, 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1217</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                    (void) close(fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1218</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1219</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1220</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#           endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1221</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1222</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1223</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* stderr is either the logfile, the users stderr or the /dev/null */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1224</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* stdout is either the logfile, the users stdout or the /dev/null */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1225</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1226</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        while (1)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1227</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1228</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">            connection_fd = net_accept(listener_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1229</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">	    reqnr++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1230</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1231</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">            pid = fork();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1232</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1233</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">            if (pid &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1234</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1235</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                failure2(FAILED_SERVER, &quot;Fork failed: %s\n&quot;, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1236</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1237</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1238</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">            if (pid == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1239</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1240</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                (void) setsid();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1241</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#               if defined(__hpux) || defined(TARGET_ARCH_SOLARIS)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1242</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1243</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    (void) setpgrp();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1244</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1245</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#               else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1246</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1247</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                    ttyfd = open(&quot;/dev/tty&quot;,O_RDWR);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1248</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                    if (ttyfd &gt;= 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1249</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1250</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#                       if !defined(CRAY) &amp;&amp; !defined(TARGET_ARCH_CYGWIN)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1251</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1252</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                            ioctl(ttyfd, TIOCNOTTY, 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1253</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1254</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#                       endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1255</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                        close(ttyfd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1256</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1257</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1258</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#               endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1259</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1260</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                fclose(stdin); /* take care of stream buffers too */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1261</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                close(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1262</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                close(listener_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1263</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                listener_fd = -1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1264</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1265</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                dup2(connection_fd, 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1266</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                /* this should work, but not sure !? */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1267</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                /* Reports say it is needed on some systems */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1268</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                *stdin = *fdopen(0,&quot;r&quot;); /* reopen stdin  we need this since */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1269</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">                doit();</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1270</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">                exit(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1271</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1272</td>
          <td class="coverageCount">61364</td>
          <td class="srcCell"><span class="srcLine">            close(connection_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1273</td>
          <td class="coverageCount">61364</td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1274</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1275</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1276</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    rc = globus_module_deactivate(GLOBUS_GSI_GSS_ASSIST_MODULE);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1277</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    if(rc != GLOBUS_SUCCESS)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1278</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1279</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        exit(1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1280</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1281</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1282</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">    return 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1283</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1284</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1285</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1286</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1287</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       doit()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1288</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    Assume stdin is connected to the socket.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1289</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                usrlog_fp is set to the logfile.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1290</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                Authenticate the client, create the child process, and pass</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1291</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                the data on to the child process via its stdin. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1292</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1293</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1294</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1295</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void doit()</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1296</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1297</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                                 p1[2];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1298</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    int                                 pid = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1299</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                                 n;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1300</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                                 i;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1301</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                                 service_uid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1302</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                                 service_gid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1303</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                                 close_on_exec_read_fd;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1304</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                                 close_on_exec_write_fd;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1305</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char                                buf[1024];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1306</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              s;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1307</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char **                             args;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1308</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              argnp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1309</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              execp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1310</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char **                             argi;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1311</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    int                                 num_service_args = SERVICE_ARGS_MAX;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1312</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              service_args[SERVICE_ARGS_MAX];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1313</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                                 num_service_options =</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1314</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">        SERVICE_OPTIONS_MAX;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1315</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              service_options[SERVICE_OPTIONS_MAX];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1316</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    int                                 service_option_local_cred = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1317</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    int                                 service_option_stderr_log = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1318</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    int                                 service_option_accept_limited = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1319</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    unsigned char                       int_buf[4];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1320</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    struct stat                         statbuf;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1321</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    char *                              service_line = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1322</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              service_path;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1323</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              gram_k5_path; </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1324</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    struct sockaddr_in                  peer;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1325</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    netlen_t                            peerlen;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1326</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              peernum;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1327</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              x509_delegate;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1328</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    size_t                              length;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1329</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              http_message;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1330</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    size_t                              http_length;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1331</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              http_body;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1332</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    FILE *                              http_body_file;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1333</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* GSSAPI assist variables */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1334</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    OM_uint32                           major_status = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1335</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    OM_uint32                           minor_status = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1336</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    int                                 token_status = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1337</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    OM_uint32                           ret_flags = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1338</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    gss_buffer_desc                     context_token = GSS_C_EMPTY_BUFFER;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1339</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if 0</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1340</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    gss_buffer_desc                     option_token = GSS_C_EMPTY_BUFFER;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1341</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    gss_OID_set_desc                    extension_oids;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1342</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1343</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    FILE *                              context_tmpfile = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1344</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1345</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* Authorization variables */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1346</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                                 rc;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1347</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    globus_result_t                     result;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1348</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char *                              client_name;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1349</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char                                identity_buffer[256];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1350</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    char *                              userid = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1351</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    struct passwd *                     pw;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1352</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    char *                              mapping = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1353</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1354</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1355</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* Now do stdout, so it points at the socket too */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1356</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* needed for the grid-services */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1357</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1358</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    fclose(stdout);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1359</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    close(1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1360</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    dup2(0,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1361</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    *stdout = *fdopen(1,&quot;w&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1362</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    (void) setbuf(stdout,NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1363</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1364</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(TARGET_ARCH_CRAYT3E)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1365</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    if(gatekeeper_uid == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1366</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1367</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        get_unicos_connect_info(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1368</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1369</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1370</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1371</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    peerlen = sizeof(peer);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1372</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    if (getpeername(0, (struct sockaddr *) &amp;peer, &amp;peerlen) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1373</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1374</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">        if (peer.sin_family == AF_INET)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1375</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">            peernum = inet_ntoa(peer.sin_addr);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1376</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        else</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1377</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            peernum = &quot;&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1378</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1379</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1380</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    fdout = fdopen(dup(0),&quot;w&quot;); /* establish an output stream */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1381</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    setbuf(fdout,NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1382</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1383</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    notice3(LOG_INFO, &quot;Got connection %s at %s&quot;, peernum, timestamp());</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1384</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1385</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifdef TARGET_ARCH_CRAYT3E</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1386</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* Need to lookup hostname -- provide for use in udb updates. */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1387</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1388</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        struct sockaddr_in from;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1389</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        int fromlen;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1390</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        struct hostent *hp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1391</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char hostname[256];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1392</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1393</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* Get IP address of client. */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1394</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        fromlen = sizeof(from);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1395</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        memset(&amp;from, 0, sizeof(from));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1396</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        if (getpeername(connection_fd, (struct sockaddr *)&amp;from,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1397</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &amp;fromlen) &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1398</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1399</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            notice2(LOG_ERR,&quot;getpeername failed: %.100s&quot;, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1400</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            strcpy(hostname, &quot;UNKNOWN&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1401</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1402</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1403</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1404</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            /* Map the IP address to a host name. */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1405</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            hp = gethostbyaddr((char *)&amp;from.sin_addr, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1406</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                               sizeof(struct in_addr), from.sin_family);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1407</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            if (hp)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1408</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                strncpy(hostname, hp-&gt;h_name, sizeof(hostname));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1409</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1410</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                strncpy(hostname, inet_ntoa(from.sin_addr), sizeof(hostname));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1411</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1412</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1413</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        set_connection_hostname (hostname);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1414</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1415</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif /* TARGET_ARCH_CRAYT3E */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1416</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1417</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* Do gss authentication here */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1418</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1419</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1420</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * if globus nologin is set, error message and exit</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1421</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1422</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1423</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    if (stat(genfilename(gatekeeperhome,&quot;etc&quot;,globusnologin),</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1424</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">             &amp;statbuf) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1425</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1426</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_NOLOGIN, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1427</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                &quot;Not accepting connections at this time&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1428</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1429</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1430</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    if (stat(genfilename(gatekeeperhome,&quot;var&quot;,globusnologin),</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1431</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">             &amp;statbuf) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1432</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1433</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_NOLOGIN, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1434</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                &quot;Not accepting connections at this time&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1435</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1436</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1437</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* We will use the assist functions here since we </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1438</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * don&#39;t need any special processing</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1439</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1440</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1441</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if 0</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1442</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    extension_oids.elements = (gss_OID) gss_restrictions_extension;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1443</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    extension_oids.count = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1444</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1445</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    option_token.value = (void *) &amp;extension_oids;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1446</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1447</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* don&#39;t use this code until we require CAS for the gatekeeper */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1448</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    major_status = gss_set_sec_context_option(</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1449</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        &amp;minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1450</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        &amp;context_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1451</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        (gss_OID) GSS_APPLICATION_WILL_HANDLE_EXTENSIONS,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1452</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        &amp;option_token);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1453</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1454</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    if (major_status != GSS_S_COMPLETE &amp;&amp; major_status != GSS_S_EXT_COMPAT)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1455</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1456</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        if (logging_usrlog) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1457</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1458</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            globus_gss_assist_display_status(usrlog_fp,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1459</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                             &quot;GSS authentication failure &quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1460</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                             major_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1461</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                             minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1462</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                             token_status);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1463</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1464</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1465</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        failure4(FAILED_AUTHENTICATION,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1466</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &quot;GSS failed Major:%8.8x Minor:%8.8x Token:%8.8x\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1467</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 major_status,minor_status,token_status);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1468</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1469</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1470</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1471</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1472</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * We will not accept limited proxies for authentication, as</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1473</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * they may have been stolen. This enforces part of the </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1474</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Globus security policy.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1475</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * This check will be made later, after the service is</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1476</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * is determined. This is done to allow limited proxies</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1477</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * to be used for some services, like GARA</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1478</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1479</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1480</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    major_status = globus_gss_assist_accept_sec_context(</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1481</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        &amp;minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1482</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        &amp;context_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1483</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        credential_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1484</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        &amp;client_name,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1485</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        &amp;ret_flags,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1486</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        NULL,            /* don&#39;t need user_to_user */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1487</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        &amp;token_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1488</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        &amp;delegated_cred_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1489</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        globus_gss_assist_token_get_fd,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1490</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        (void *)stdin,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1491</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        globus_gss_assist_token_send_fd,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1492</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        (void *)fdout);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1493</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1494</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    if (major_status != GSS_S_COMPLETE)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1495</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1496</td>
          <td class="coverageCount">8</td>
          <td class="srcCell"><span class="srcLine">        if (logging_usrlog) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1497</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1498</td>
          <td class="coverageCount">8</td>
          <td class="srcCell"><span class="srcLine">            globus_gss_assist_display_status(usrlog_fp,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1499</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                             &quot;GSS authentication failure &quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1500</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                             major_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1501</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                             minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1502</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                             token_status);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1503</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1504</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1505</td>
          <td class="coverageCount">8</td>
          <td class="srcCell"><span class="srcLine">        failure4(FAILED_AUTHENTICATION,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1506</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &quot;GSS failed Major:%8.8x Minor:%8.8x Token:%8.8x\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1507</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 major_status,minor_status,token_status);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1508</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1509</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1510</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* now OK to send wrapped error message */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1511</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">    ok_to_send_errmsg = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1512</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1513</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* client_name is the globusID of the client, we need to check </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1514</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * the gridmap file to see which local ID this is and if the</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1515</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * the user is authorized.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1516</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1517</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1518</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">    notice2(LOG_NOTICE, &quot;Authenticated globus user: %s&quot;, client_name);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1519</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1520</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* End of authentication */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1521</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1522</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1523</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Read from the client the service it would like to use</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1524</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * For now this is a null terminated string which has been</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1525</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * wrapped.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1526</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1527</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1528</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1529</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * read HTTP message, extract service name from the header.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1530</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1531</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">    major_status = globus_gss_assist_get_unwrap(&amp;minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1532</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                context_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1533</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                &amp;http_message,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1534</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                &amp;http_length,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1535</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                &amp;token_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1536</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                globus_gss_assist_token_get_fd,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1537</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                stdin,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1538</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                logging_usrlog?usrlog_fp:NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1539</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1540</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">    if (major_status != GSS_S_COMPLETE)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1541</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1542</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure4(FAILED_SERVICELOOKUP,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1543</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &quot;Reading incoming message GSS failed Major:%8.8x &quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1544</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &quot;Minor:%8.8x Token:%8.8x\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1545</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 major_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1546</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1547</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 token_status);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1548</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1549</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1550</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">    if (http_message != NULL) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1551</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1552</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">        null_terminate_string(&amp;http_message, http_length);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1553</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1554</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1555</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">    for (length=0; length&lt;http_length &amp;&amp; http_message[length]!=&#39;\n&#39;; length++)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1556</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        ;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1557</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1558</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">    if ((length==0) || (length&gt;=http_length))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1559</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1560</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure2(FAILED_SERVICELOOKUP,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1561</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &quot;Incoming message has invalid first-line length %ld\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1562</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 (long) length);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1563</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1564</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1565</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1566</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">        char    save = http_message[length];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1567</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">        char *  tmpbuf = (char *) malloc(length);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1568</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char *  p;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1569</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1570</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">        http_message[length] = &#39;\0&#39;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1571</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">        if ((1 != sscanf(http_message, &quot;POST %s&quot;, tmpbuf)) ||</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1572</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            (! (p = strchr(tmpbuf, &#39;/&#39;))))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1573</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1574</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            failure(FAILED_SERVICELOOKUP, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1575</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;Unable to extract service name from incoming message\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1576</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1577</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">        http_message[length] = save;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1578</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1579</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">        if (strncmp(tmpbuf,&quot;ping/&quot;,5)==0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1580</td>
          <td class="coverageCount">33</td>
          <td class="srcCell"><span class="srcLine">            got_ping_request = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1581</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1582</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">        if ((mapping = strchr(tmpbuf, &#39;@&#39;)) != NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1583</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1584</td>
          <td class="coverageCount">6</td>
          <td class="srcCell"><span class="srcLine">            *mapping = &#39;\0&#39;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1585</td>
          <td class="coverageCount">6</td>
          <td class="srcCell"><span class="srcLine">            mapping = strdup(++mapping);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1586</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1587</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1588</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">        service_name = strdup(++p);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1589</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">        free(tmpbuf);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1590</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1591</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1592</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1593</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Cook up a unique ID such that we can link the GSI info logged by</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1594</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * the Gatekeeper to the batch system info logged by the Job Manager.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1595</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1596</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1597</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	time_t       clock;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1598</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	struct tm  * tmp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1599</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">	const char * gk_jm_id_var = &quot;GATEKEEPER_JM_ID&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1600</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	char         gatekeeper_jm_id[64];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1601</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1602</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">	time(&amp;clock);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1603</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">	tmp = localtime(&amp;clock);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1604</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1605</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">	sprintf(gatekeeper_jm_id, &quot;%04d-%02d-%02d.%02d:%02d:%02d.%010u.%010u&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1606</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    tmp-&gt;tm_year + 1900, tmp-&gt;tm_mon + 1, tmp-&gt;tm_mday,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1607</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    tmp-&gt;tm_hour, tmp-&gt;tm_min, tmp-&gt;tm_sec,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1608</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    gatekeeper_pid &amp; 0xFFFFFFFF, reqnr &amp; 0xFFFFFFFF);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1609</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1610</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">	setenv(gk_jm_id_var, gatekeeper_jm_id, 1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1611</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">	setenv(&quot;GATEKEEPER_PEER&quot;, peernum, 1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1612</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1613</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">	notice5(0, &quot;%s %s for %s on %s&quot;, gk_jm_id_var, gatekeeper_jm_id,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1614</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    client_name, peernum);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1615</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1616</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1617</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1618</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * now that we know the desired service, do authorization</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1619</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * i.e. globus userid must be in the in the gridmap file. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1620</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1621</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1622</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">    result = globus_gss_assist_map_and_authorize(context_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1623</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                 service_name,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1624</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                 mapping,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1625</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                                 identity_buffer, 256);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1626</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1627</td>
          <td class="coverageCount">669</td>
          <td class="srcCell"><span class="srcLine">    if (result != GLOBUS_SUCCESS)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1628</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1629</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        globus_object_t *               error;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1630</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        char *                          error_message = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1631</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1632</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        error = globus_error_get(result);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1633</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        error_message = globus_error_print_friendly(error);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1634</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        globus_object_free(error);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1635</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        failure2(FAILED_AUTHORIZATION,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1636</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &quot;globus_gss_assist_gridmap() failed authorization.&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1637</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &quot; %s\n&quot;, error_message);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1638</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1639</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    else if (mapping != NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1640</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1641</td>
          <td class="coverageCount">4</td>
          <td class="srcCell"><span class="srcLine">        strncpy(&amp;identity_buffer[0], mapping, sizeof(identity_buffer));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1642</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1643</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1644</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    userid = identity_buffer;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1645</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1646</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifdef TARGET_ARCH_CRAYT3E</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1647</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    if (gatekeeper_uid == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1648</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1649</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        get_udbent(userid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1650</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        if (unicos_access_denied())</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1651</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1652</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            failure2(FAILED_AUTHORIZATION,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1653</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                     &quot;UNICOS denied access to user %s.&quot;, userid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1654</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1655</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1656</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif /* TARGET_ARCH_CRAYT3E */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1657</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1658</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* find body of message and forward it to the service */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1659</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1660</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">        char *  end_of_header = &quot;\015\012\015\012&quot;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1661</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        int     content_length;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1662</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1663</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">        http_body = strstr(http_message, end_of_header);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1664</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1665</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">        if (!http_body)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1666</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1667</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            failure(FAILED_SERVER, &quot;Could not find http message body&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1668</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1669</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1670</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">        content_length = get_content_length(http_message, http_body);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1671</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1672</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">        http_body += 4;  /* CR LF CR LF */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1673</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1674</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">        if (! got_ping_request)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1675</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1676</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">            http_body_file = tmpfile();</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1677</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">            if (http_body_file)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1678</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1679</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                size_t body_length;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1680</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1681</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">                setbuf(http_body_file,NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1682</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">                fcntl(fileno(http_body_file), F_SETFD, 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1683</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">                sprintf(buf, &quot;%d&quot;, fileno(http_body_file));</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1684</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">                setenv(&quot;GRID_SECURITY_HTTP_BODY_FD&quot;, buf, 1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1685</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">                notice2(0,&quot;GRID_SECURITY_HTTP_BODY_FD=%s&quot;,buf);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1686</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1687</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">                body_length = (size_t)(&amp;http_message[http_length] - http_body);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1688</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1689</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                do</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1690</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1691</td>
          <td class="coverageCount">674</td>
          <td class="srcCell"><span class="srcLine">                    fwrite(http_body,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1692</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                           1,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1693</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                           body_length,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1694</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                           http_body_file);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1695</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1696</td>
          <td class="coverageCount">674</td>
          <td class="srcCell"><span class="srcLine">                    if((content_length &gt; 0) &amp;&amp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1697</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                            ((content_length -= body_length) &gt; 0))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1698</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1699</td>
          <td class="coverageCount">40</td>
          <td class="srcCell"><span class="srcLine">                        free(http_message);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1700</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1701</td>
          <td class="coverageCount">40</td>
          <td class="srcCell"><span class="srcLine">                        major_status = globus_gss_assist_get_unwrap(</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1702</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                &amp;minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1703</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                context_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1704</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                &amp;http_message,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1705</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                &amp;http_length,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1706</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                &amp;token_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1707</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                globus_gss_assist_token_get_fd,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1708</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                stdin,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1709</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                logging_usrlog?usrlog_fp:NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1710</td>
          <td class="coverageCount">40</td>
          <td class="srcCell"><span class="srcLine">                        if (major_status != GSS_S_COMPLETE)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1711</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1712</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                            failure4(FAILED_SERVICELOOKUP,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1713</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                     &quot;Reading incoming message GSS failed &quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1714</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                     &quot;Major:%8.8x &quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1715</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                     &quot;Minor:%8.8x Token:%8.8x\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1716</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                     major_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1717</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                     minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1718</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                     token_status);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1719</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1720</td>
          <td class="coverageCount">40</td>
          <td class="srcCell"><span class="srcLine">                        null_terminate_string(&amp;http_message, http_length);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1721</td>
          <td class="coverageCount">40</td>
          <td class="srcCell"><span class="srcLine">                        http_body = http_message;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1722</td>
          <td class="coverageCount">40</td>
          <td class="srcCell"><span class="srcLine">                        body_length = http_length;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1723</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1724</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1725</td>
          <td class="coverageCount">674</td>
          <td class="srcCell"><span class="srcLine">                while(content_length &gt; 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1726</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1727</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">                lseek(fileno(http_body_file), 0, SEEK_SET);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1728</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1729</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1730</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1731</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                failure(FAILED_SERVER, &quot;Unable to create http body tmpfile&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1732</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1733</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1734</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1735</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1736</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    free(http_message);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1737</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    length = strlen(service_name);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1738</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1739</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    if (length &gt; 256)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1740</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1741</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVICELOOKUP, &quot;Service name malformed&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1742</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1743</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1744</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    notice3(LOG_NOTICE,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1745</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            &quot;Requested service: %s %s&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1746</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            service_name,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1747</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            (got_ping_request) ? &quot;[PING ONLY]&quot; : &quot;&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1748</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1749</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* Don&#39;t allow the client to look for service files outside of the </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1750</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * service directory</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1751</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1752</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    if (strchr(service_name, &#39;/&#39;) != NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1753</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1754</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure2(FAILED_SERVICELOOKUP, &quot;Invalid service name %s&quot;, service_name);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1755</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1756</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1757</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    if ((rc = globus_gatekeeper_util_globusxmap(</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1758</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		genfilename(gatekeeperhome,grid_services,service_name), </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1759</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		NULL, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1760</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		&amp;service_line)) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1761</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">      {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1762</td>
          <td class="coverageCount">4</td>
          <td class="srcCell"><span class="srcLine">	    failure3(FAILED_SERVICELOOKUP,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1763</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		     &quot;Failed to find requested service: %s: %d&quot;, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1764</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		     service_name, rc);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1765</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">      }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1766</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1767</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1768</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Parse the command line.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1769</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */ </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1770</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1771</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    if (globus_gatekeeper_util_tokenize(service_line,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1772</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                        service_args, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1773</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                        &amp;num_service_args,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1774</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                        &quot; \t\n&quot;))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1775</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1776</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        notice(LOG_ERR, &quot;ERROR:Tokenize failed for services&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1777</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;ERROR: gatekeeper misconfigured&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1778</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1779</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1780</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    if (num_service_args &lt; SERVICE_ARG0_INDEX)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1781</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1782</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        notice(LOG_ERR, &quot;ERROR:To few service arguments&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1783</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;ERROR: gatekeeper misconfigured&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1784</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1785</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1786</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* now check for options */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1787</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    if (globus_gatekeeper_util_tokenize(</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1788</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            service_args[SERVICE_OPTIONS_INDEX],</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1789</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            service_options,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1790</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            &amp;num_service_options,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1791</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            &quot;,&quot;))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1792</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1793</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        notice(LOG_ERR, &quot;ERROR:Tokenize failed for services options&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1794</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;ERROR: gatekeeper misconfigured&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1795</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1796</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1797</td>
          <td class="coverageCount">1989</td>
          <td class="srcCell"><span class="srcLine">    for (i = 0; i &lt; num_service_options; i++)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1798</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1799</td>
          <td class="coverageCount">1326</td>
          <td class="srcCell"><span class="srcLine">        if (strcmp(service_options[i], &quot;local_cred&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1800</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1801</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">            service_option_local_cred = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1802</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1803</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">        else if (strcmp(service_options[i], &quot;stderr_log&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1804</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1805</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">            service_option_stderr_log = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1806</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1807</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if (strcmp(service_options[i], &quot;accept_limited&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1808</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1809</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            service_option_accept_limited = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1810</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1811</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        else if (strcmp(service_options[i], &quot;-&quot;) == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1812</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1813</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1814</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1815</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1816</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            notice2(LOG_ERR, &quot;ERROR:Invalid service option %s&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1817</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    service_options[i]);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1818</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            failure(FAILED_SERVER, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1819</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                    &quot;ERROR: gatekeeper misconfigured&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1820</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1821</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1822</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1823</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1824</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * most services will not acceot a limited proxy</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1825</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * for authentication. We will check now. This</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1826</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * only works with the Globus GSSAPI but is a noop</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1827</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * for the Kerberos GSSAPI</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1828</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1829</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#ifdef GSS_C_GLOBUS_LIMITED_PROXY_FLAG</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1830</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    if ((service_option_accept_limited == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1831</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        &amp;&amp; (ret_flags &amp; GSS_C_GLOBUS_LIMITED_PROXY_FLAG))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1832</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1833</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_AUTHORIZATION, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1834</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                &quot;Attempt to use limited proxy for service&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1835</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1836</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1837</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1838</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1839</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1840</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1841</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Either run as the userid from the globus map,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1842</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     *  or from grid_service as a selected user</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1843</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1844</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1845</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    if (strcmp(service_args[SERVICE_USER_INDEX],&quot;-&quot;))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1846</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1847</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        userid = service_args[SERVICE_USER_INDEX];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1848</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1849</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1850</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    notice2(LOG_NOTICE, &quot;Authorized as local user: %s&quot;, userid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1851</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1852</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    if ((pw = getpwnam(userid)) == NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1853</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1854</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure2(FAILED_SERVER, &quot;getpwname() failed to find %s&quot;,userid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1855</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1856</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1857</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    service_uid = pw-&gt;pw_uid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1858</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   if defined(TARGET_ARCH_CRAYT3E)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1859</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1860</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        service_gid = unicos_get_gid();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1861</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1862</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1863</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1864</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">        service_gid = pw-&gt;pw_gid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1865</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1866</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#   endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1867</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1868</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    notice2(LOG_NOTICE, &quot;Authorized as local uid: %d&quot;, service_uid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1869</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    notice2(LOG_NOTICE, &quot;          and local gid: %d&quot;, service_gid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1870</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1871</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1872</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * service existed, we were authorized to use it. ping was successful.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1873</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1874</td>
          <td class="coverageCount">663</td>
          <td class="srcCell"><span class="srcLine">    if (got_ping_request)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1875</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1876</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if 0</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1877</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char *     proxyfile;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1878</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        int        fd, i;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1879</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        size_t     len, bufsize;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1880</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1881</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1882</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * DEE this is no longer needed as the delegated cred is</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1883</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * returned, and proxy is still in memory</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1884</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * failure will cleanup the delegated cred. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1885</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1886</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        if ( ((proxyfile = getenv(&quot;X509_USER_DELEG_PROXY&quot;)) != NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1887</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">             &amp;&amp; ((fd = open(proxyfile, O_RDWR, 0600) &gt;= 0))  )</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1888</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1889</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            len = lseek(fd, 0, SEEK_END);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1890</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            lseek(fd, 0, SEEK_SET);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1891</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            bufsize = sizeof(tmpbuf);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1892</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            for (i=0; i&lt;bufsize; i++)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1893</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                tmpbuf[i] = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1894</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1895</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            for (i=0; i&lt;len; )</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1896</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                i += write(fd, tmpbuf, MIN(bufsize, len-i));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1897</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1898</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            close(fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1899</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            unlink(proxyfile);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1900</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1901</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1902</td>
          <td class="coverageCount">29</td>
          <td class="srcCell"><span class="srcLine">        failure(FAILED_PING, &quot;ping successful&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1903</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1904</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1905</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (delegated_cred_handle)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1906</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1907</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        gss_buffer_desc                 deleg_proxy_filename;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1908</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1909</td>
          <td class="coverageCount">630</td>
          <td class="srcCell"><span class="srcLine">        major_status = gss_export_cred(&amp;minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1910</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                       delegated_cred_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1911</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                       NULL,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1912</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                       1,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1913</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                       &amp;deleg_proxy_filename);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1914</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1915</td>
          <td class="coverageCount">630</td>
          <td class="srcCell"><span class="srcLine">        if (major_status == GSS_S_COMPLETE)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1916</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1917</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            char *                      cp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1918</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1919</td>
          <td class="coverageCount">630</td>
          <td class="srcCell"><span class="srcLine">            cp = strchr((char *)deleg_proxy_filename.value, &#39;=&#39;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1920</td>
          <td class="coverageCount">630</td>
          <td class="srcCell"><span class="srcLine">            *cp = &#39;\0&#39;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1921</td>
          <td class="coverageCount">630</td>
          <td class="srcCell"><span class="srcLine">            cp++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1922</td>
          <td class="coverageCount">630</td>
          <td class="srcCell"><span class="srcLine">            setenv((char *)deleg_proxy_filename.value, cp, 1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1923</td>
          <td class="coverageCount">630</td>
          <td class="srcCell"><span class="srcLine">            free(deleg_proxy_filename.value);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1924</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1925</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1926</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1927</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            char *                      error_str = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1928</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            globus_object_t *           error_obj;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1929</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1930</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            error_obj = globus_error_get((globus_result_t) minor_status);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1931</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1932</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            error_str = globus_error_print_friendly(error_obj);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1933</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            failure(FAILED_SERVER, error_str);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1934</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1935</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1936</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1937</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* for gssapi_ssleay if we received delegated proxy certificate</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1938</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * they will be in a file in tmp pointed at by the </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1939</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * X509_USER_DELEG_PROXY env variable. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1940</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * This will be owned by the current uid, we need this owned by</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1941</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * the user.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1942</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * for other gss, this is a noop, since X509_USER_DELEG_PROXY </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1943</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * should not be defined.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1944</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1945</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1946</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1947</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char *proxyfile;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1948</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">        if ((proxyfile = getenv(&quot;X509_USER_PROXY&quot;)) != NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1949</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1950</td>
          <td class="coverageCount">630</td>
          <td class="srcCell"><span class="srcLine">            chown(proxyfile,service_uid,service_gid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1951</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1952</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1953</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1954</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* For the Kerberos GSSAPI  prior to 1.1 with the mode to </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1955</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * src/lib/gssapi/krb5/accept_sec_context.c </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1956</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * to setenv KRB5CCNAME, the KRB5CCANME will be </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1957</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * owned by root, and we need to change the ownership. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1958</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1959</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1960</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char *ccname;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1961</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">        if ((ccname = getenv(&quot;KRB5CCNAME&quot;)) != NULL</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1962</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            &amp;&amp; strlen(ccname) &gt; 5 </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1963</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            &amp;&amp; !strncmp(ccname,&quot;FILE:&quot;,5))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1964</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1965</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            chown(ccname+5,service_uid,service_gid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1966</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1967</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1968</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1969</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    service_path = genfilename(libexecdir,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1970</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                               service_args[SERVICE_PATH_INDEX],NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1971</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1972</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1973</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Replace the unused arg0 much like wrapper does</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1974</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * generate a arg0 from the path later</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1975</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * arg0 is really only there since inetd.conf has it. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1976</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1977</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1978</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    service_args[SERVICE_ARG0_INDEX] = service_path; </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1979</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1980</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (stat(service_path, &amp;statbuf) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1981</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1982</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        notice2(LOG_ERR, &quot;ERROR: Cannot stat globus service %s.&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1983</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                service_path);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1984</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;ERROR: gatekeeper misconfigured&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1985</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1986</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1987</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (!(statbuf.st_mode &amp; 0111))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1988</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1989</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        notice2(LOG_ERR, &quot;ERROR: Cannot execute globus service %s.&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1990</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                service_path);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">1991</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;ERROR: gatekeeper misconfigured&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1992</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1993</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1994</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1995</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Start building the arg list. If the -k flag is set, we want</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1996</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * to exec GRAM_K5_EXE first, passing it the path and</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1997</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * args for the service. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1998</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * If run from inetd, then the executables will be in libexecdir</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">1999</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * otherwise they are in the current directory. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2000</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * we need absolute path, since we will do a chdir($HOME)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2001</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2002</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2003</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2004</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    gram_k5_path = genfilename(libexecdir, GRAM_K5_EXE, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2005</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2006</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* need k5 plus the number of args in the service_args + NULL */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2007</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* we will overlay the previous service arg to do this. */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2008</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* this should be the SERVICE_PATH_INDEX */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2009</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2010</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    args = &amp;service_args[SERVICE_ARG0_INDEX];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2011</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2012</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (krb5flag &amp;&amp; service_option_local_cred)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2013</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2014</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        args--;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2015</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#       ifdef TARGET_ARCH_CRAYT3E</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2016</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /*DEE Not sure what is not complient, maybe some one could</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2017</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * be more specific about this test</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2018</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2019</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2020</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            if(gatekeeper_uid == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2021</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2022</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                failure(FAILED_SERVER,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2023</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &quot;Gatekeeper Kerberos code is not UNICOS compliant.&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2024</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2025</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2026</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#       endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2027</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        if (stat(gram_k5_path, &amp;statbuf) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2028</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            failure2(FAILED_SERVER, &quot;Cannot stat %s&quot;,gram_k5_path);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2029</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        if (!(statbuf.st_mode &amp; 0111))</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2030</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            failure2(FAILED_SERVER, &quot;Cannot execute %s&quot;, gram_k5_path);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2031</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        *args = gram_k5_path;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2032</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2033</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2034</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    notice2(0, &quot;executing %s&quot;, args[0]);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2035</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2036</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2037</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Create two pipes to connect us to the servic:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2038</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     *   One is used with close-on-exec to sense child creation</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2039</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     *          and pass back any error messages from the child</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2040</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     *          to the parent.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2041</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     *DEE The above is obsolete, as gram_k5 gets execed next. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2042</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     *   One is connected to the child&#39;s stdin, for passing a</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2043</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     *          the message from the partent to the child.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2044</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2045</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2046</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (pipe(p1) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2047</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2048</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure2(FAILED_SERVER, &quot;Cannot create pipe: %s&quot;, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2049</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2050</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    close_on_exec_read_fd = p1[0];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2051</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    close_on_exec_write_fd = p1[1];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2052</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2053</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (fcntl(close_on_exec_write_fd, F_SETFD, 1) != 0 ||</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2054</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	fcntl(close_on_exec_read_fd, F_SETFD, 1) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2055</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2056</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure2(FAILED_SERVER, &quot;fcntl F_SETFD failed: %s&quot;, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2057</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2058</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2059</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    setenv(&quot;GLOBUS_ID&quot;,client_name,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2060</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    setenv(&quot;GRID_ID&quot;,client_name,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2061</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    setenv(&quot;GRID_AUTH_METHOD&quot;,&quot;TO_FILLED_IN_LATER&quot;,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2062</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2063</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2064</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * Become the appropriate user</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2065</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2066</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (gatekeeper_uid == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2067</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2068</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;USER&quot;,userid,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2069</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;LOGNAME&quot;,userid,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2070</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;LOGIN&quot;,userid,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2071</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;HOME&quot;,pw-&gt;pw_dir,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2072</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;SHELL&quot;,pw-&gt;pw_shell,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2073</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2074</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * Could set path, and other variables as well </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2075</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * Unset many of the gssapi set env variables. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2076</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * If not present won&#39;t hurt to unset. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2077</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * Leave the X509_CERT_DIR of trusted certs</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2078</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * for the user to use. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2079</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2080</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        unsetenv(&quot;GRIDMAP&quot;); /* unset it */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2081</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        unsetenv(&quot;GLOBUSCERTDIR&quot;); /* unset it */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2082</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        unsetenv(&quot;GLOBUSKEYDIR&quot;); /* unset it */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2083</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        unsetenv(&quot;X509_USER_KEY&quot;); /* unset it */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2084</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        unsetenv(&quot;X509_USER_CERT&quot;); /* unset it */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2085</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2086</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	/* SLANG - can&#39;t unset this, otherwise jobmanager won&#39;t know where to look. */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2087</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	/* unsetenv(&quot;X509_USER_PROXY&quot;); */ /* unset it  */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2088</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2089</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2090</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* for tranition, if gatekeeper has the path, set it</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2091</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * for the grid_services to use </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2092</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2093</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (jm_conf_path &amp;&amp; !strncmp(service_name,&quot;jobmanager&quot;,10))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2094</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2095</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;JM_CONF_PATH&quot;,jm_conf_path,1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2096</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    } </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2097</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2098</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * If the gssapi_ssleay did delegation, promote the</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2099</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * delegated proxy file to the user proxy file</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2100</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2101</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if ((x509_delegate = getenv(&quot;X509_USER_DELEG_PROXY&quot;)))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2102</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2103</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        setenv(&quot;X509_USER_PROXY&quot;,strdup(x509_delegate),1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2104</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        unsetenv(&quot;X509_USER_DELEG_PROXY&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2105</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2106</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2107</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2108</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * finally do environment variable substitution </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2109</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * on the args</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2110</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2111</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2112</td>
          <td class="coverageCount">1902</td>
          <td class="srcCell"><span class="srcLine">    for (argi = &amp;service_args[SERVICE_ARG1_INDEX]; *argi; argi++)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2113</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2114</td>
          <td class="coverageCount">1268</td>
          <td class="srcCell"><span class="srcLine">        if(globus_gatekeeper_util_envsub(argi))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2115</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2116</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            notice(LOG_ERR,&quot;ERROR: Failed env substitution in services&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2117</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            failure(FAILED_SERVER, &quot;ERROR: gatekeeper misconfigured&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2118</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2119</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2120</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2121</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2122</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (gatekeeper_uid == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2123</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2124</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2125</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* do all the work to run as user, unless gram_k5 will do it for us */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2126</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2127</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        if (!(krb5flag &amp;&amp; service_option_local_cred))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2128</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2129</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            char * errmsg = NULL;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2130</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            int rc;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2131</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            if ((rc = globus_gatekeeper_util_trans_to_user(pw, userid, &amp;errmsg)) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2132</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2133</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                failure3(FAILED_SERVER, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2134</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                         &quot;trans_to_user: %d: %s&quot;, rc, errmsg);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2135</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2136</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2137</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2138</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2139</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2140</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * export the security context which will destroy it. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2141</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * This will also destroy the ability to wrap any error</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2142</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * messages, so we do this very late. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2143</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * First we get an temp file, open it, and delete it. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2144</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2145</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2146</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    context_tmpfile = tmpfile();</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2147</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (context_tmpfile) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2148</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2149</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">        setbuf(context_tmpfile,NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2150</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">        fcntl(fileno(context_tmpfile), F_SETFD, 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2151</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">        sprintf(buf, &quot;%d&quot;, fileno(context_tmpfile));</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2152</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">        setenv(&quot;GRID_SECURITY_CONTEXT_FD&quot;, buf, 1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2153</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">        notice2(0,&quot;GRID_SECURITY_CONTEXT_FD=%s&quot;,buf);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2154</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2155</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2156</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2157</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;Unable to create context tmpfile&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2158</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2159</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2160</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    major_status = gss_export_sec_context(&amp;minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2161</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                          &amp;context_handle, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2162</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                          &amp;context_token);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2163</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2164</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (major_status != GSS_S_COMPLETE) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2165</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2166</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        globus_gss_assist_display_status(stderr,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2167</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         &quot;GSS failed exporting context: &quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2168</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         major_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2169</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2170</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                         0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2171</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;GSS Failed exporting context&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2172</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2173</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2174</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    int_buf[0] = (unsigned char)(((context_token.length)&gt;&gt;24)&amp;0xff);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2175</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    int_buf[1] = (unsigned char)(((context_token.length)&gt;&gt;16)&amp;0xff);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2176</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    int_buf[2] = (unsigned char)(((context_token.length)&gt;&gt; 8)&amp;0xff);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2177</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    int_buf[3] = (unsigned char)(((context_token.length)    )&amp;0xff);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2178</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2179</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (fwrite(int_buf,4,1,context_tmpfile) != 1)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2180</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2181</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;Failure writing context length&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2182</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2183</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (fwrite(context_token.value,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2184</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               context_token.length,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2185</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               1,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2186</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">               context_tmpfile) != 1)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2187</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2188</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;Failure writing context token&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2189</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2190</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2191</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    gss_release_buffer(&amp;minor_status,&amp;context_token);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2192</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2193</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* reposition so service can read */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2194</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2195</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    lseek(fileno(context_tmpfile), 0, SEEK_SET);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2196</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2197</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    chdir(pw-&gt;pw_dir);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2198</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2199</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if ( launch_method != DONT_FORK )</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2200</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2201</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">	pid = fork();</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2202</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">	if (pid &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2203</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2204</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    failure2(FAILED_SERVER, &quot;fork failed: %s&quot;, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2205</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2206</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2207</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2208</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (launch_method == DONT_FORK)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2209</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2210</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	notice2(0, &quot;Starting child %d&quot;, pid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2211</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2212</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2213</td>
          <td class="coverageCount">634</td>
          <td class="srcCell"><span class="srcLine">    if (pid == 0 || launch_method == DONT_FORK)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2214</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2215</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">        close(close_on_exec_read_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2216</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2217</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* stderr is still set to logfile, user&#39;s stderr or /dev/null */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2218</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2219</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2220</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * convert arg[0] to path and simple name for exec</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2221</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2222</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2223</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">        execp = args[0];</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2224</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">        argnp = strrchr(args[0], &#39;/&#39;); </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2225</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2226</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">        if (argnp)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2227</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">            argnp++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2228</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        else</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2229</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            argnp = execp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2230</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">        args[0] = argnp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2231</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2232</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2233</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * If grid_service wanted stderr pointing at our log </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2234</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * skip this part</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2235</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         * otherwise point it at the socket</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2236</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">         */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2237</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2238</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">        if (service_option_stderr_log == 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2239</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2240</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            fclose(stderr);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2241</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            close(2);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2242</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            dup2(0,2);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2243</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            *stderr = *fdopen(2,&quot;w&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2244</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            (void) setbuf(stderr,NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2245</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2246</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2247</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">        if (execv(execp, args) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2248</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2249</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            sprintf(tmpbuf, &quot;Exec failed: %s\n&quot;, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2250</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            write(close_on_exec_write_fd, tmpbuf, strlen(tmpbuf));</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2251</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    if (launch_method != DONT_FORK)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2252</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2253</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		exit(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2254</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2255</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2256</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2257</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2258</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">    close(close_on_exec_write_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2259</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2260</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2261</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * If the read_fd is closed without any data, then the</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2262</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * job manager was executed ok by the child process, due</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2263</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * to the close-on-exec flag being set on write_fd.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2264</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     *</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2265</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * If there is data on read_fd, then it is an error message</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2266</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * from the child process.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2267</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2268</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">    if ((n = read(close_on_exec_read_fd, buf, sizeof(buf))) &gt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2269</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2270</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        buf[n] = &#39;\0&#39;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2271</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        s = index(buf, &#39;\n&#39;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2272</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        if (s)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2273</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            *s = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2274</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure2(FAILED_SERVER, &quot;child failed: %s&quot;, buf);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2275</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2276</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">    if (n &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2277</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2278</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;child failed: error reading child fd&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2279</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2280</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">    close(close_on_exec_read_fd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2281</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2282</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">    if (launch_method != DONT_FORK)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2283</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2284</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">	notice2(0, &quot;Child %d started&quot;, pid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2285</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2286</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2287</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">    if (launch_method == FORK_AND_WAIT)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2288</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2289</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	/* wait until child is reaped */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2290</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	int dead_pid;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2291</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#       ifdef HAS_WAIT_UNION_WAIT</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2292</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	union wait status;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2293</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#       else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2294</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	int status;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2295</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#       endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2296</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2297</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	do</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2298</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2299</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#           ifdef HAS_WAIT3</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2300</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    dead_pid = wait3(&amp;status, 0, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2301</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#           else</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2302</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    dead_pid = waitpid(-1, &amp;status, 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2303</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#           endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2304</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    if (dead_pid &lt; 0 &amp;&amp; errno != EINTR)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2305</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2306</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		break;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2307</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2308</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	} while (dead_pid != pid);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2309</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2310</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2311</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">    ok_to_send_errmsg = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2312</td>
          <td class="coverageCount">317</td>
          <td class="srcCell"><span class="srcLine">} /* doit() */  </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2313</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2314</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2315</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:    net_accept()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2316</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description: Accept a connection on socket skt and return fd of new connection. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2317</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2318</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2319</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2320</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2321</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">net_accept(int skt)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2322</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2323</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    netlen_t           fromlen;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2324</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                skt2;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2325</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    int                gotit;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2326</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    struct sockaddr_in from;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2327</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2328</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">    fromlen = sizeof(from);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2329</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">    gotit = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2330</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2331</td>
          <td class="coverageCount">254551</td>
          <td class="srcCell"><span class="srcLine">    while (!gotit)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2332</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2333</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	fd_set         fdset;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2334</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	struct timeval timeout;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2335</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	int            n;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2336</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2337</td>
          <td class="coverageCount">130469</td>
          <td class="srcCell"><span class="srcLine">	FD_ZERO(&amp;fdset);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2338</td>
          <td class="coverageCount">130469</td>
          <td class="srcCell"><span class="srcLine">	FD_SET(skt, &amp;fdset);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2339</td>
          <td class="coverageCount">130469</td>
          <td class="srcCell"><span class="srcLine">	timeout.tv_sec = 60;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2340</td>
          <td class="coverageCount">130469</td>
          <td class="srcCell"><span class="srcLine">	timeout.tv_usec = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2341</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2342</td>
          <td class="coverageCount">130469</td>
          <td class="srcCell"><span class="srcLine">	n = select(skt + 1, &amp;fdset, (fd_set *) 0, &amp;fdset, &amp;timeout);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2343</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2344</td>
          <td class="coverageCount">130469</td>
          <td class="srcCell"><span class="srcLine">	if (n &lt; 0 &amp;&amp; errno != EINTR)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2345</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2346</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    error_check(n, &quot;net_accept select&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2347</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2348</td>
          <td class="coverageCount">130469</td>
          <td class="srcCell"><span class="srcLine">	else if (n &gt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2349</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2350</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            long flags;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2351</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2352</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">	    skt2 = accept(skt, (struct sockaddr *) &amp;from, &amp;fromlen);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2353</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2354</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">	    if (skt2 == -1)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2355</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2356</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if (errno != EINTR &amp;&amp; errno != EAGAIN &amp;&amp; errno != EWOULDBLOCK)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2357</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2358</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    error_check(skt2, &quot;net_accept accept&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2359</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2360</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2361</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    else</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2362</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">		gotit = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2363</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">            flags = fcntl(skt2, F_GETFL, 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2364</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">            flags &amp;= ~O_NONBLOCK;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2365</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">            fcntl(skt2, F_SETFL, flags);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2366</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2367</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2368</td>
          <td class="coverageCount">130469</td>
          <td class="srcCell"><span class="srcLine">	if (logrotate)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2369</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2370</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    time_t clock = time((time_t *) 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2371</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    struct tm *tmp = localtime(&amp;clock);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2372</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    char buf[128];</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2373</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2374</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    sprintf(buf, &quot;logfile rotating at %04d-%02d-%02d %02d:%02d:%02d&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2375</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		tmp-&gt;tm_year + 1900, tmp-&gt;tm_mon + 1, tmp-&gt;tm_mday,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2376</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		tmp-&gt;tm_hour, tmp-&gt;tm_min, tmp-&gt;tm_sec);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2377</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2378</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    notice2(LOG_INFO, &quot;%s&quot;, buf);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2379</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2380</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    if (logging_usrlog)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2381</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2382</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		static int seqnr;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2383</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		char *logpath = genfilename(gatekeeperhome, logfile, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2384</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		char *oldpath = malloc(strlen(logpath) + 64);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2385</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2386</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		sprintf(oldpath, &quot;%s.%04d%02d%02d%02d%02d%02d.%d&quot;, logpath,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2387</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		    tmp-&gt;tm_year + 1900, tmp-&gt;tm_mon + 1, tmp-&gt;tm_mday,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2388</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		    tmp-&gt;tm_hour, tmp-&gt;tm_min, tmp-&gt;tm_sec, seqnr++);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2389</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2390</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if (rename(logpath, oldpath) != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2391</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2392</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    notice4(LOG_ERR, &quot;ERROR: cannot rename %s to %s: %s&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2393</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">			logpath, oldpath, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2394</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2395</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		else if (logging_startup() != 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2396</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2397</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    failure(FAILED_SERVER, &quot;Logging restart failure&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2398</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2399</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2400</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2401</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    logging_phase2();</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2402</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    fclose(stdout);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2403</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    (void) dup2(2, 1); /* point stdout to stderr */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2404</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    *stdout = *fdopen(1, &quot;w&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2405</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    notice2(LOG_INFO, &quot;Continuing from %s&quot;, oldpath);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2406</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2407</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2408</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		free(logpath);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2409</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		free(oldpath);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2410</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2411</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2412</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    new_acct_file();</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2413</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2414</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">	    logrotate = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2415</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2416</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2417</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2418</td>
          <td class="coverageCount">62041</td>
          <td class="srcCell"><span class="srcLine">    return(skt2);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2419</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2420</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2421</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2422</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2423</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       net_setup_listener()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2424</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2425</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2426</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2427</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2428</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2429</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">net_setup_listener(int backlog,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2430</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                   int * port,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2431</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                   int * skt)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2432</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2433</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    netlen_t        sinlen;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2434</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    struct sockaddr_in sin;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2435</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	long flags;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2436</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    int one=1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2437</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2438</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    *skt = socket(AF_INET, SOCK_STREAM, 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2439</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    error_check(*skt,&quot;net_setup_anon_listener socket&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2440</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2441</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	flags = fcntl(*skt, F_GETFL, 0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2442</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	flags |= O_NONBLOCK;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2443</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	fcntl(*skt, F_SETFL, flags);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2444</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2445</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    error_check(setsockopt(*skt, SOL_SOCKET, SO_REUSEADDR, (char *)&amp;one, sizeof(one)),</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2446</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                &quot;net_setup_anon_listener setsockopt&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2447</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2448</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    sin.sin_family = AF_INET;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2449</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    sin.sin_addr.s_addr = INADDR_ANY;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2450</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    sin.sin_port = htons(*port);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2451</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2452</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    sinlen = sizeof(sin);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2453</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2454</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    error_check(bind(*skt,(struct sockaddr *) &amp;sin,sizeof(sin)),</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2455</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                &quot;net_setup_anon_listener bind&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2456</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2457</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2458</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    error_check(listen(*skt, backlog), &quot;net_setup_anon_listener listen&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2459</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2460</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    getsockname(*skt, (struct sockaddr *) &amp;sin, &amp;sinlen);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2461</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    *port = ntohs(sin.sin_port);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2462</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2463</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2464</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2465</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       logging_startup()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2466</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2467</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2468</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2469</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2470</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2471</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">logging_startup(void)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2472</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2473</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    if ((strncmp(logfile, &quot;logoff&quot;, 6) == 0) ||</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2474</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        (strncmp(logfile, &quot;LOGOFF&quot;, 6) == 0))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2475</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2476</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* no logging will be done, even syslog */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2477</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        fprintf(stderr, &quot;No logging will be done, even syslog.\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2478</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        logging_syslog = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2479</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        logging_usrlog = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2480</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2481</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    else</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2482</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2483</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">	if (!logging_syslog)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2484</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2485</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2486</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	     * By default open syslogfile if it is not open already.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2487</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	     * All messages will have GRAM gatekeeper and include the PID.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2488</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	     * The messages will be treated like any other system daemon.</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2489</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2490</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">	    logging_syslog = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2491</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">	    openlog(&quot;GRAM gatekeeper&quot;, LOG_PID, LOG_DAEMON);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2492</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2493</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2494</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">        if (strlen(logfile) &gt; 0) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2495</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2496</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            char * logfilename;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2497</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            /*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2498</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">             * Open the user specified logfile</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2499</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">             */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2500</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2501</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">	    if (logging_usrlog)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2502</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2503</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		/* close previous logfile, if any */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2504</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2505</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		if (usrlog_fp)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2506</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2507</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		    fclose(usrlog_fp);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2508</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">		}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2509</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2510</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">		logging_usrlog = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2511</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2512</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2513</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            logfilename = genfilename(gatekeeperhome, logfile, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2514</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2515</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            if ((usrlog_fp = fopen(logfilename, &quot;a&quot;)) == NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2516</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2517</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                fprintf(stderr, &quot;Cannot open logfile %s: %s\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2518</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        logfilename, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2519</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                syslog(LOG_ERR, &quot;Cannot open logfile %s\n&quot;, logfilename);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2520</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2521</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">                return(1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2522</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2523</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2524</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            free(logfilename);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2525</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">            logging_usrlog = 1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2526</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2527</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2528</td>
          <td class="coverageCount">679</td>
          <td class="srcCell"><span class="srcLine">    return(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2529</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">} /* logging_startup() */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2530</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2531</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2532</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       logging_phase2()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2533</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2534</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2535</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2536</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2537</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static int</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2538</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">logging_phase2(void)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2539</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2540</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2541</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    if (logging_usrlog) </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2542</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2543</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	/*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2544</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 * set stderr to the log file, to catch all fprintf(stderr,...</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2545</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 * and catch some from gram_k5, and job_manager</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2546</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 * But if testing gatekeeper, write to stderr instead. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2547</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2548</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2549</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	if (!gatekeeper_test &amp;&amp; usrlog_fp) {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2550</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	    int tmpfd = dup(fileno(usrlog_fp));	/* save copy of logfile fd */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2551</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2552</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	    fflush(stderr);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2553</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2554</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	    if (usrlog_fp != stderr)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2555</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2556</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">		fclose(usrlog_fp);	/* this may still close fd 2! */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2557</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2558</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2559</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	    fclose(stderr);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2560</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2561</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	    dup2(tmpfd, 2);		/* reconnect fd 2 to logfile */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2562</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	    close(tmpfd);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2563</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2564</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	    *stderr = *fdopen(2, &quot;w&quot;);	/* reinitialize stderr */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2565</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	}</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2566</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	usrlog_fp = stderr;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2567</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2568</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	/*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2569</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 * Set output to non-buffered mode</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2570</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">	 */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2571</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">	setbuf(stderr, NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2572</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2573</td>
          <td class="coverageCount">677</td>
          <td class="srcCell"><span class="srcLine">    return(0);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2574</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">} /* logging_phase2() */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2575</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2576</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2577</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       failure()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2578</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2579</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2580</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2581</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2582</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2583</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">failure(short failure_type, char * s)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2584</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2585</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2586</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">    OM_uint32        minor_status = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2587</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">    int              token_status = 0;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2588</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2589</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">    fprintf(stderr,&quot;Failure: %s\n&quot;, s);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2590</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">    if (logging_syslog)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2591</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2592</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">        syslog(LOG_ERR, &quot;%s\n&quot;, s);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2593</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2594</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">    if (logging_usrlog)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2595</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2596</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">        fprintf(usrlog_fp, &quot;TIME: %s PID: %d -- Failure: %s\n&quot;, timestamp(), getpid(), s);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2597</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2598</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2599</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * attempt to send back to the gram_client one final </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2600</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     * error message before quiting. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2601</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">     */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2602</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">    if (ok_to_send_errmsg)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2603</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2604</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        char * response;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2605</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2606</td>
          <td class="coverageCount">35</td>
          <td class="srcCell"><span class="srcLine">        switch (failure_type)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2607</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2608</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        case FAILED_AUTHORIZATION: </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2609</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">            response = (&quot;HTTP/1.1 403 Forbidden\015\012&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2610</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &quot;Connection: close\015\012&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2611</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &quot;\015\012&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2612</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">            break;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2613</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2614</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        case FAILED_SERVICELOOKUP:</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2615</td>
          <td class="coverageCount">4</td>
          <td class="srcCell"><span class="srcLine">            response = (&quot;HTTP/1.1 404 Not Found\015\012&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2616</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &quot;Connection: close\015\012&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2617</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &quot;\015\012&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2618</td>
          <td class="coverageCount">4</td>
          <td class="srcCell"><span class="srcLine">            break;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2619</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2620</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        case FAILED_PING:</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2621</td>
          <td class="coverageCount">29</td>
          <td class="srcCell"><span class="srcLine">            response = (&quot;HTTP/1.1 200 OK\015\012&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2622</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &quot;Content-Type: application/x-globus-gram\015\012&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2623</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &quot;Content-Length: 0\015\012&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2624</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &quot;\015\012&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2625</td>
          <td class="coverageCount">29</td>
          <td class="srcCell"><span class="srcLine">            break;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2626</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2627</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        case FAILED_SERVER:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2628</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        case FAILED_NOLOGIN:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2629</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        case FAILED_AUTHENTICATION:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2630</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        default: </span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2631</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">            response = (&quot;HTTP/1.1 500 Internal Server Error\015\012&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2632</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &quot;Connection: close\015\012&quot;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2633</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                        &quot;\015\012&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2634</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            break;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2635</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2636</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2637</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        /* don&#39;t care about errors here */</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2638</td>
          <td class="coverageCount">35</td>
          <td class="srcCell"><span class="srcLine">        globus_gss_assist_wrap_send(&amp;minor_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2639</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                    context_handle,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2640</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                    response,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2641</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                    strlen(response) + 1,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2642</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                    &amp;token_status,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2643</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                    globus_gss_assist_token_send_fd,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2644</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                    fdout,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2645</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                                    logging_usrlog?usrlog_fp:NULL);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2646</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2647</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">    if (gatekeeper_test)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2648</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2649</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        fprintf(stderr,&quot;Gatekeeper test complete : Failure!\n&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2650</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2651</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2652</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    /* Cleanup any delegated credential */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2653</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2654</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">    if (delegated_cred_handle)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2655</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2656</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        OM_uint32 minor_status2;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2657</td>
          <td class="coverageCount">2</td>
          <td class="srcCell"><span class="srcLine">        gss_release_cred(&amp;minor_status2, &amp;delegated_cred_handle);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2658</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2659</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2660</td>
          <td class="coverageCount">43</td>
          <td class="srcCell"><span class="srcLine">    exit(1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2661</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">} /* failure() */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2662</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2663</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2664</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       notice()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2665</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2666</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters: prty is the syslog priority, but if = 0, then dont syslog. </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2667</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2668</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2669</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static void </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2670</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">notice(int prty, char * s)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2671</td>
          <td class="coverageCount">8923</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2672</td>
          <td class="coverageCount">8923</td>
          <td class="srcCell"><span class="srcLine">    if (logging_syslog &amp;&amp; prty)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2673</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2674</td>
          <td class="coverageCount">5358</td>
          <td class="srcCell"><span class="srcLine">        syslog(prty, s);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2675</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2676</td>
          <td class="coverageCount">8923</td>
          <td class="srcCell"><span class="srcLine">    if (logging_usrlog)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2677</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2678</td>
          <td class="coverageCount">8923</td>
          <td class="srcCell"><span class="srcLine">        fprintf(usrlog_fp, &quot;TIME: %s PID: %d -- Notice: %d: %s\n&quot;, timestamp(), getpid(), prty, s);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2679</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2680</td>
          <td class="coverageCount">8923</td>
          <td class="srcCell"><span class="srcLine">} /* notice() */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2681</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2682</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#if defined(TARGET_ARCH_CRAYT3E)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2683</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/* Make callable entries to failure() and notice() */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2684</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">void gatekeeper_failure(short failure_type, char * s)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2685</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2686</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    failure(failure_type, s);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2687</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2688</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2689</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">void gatekeeper_notice(int prty, char * s)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2690</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2691</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    notice(prty, s);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2692</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">}</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2693</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">#endif</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2694</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2695</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2696</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2697</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       error_check()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2698</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2699</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2700</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2701</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2702</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2703</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">void </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2704</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">error_check(int val,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2705</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">            char * str)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2706</td>
          <td class="coverageCount">2708</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2707</td>
          <td class="coverageCount">2708</td>
          <td class="srcCell"><span class="srcLine">    if (val &lt; 0)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2708</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2709</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure3(FAILED_SERVER, </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2710</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">                 &quot;error check %s: %s\n&quot;, str, strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2711</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/*</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2712</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  fprintf(usrlog_fp, &quot;%s: %s\n&quot;,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2713</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  str,</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2714</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  strerror(errno));</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2715</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">  exit(1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2716</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">*/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2717</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2718</td>
          <td class="coverageCount">2708</td>
          <td class="srcCell"><span class="srcLine">} /* error_check() */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2719</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2720</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">/******************************************************************************</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2721</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Function:       timestamp()</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2722</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Description:    </span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2723</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Parameters:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2724</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">Returns:</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2725</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">******************************************************************************/</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2726</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2727</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">char *</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2728</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">timestamp(void)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2729</td>
          <td class="coverageCount">10322</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2730</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    time_t clock;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2731</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    struct tm *tmp;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2732</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2733</td>
          <td class="coverageCount">10322</td>
          <td class="srcCell"><span class="srcLine">    time(&amp;clock);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2734</td>
          <td class="coverageCount">10322</td>
          <td class="srcCell"><span class="srcLine">    tmp = localtime(&amp;clock);</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2735</td>
          <td class="coverageCount">10322</td>
          <td class="srcCell"><span class="srcLine">    return asctime(tmp);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2736</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">} /* timestamp() */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2737</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2738</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2739</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">int</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2740</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">get_content_length(char * http_message, char * http_body)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2741</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2742</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    char save = *http_body;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2743</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    char * content_header;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2744</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    int content_length = -1;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2745</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    *http_body = &#39;\0&#39;;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2746</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2747</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    content_header = strstr(http_message, &quot;\012Content-Length:&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2748</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2749</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    if(content_header != NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2750</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2751</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">        content_header += 16;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2752</td>
          <td class="coverageCount">2001</td>
          <td class="srcCell"><span class="srcLine">        while(*content_header &amp;&amp; isspace(*content_header))</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2753</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2754</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">            content_header++;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2755</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2756</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">        if(*content_header)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2757</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2758</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">            content_length = atoi(content_header);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2759</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">        }</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2760</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2761</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    *http_body = save;</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2762</td>
          <td class="coverageCount">667</td>
          <td class="srcCell"><span class="srcLine">    return content_length;</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2763</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">} /* get_content_length() */</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2764</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2765</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2766</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">static</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2767</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">void</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2768</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">null_terminate_string(char ** s, size_t len)</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2769</td>
          <td class="coverageCount">709</td>
          <td class="srcCell"><span class="srcLine">{</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2770</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2771</td>
          <td class="coverageCount">709</td>
          <td class="srcCell"><span class="srcLine">    *s = realloc(*s, len+1);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2772</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine"></span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2773</td>
          <td class="coverageCount">709</td>
          <td class="srcCell"><span class="srcLine">    if ((*s) == NULL)</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2774</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    {</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2775</td>
          <td class="coverageCountHilight">0</td>
          <td class="srcCell"><span class="srcLineHilight">        failure(FAILED_SERVER, &quot;Error NULL-terminating string&quot;);</span></td>
        </tr>
      
        <tr>
          <td class="lineCount">2776</td>
          <td class="coverageCount"></td>
          <td class="srcCell"><span class="srcLine">    }</span></td>
        </tr>
      
        <tr>
          <td class="lineCountHilight">2777</td>
          <td class="coverageCount">709</td>
          <td class="srcCell"><span class="srcLine">    (*s)[len] = 0;</span></td>
        </tr>
      
      </table>
  </body>
</html>
